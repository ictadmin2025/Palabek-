"use strict";(globalThis.webpackChunkwp_event_solution=globalThis.webpackChunkwp_event_solution||[]).push([[731],{21020:(e,t,n)=>{var o=n(51609),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,i={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,o)&&!l.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:r,type:e,key:c,ref:d,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},74848:(e,t,n)=>{e.exports=n(21020)},98731:(e,t,n)=>{n.d(t,{eb:()=>Pd,fB:()=>rt,tL:()=>_d});var o=n(74848),r=n(51609),i=n(87667),a=n(50400),s=n(54861),l=n(84033),c=n(11721),d=n(60742),u=n(79888),h=n(31058),f=n(87959),g=n(19549),p=n(51643),m=n(36492),y=n(75063),v=n(90070),x=n(428),b=n(43960),w=n(16784),S=n(71524),C=n(32099),_=n(67313),E=n(75795),k=n(74353),N=n(45708),M=(0,r.createContext)({});function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},P.apply(null,arguments)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t);else for(;!(l=(o=i.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function O(e,t,n){return(t=function(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function I(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var R,T={exports:{}};R=T,function(){var e={}.hasOwnProperty;function t(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=o(e,n(r)))}return e}function n(n){if("string"==typeof n||"number"==typeof n)return n;if("object"!=typeof n)return"";if(Array.isArray(n))return t.apply(null,n);if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]"))return n.toString();var r="";for(var i in n)e.call(n,i)&&n[i]&&(r=o(r,i));return r}function o(e,t){return t?e?e+" "+t:e+t:e}R.exports?(t.default=t,R.exports=t):window.classNames=t}();var $=I(T.exports);const L=Math.round;function B(e,t){const n=e.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],o=n.map(e=>parseFloat(e));for(let e=0;e<3;e+=1)o[e]=t(o[e]||0,n[e]||"",e);return n[3]?o[3]=n[3].includes("%")?o[3]/100:o[3]:o[3]=1,o}const V=(e,t,n)=>0===n?e:e/100;function H(e,t){const n=t||255;return e>n?n:e<0?0:e}class F{constructor(e){function t(t){return t[0]in e&&t[1]in e&&t[2]in e}if(O(this,"isValid",!0),O(this,"r",0),O(this,"g",0),O(this,"b",0),O(this,"a",1),O(this,"_h",void 0),O(this,"_s",void 0),O(this,"_l",void 0),O(this,"_v",void 0),O(this,"_max",void 0),O(this,"_min",void 0),O(this,"_brightness",void 0),e)if("string"==typeof e){const n=e.trim();function o(e){return n.startsWith(e)}/^#?[A-F\d]{3,8}$/i.test(n)?this.fromHexString(n):o("rgb")?this.fromRgbString(n):o("hsl")?this.fromHslString(n):(o("hsv")||o("hsb"))&&this.fromHsvString(n)}else if(e instanceof F)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(t("rgb"))this.r=H(e.r),this.g=H(e.g),this.b=H(e.b),this.a="number"==typeof e.a?H(e.a,1):1;else if(t("hsl"))this.fromHsl(e);else{if(!t("hsv"))throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e));this.fromHsv(e)}}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const t=this.toHsv();return t.h=e,this._c(t)}getLuminance(){function e(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return.2126*e(this.r)+.7152*e(this.g)+.0722*e(this.b)}getHue(){if(void 0===this._h){const e=this.getMax()-this.getMin();this._h=0===e?0:L(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(void 0===this._s){const e=this.getMax()-this.getMin();this._s=0===e?0:e/this.getMax()}return this._s}getLightness(){return void 0===this._l&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return void 0===this._v&&(this._v=this.getMax()/255),this._v}getBrightness(){return void 0===this._brightness&&(this._brightness=(299*this.r+587*this.g+114*this.b)/1e3),this._brightness}darken(e=10){const t=this.getHue(),n=this.getSaturation();let o=this.getLightness()-e/100;return o<0&&(o=0),this._c({h:t,s:n,l:o,a:this.a})}lighten(e=10){const t=this.getHue(),n=this.getSaturation();let o=this.getLightness()+e/100;return o>1&&(o=1),this._c({h:t,s:n,l:o,a:this.a})}mix(e,t=50){const n=this._c(e),o=t/100,r=e=>(n[e]-this[e])*o+this[e],i={r:L(r("r")),g:L(r("g")),b:L(r("b")),a:L(100*r("a"))/100};return this._c(i)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const t=this._c(e),n=this.a+t.a*(1-this.a),o=e=>L((this[e]*this.a+t[e]*t.a*(1-this.a))/n);return this._c({r:o("r"),g:o("g"),b:o("b"),a:n})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const t=(this.r||0).toString(16);e+=2===t.length?t:"0"+t;const n=(this.g||0).toString(16);e+=2===n.length?n:"0"+n;const o=(this.b||0).toString(16);if(e+=2===o.length?o:"0"+o,"number"==typeof this.a&&this.a>=0&&this.a<1){const t=L(255*this.a).toString(16);e+=2===t.length?t:"0"+t}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),t=L(100*this.getSaturation()),n=L(100*this.getLightness());return 1!==this.a?`hsla(${e},${t}%,${n}%,${this.a})`:`hsl(${e},${t}%,${n}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return 1!==this.a?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,t,n){const o=this.clone();return o[e]=H(t,n),o}_c(e){return new this.constructor(e)}getMax(){return void 0===this._max&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return void 0===this._min&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const t=e.replace("#","");function n(e,n){return parseInt(t[e]+t[n||e],16)}t.length<6?(this.r=n(0),this.g=n(1),this.b=n(2),this.a=t[3]?n(3)/255:1):(this.r=n(0,1),this.g=n(2,3),this.b=n(4,5),this.a=t[6]?n(6,7)/255:1)}fromHsl({h:e,s:t,l:n,a:o}){if(this._h=e%360,this._s=t,this._l=n,this.a="number"==typeof o?o:1,t<=0){const e=L(255*n);this.r=e,this.g=e,this.b=e}let r=0,i=0,a=0;const s=e/60,l=(1-Math.abs(2*n-1))*t,c=l*(1-Math.abs(s%2-1));s>=0&&s<1?(r=l,i=c):s>=1&&s<2?(r=c,i=l):s>=2&&s<3?(i=l,a=c):s>=3&&s<4?(i=c,a=l):s>=4&&s<5?(r=c,a=l):s>=5&&s<6&&(r=l,a=c);const d=n-l/2;this.r=L(255*(r+d)),this.g=L(255*(i+d)),this.b=L(255*(a+d))}fromHsv({h:e,s:t,v:n,a:o}){this._h=e%360,this._s=t,this._v=n,this.a="number"==typeof o?o:1;const r=L(255*n);if(this.r=r,this.g=r,this.b=r,t<=0)return;const i=e/60,a=Math.floor(i),s=i-a,l=L(n*(1-t)*255),c=L(n*(1-t*s)*255),d=L(n*(1-t*(1-s))*255);switch(a){case 0:this.g=d,this.b=l;break;case 1:this.r=c,this.b=l;break;case 2:this.r=l,this.b=d;break;case 3:this.r=l,this.g=c;break;case 4:this.r=d,this.g=l;break;default:this.g=l,this.b=c}}fromHsvString(e){const t=B(e,V);this.fromHsv({h:t[0],s:t[1],v:t[2],a:t[3]})}fromHslString(e){const t=B(e,V);this.fromHsl({h:t[0],s:t[1],l:t[2],a:t[3]})}fromRgbString(e){const t=B(e,(e,t)=>t.includes("%")?L(e/100*255):e);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}}var Y=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function Z(e,t,n){var o;return(o=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-2*t:Math.round(e.h)+2*t:n?Math.round(e.h)+2*t:Math.round(e.h)-2*t)<0?o+=360:o>=360&&(o-=360),o}function X(e,t,n){return 0===e.h&&0===e.s?e.s:((o=n?e.s-.16*t:4===t?e.s+.16:e.s+.05*t)>1&&(o=1),n&&5===t&&o>.1&&(o=.1),o<.06&&(o=.06),Math.round(100*o)/100);var o}function W(e,t,n){var o;return o=n?e.v+.05*t:e.v-.15*t,o=Math.max(0,Math.min(1,o)),Math.round(100*o)/100}var q=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach(function(t){O(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}q.primary=q[5];var U="data-rc-order",Q="data-rc-priority",J=new Map;function ee(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mark;return e?e.startsWith("data-")?e:"data-".concat(e):"rc-util-key"}function te(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function ne(e){return Array.from((J.get(e)||e).children).filter(function(e){return"STYLE"===e.tagName})}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"==typeof window||!window.document||!window.document.createElement)return null;var n=t.csp,o=t.prepend,r=t.priority,i=void 0===r?0:r,a=function(e){return"queue"===e?"prependQueue":e?"prepend":"append"}(o),s="prependQueue"===a,l=document.createElement("style");l.setAttribute(U,a),s&&i&&l.setAttribute(Q,"".concat(i)),null!=n&&n.nonce&&(l.nonce=null==n?void 0:n.nonce),l.innerHTML=e;var c=te(t),d=c.firstChild;if(o){if(s){var u=(t.styles||ne(c)).filter(function(e){if(!["prepend","prependQueue"].includes(e.getAttribute(U)))return!1;var t=Number(e.getAttribute(Q)||0);return i>=t});if(u.length)return c.insertBefore(l,u[u.length-1].nextSibling),l}c.insertBefore(l,d)}else c.appendChild(l);return l}function re(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}var ie={},ae=[];function se(e,t){}function le(e,t){}function ce(e,t,n){t||ie[n]||(e(!1,n),ie[n]=!0)}function de(e,t){ce(se,e,t)}function ue(e){return"object"===z(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===z(e.icon)||"function"==typeof e.icon)}function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce(function(t,n){var o,r=e[n];return"class"===n?(t.className=r,delete t.class):(delete t[n],t[(o=n,o.replace(/-(.)/g,function(e,t){return t.toUpperCase()}))]=r),t},{})}function fe(e,t,n){return n?r.createElement(e.tag,G(G({key:t},he(e.attrs)),n),(e.children||[]).map(function(n,o){return fe(n,"".concat(t,"-").concat(e.tag,"-").concat(o))})):r.createElement(e.tag,G({key:t},he(e.attrs)),(e.children||[]).map(function(n,o){return fe(n,"".concat(t,"-").concat(e.tag,"-").concat(o))}))}function ge(e){return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],o=new F(e),r=o.toHsv(),i=5;i>0;i-=1){var a=new F({h:Z(r,i,!0),s:X(r,i,!0),v:W(r,i,!0)});n.push(a)}n.push(o);for(var s=1;s<=4;s+=1){var l=new F({h:Z(r,s),s:X(r,s),v:W(r,s)});n.push(l)}return"dark"===t.theme?Y.map(function(e){var o=e.index,r=e.amount;return new F(t.backgroundColor||"#141414").mix(n[o],r).toHexString()}):n.map(function(e){return e.toHexString()})}(e)[0]}function pe(e){return e?Array.isArray(e)?e:[e]:[]}de.preMessage=function(e){ae.push(e)},de.resetWarned=function(){ie={}},de.noteOnce=function(e,t){ce(le,e,t)};var me=["icon","className","onClick","style","primaryColor","secondaryColor"],ye={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1},ve=function(e){var t,n,o,i,a,s,l=e.icon,c=e.className,d=e.onClick,u=e.style,h=e.primaryColor,f=e.secondaryColor,g=D(e,me),p=r.useRef(),m=ye;if(h&&(m={primaryColor:h,secondaryColor:f||ge(h)}),t=p,n=(0,r.useContext)(M),o=n.csp,i=n.prefixCls,a=n.layer,s="\n.anticon {\n  display: inline-flex;\n  align-items: center;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n",i&&(s=s.replace(/anticon/g,i)),a&&(s="@layer ".concat(a," {\n").concat(s,"\n}")),(0,r.useEffect)(function(){var e=function(e){return function(e){return re(e)instanceof ShadowRoot}(e)?re(e):null}(t.current);!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=te(n),r=ne(o),i=G(G({},n),{},{styles:r});!function(e,t){var n=J.get(e);if(!n||!function(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}(document,n)){var o=oe("",t),r=o.parentNode;J.set(e,r),e.removeChild(o)}}(o,i);var a,s,l,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=te(t);return(t.styles||ne(n)).find(function(n){return n.getAttribute(ee(t))===e})}(t,i);if(c)return null!==(a=i.csp)&&void 0!==a&&a.nonce&&c.nonce!==(null===(s=i.csp)||void 0===s?void 0:s.nonce)&&(c.nonce=null===(l=i.csp)||void 0===l?void 0:l.nonce),c.innerHTML!==e&&(c.innerHTML=e),c;oe(e,i).setAttribute(ee(i),t)}(s,"@ant-design-icons",{prepend:!a,csp:o,attachTo:e})},[]),function(e,t){de(e,"[@ant-design/icons] ".concat(t))}(ue(l),"icon should be icon definiton, but got ".concat(l)),!ue(l))return null;var y=l;return y&&"function"==typeof y.icon&&(y=G(G({},y),{},{icon:y.icon(m.primaryColor,m.secondaryColor)})),fe(y.icon,"svg-".concat(y.name),G(G({className:c,onClick:d,style:u,"data-icon":y.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},g),{},{ref:p}))};function xe(e){var t=j(pe(e),2),n=t[0],o=t[1];return ve.setTwoToneColors({primaryColor:n,secondaryColor:o})}ve.displayName="IconReact",ve.getTwoToneColors=function(){return G({},ye)},ve.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;ye.primaryColor=t,ye.secondaryColor=n||ge(t),ye.calculated=!!n};var be=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];xe(q.primary);var we=r.forwardRef(function(e,t){var n=e.className,o=e.icon,i=e.spin,a=e.rotate,s=e.tabIndex,l=e.onClick,c=e.twoToneColor,d=D(e,be),u=r.useContext(M),h=u.prefixCls,f=void 0===h?"anticon":h,g=u.rootClassName,p=$(g,f,O(O({},"".concat(f,"-").concat(o.name),!!o.name),"".concat(f,"-spin"),!!i||"loading"===o.name),n),m=s;void 0===m&&l&&(m=-1);var y=a?{msTransform:"rotate(".concat(a,"deg)"),transform:"rotate(".concat(a,"deg)")}:void 0,v=j(pe(c),2),x=v[0],b=v[1];return r.createElement("span",P({role:"img","aria-label":o.name},d,{ref:t,tabIndex:m,onClick:l,className:p}),r.createElement(ve,{icon:o,primaryColor:x,secondaryColor:b,style:y}))});we.displayName="AntdIcon",we.getTwoToneColor=function(){var e=ve.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},we.setTwoToneColor=xe;var Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"},Ce=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Se}))}),_e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M816 768h-24V428c0-141.1-104.3-257.7-240-277.1V112c0-22.1-17.9-40-40-40s-40 17.9-40 40v38.9c-135.7 19.4-240 136-240 277.1v340h-24c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h216c0 61.8 50.2 112 112 112s112-50.2 112-112h216c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM512 888c-26.5 0-48-21.5-48-48h96c0 26.5-21.5 48-48 48zM304 768V428c0-55.6 21.6-107.8 60.9-147.1S456.4 220 512 220c55.6 0 107.8 21.6 147.1 60.9S720 372.4 720 428v340H304z"}}]},name:"bell",theme:"outlined"},Ee=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:_e}))}),ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},Ne=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:ke}))}),Me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},Pe=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Me}))}),Ae={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},je=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Ae}))}),ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},Oe=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:ze}))}),De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},Ie=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:De}))}),Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},Te=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Re}))}),$e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},Le=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:$e}))}),Be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32zM184 568V232h368v336H184zm656 145H504v-73h112c4.4 0 8-3.6 8-8V377h216v336z"}}]},name:"flag",theme:"outlined"},Ve=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Be}))}),He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},Fe=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:He}))}),Ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},Ze=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Ye}))}),Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},We=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Xe}))}),qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},Ke=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:qe}))}),Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},Ue=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Ge}))}),Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},Je=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:Qe}))}),et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},tt=r.forwardRef(function(e,t){return r.createElement(we,P({},e,{ref:t,icon:et}))});class nt{constructor({baseUrl:e,pluginSlug:t="poptics",apiVersion:n="v1",nonce:o=""}){this.baseUrl=e,this.pluginSlug=t,this.apiVersion=n,this.nonce=o}getApiUrl(e){return`${this.baseUrl}/wp-json/${this.pluginSlug}/${this.apiVersion}/${e}`}async fetchWithAuth(e,t={}){const n=this.getApiUrl(e);console.log("nonce"),console.log(this.nonce);const o={"Content-Type":"application/json",...this.nonce?{"X-WP-Nonce":this.nonce}:{},...t.headers},r=await fetch(n,{...t,headers:o,credentials:"include"});if(!r.ok){const e=await r.text();throw new Error(`API Error (${r.status}): ${e}`)}return r.json()}async getAllFlows(){return this.fetchWithAuth("poptics-notification-flow")}async getFlowById(e){return this.fetchWithAuth(`notification-flow/${e}`)}async updateFlow(e,t){return this.fetchWithAuth(`notification-flow/${e}`,{method:"PUT",body:JSON.stringify(t)})}async createFlow(e){return this.fetchWithAuth("notification-flow",{method:"POST",body:JSON.stringify(e)})}async deleteFlow(e){return this.fetchWithAuth(`notification-flow/${e}`,{method:"DELETE"})}async bulkDeleteFlow(e){return this.fetchWithAuth("notification-flow",{method:"DELETE",body:JSON.stringify(e)})}async cloneFlow(e){return this.fetchWithAuth(`notification-flow/${e}/clone`,{method:"POST"})}async getFilteredFlows(e){const t=new URLSearchParams;e.trigger&&t.append("trigger",e.trigger),e.status&&t.append("status",e.status),e.searchKey&&t.append("search_key",e.searchKey);const n=t.toString(),o="notification-flow"+(n?`?${n}`:"");return this.fetchWithAuth(o)}}let ot={prefix:"pt"};const rt=e=>{ot={...ot,...e}},it=()=>{return{...ot,prefix:(e=ot.prefix,`${e}_ens_data`)};var e},at={poptics_ens_data:{nonce:"a8ad90e706",api_version:"v1",plugin_slug:"poptics",base_url:"http://poptics-demo.local",triggers:[{trigger_label:"Order Completed",trigger_value:"order_completed",trigger_data:[{label:"Order Amount",value:"order_amount",type:"number"},{label:"Order Status",value:"order_status",type:"string"},{label:"Order Date",value:"order_date",type:"date"},{label:"email",value:"email",type:"string"}],delay_dependencies:[{label:"Order Date",value:"order_date"},{label:"Event Date",value:"event_date"}],email_receivers:[{label:"User Email",value:"user_email"},{label:"Admin Email",value:"admin_email"}]},{trigger_label:"Event Created",trigger_value:"event_created",trigger_data:[{label:"Purchase Price",value:"purchase_price",type:"number"},{label:"Purchase Status",value:"purchase_status",type:"string"},{label:"Purchase Date",value:"purchase_date",type:"date"},{label:"email",value:"email",type:"string"}],delay_dependencies:[{label:"Order Date",value:"order_date"}],email_receivers:[{label:"User Email",value:"user_email"},{label:"Admin Email",value:"admin_email"}]}]}},st=[{label:"Send Email",value:"send_email"},{label:"Add Delay",value:"add_delay"}],lt={send_email:{label:"Send Email",formFields:[{name:"receiverType",label:"Receiver Type",component:m.A,required:!0,props:{style:{width:"100%"},options:[],placeholder:"Select user type",getPopupContainer:e=>e.parentNode},rules:[{required:!0,message:"Please select a user type"}]},{name:"from",label:"From Address",component:u.A,required:!1,props:{style:{width:"100%"},placeholder:"Enter from address",type:"email"},rules:[{required:!1,type:"email",message:"Please enter a valid email address"}]},{name:"subject",label:"Email Subject",component:u.A,required:!0,props:{style:{width:"100%"},placeholder:"Enter email subject"},rules:[{required:!0,message:"Please enter email subject"}]},{name:"body",label:"Email Body",component:"richText",required:!0,props:{style:{height:"200px"},modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link","image"],["clean"]]}},rules:[{required:!0,message:"Please enter email content"}]}]},add_delay:{label:"Add Delay",formFields:[{name:"delay",label:"Wait Time",component:h.A,required:!0,props:{style:{width:"100%"},min:0,placeholder:"Delay amount in number"},rules:[{required:!0,message:"Please enter delay amount"}]},{name:"delayUnit",label:"Wait Time Unit",component:m.A,required:!0,props:{style:{width:"100%"},options:[{value:"minutes",label:"Minutes"},{value:"hours",label:"Hours"},{value:"days",label:"Days"},{value:"weeks",label:"Weeks"}],placeholder:"Select time unit",getPopupContainer:e=>e.parentNode},rules:[{required:!0,message:"Please select a time unit"}]},{name:"delayCondition",label:"Delay condition",component:m.A,required:!1,tooltip:{title:"Select when the delay should be calculated from. This determines the reference point for your wait time.",icon:"info",placement:"topRight"},props:{style:{width:"100%"},options:[],placeholder:"Select delay condition",getPopupContainer:e=>e.parentNode}}]}},ct=[{label:"Equal to (=)",value:"equal"},{label:"Not equal to (≠)",value:"not_equal"},{label:"Greater than (>)",value:"greater_then"},{label:"Greater than or equal to (≥)",value:"greater_equal"},{label:"Less than (<)",value:"less_then"},{label:"Less than or equal to (≤)",value:"less_equal"}],dt=[{label:"Equal to (=)",value:"equal"},{label:"Not equal to (≠)",value:"not_equal"}],ut=[{label:"Equal to (=)",value:"equal"},{label:"Not equal to (≠)",value:"not_equal"},{label:"Before (<)",value:"less_then"},{label:"After (>)",value:"greater_then"}],ht=()=>{const{prefix:e}=it(),{api_version:t="",base_url:n="",plugin_slug:o="",nonce:i=""}="undefined"!=typeof window&&window[e]?window[e]:at.poptics_ens_data,a=new nt({baseUrl:n,apiVersion:t,pluginSlug:o,nonce:i}),[s,l]=(0,r.useState)({}),[c,d]=(0,r.useState)(),[u,h]=(0,r.useState)([]),[g,p]=(0,r.useState)({trigger:"",status:"",searchKey:""});(0,r.useEffect)(()=>{f.Ay.config({top:32,duration:3})},[]);const m=e=>{l(t=>({...t,[e]:!0}))},y=e=>{l(t=>({...t,[e]:!1}))},v=e=>!!s[e],x=(0,r.useCallback)(async e=>{var t,n,o;m("listFlows");const r=e||g;try{const{data:e}=await a.getFilteredFlows(r);return h((null==e?void 0:e.items)||[]),d({draft:(null===(t=null==e?void 0:e.status_count)||void 0===t?void 0:t.draft)||0,trash:(null===(n=null==e?void 0:e.status_count)||void 0===n?void 0:n.trash)||0,publish:(null===(o=null==e?void 0:e.status_count)||void 0===o?void 0:o.publish)||0}),{data:e}}catch(e){return console.error("Error fetching flows:",e),f.Ay.error("Failed to load flows"),{error:e}}finally{y("listFlows")}},[a,g]),b=(0,r.useCallback)(async e=>{m("getFlow");try{return await a.getFlowById(e)}catch(e){return console.error("Error fetching flow:",e),f.Ay.error("Failed to load flow"),{error:e}}finally{y("getFlow")}},[a]),w=(0,r.useCallback)(async(e,t,n=!1)=>{m("updateFlow");try{await a.updateFlow(e,t),f.Ay.success("Flow updated successfully"),n&&await x()}catch(e){return console.error("Error updating flow:",e),f.Ay.error("Failed to update flow"),{error:e}}finally{y("updateFlow")}},[a]),S=(0,r.useCallback)(async e=>{m("deleteFlow");try{await a.deleteFlow(e),f.Ay.success("Flow deleted successfully"),await x()}catch(e){f.Ay.error("Failed to delete flow: "+(e instanceof Error?e.message:"Unknown error")),console.error("Error deleting flow:",e)}finally{y("deleteFlow")}},[x]),C=(0,r.useCallback)(async e=>{m("cloneFlow");try{await a.cloneFlow(e),await x(),f.Ay.success("Flow cloned successfully")}catch(e){f.Ay.error("Failed to clone flow: "+(e instanceof Error?e.message:"Unknown error")),console.error("Error cloning flow:",e)}finally{y("cloneFlow")}},[x]),_=(0,r.useCallback)(async e=>{m("createFlow");try{const t=await a.createFlow(e);return f.Ay.success("Flow created successfully"),await x(),null==t?void 0:t.data}catch(e){f.Ay.error("Failed to create flow: "+(e instanceof Error?e.message:"Unknown error")),console.error("Error creating flow:",e)}finally{y("createFlow")}},[x]),E=(0,r.useCallback)(async e=>{m("bulkDelete");try{await a.bulkDeleteFlow(e),f.Ay.success(`${e.length} flows deleted successfully`),await x()}catch(e){f.Ay.error("Failed to delete flows: "+(e instanceof Error?e.message:"Unknown error")),console.error("Error bulk deleting flows:",e)}finally{y("bulkDelete")}},[x]),k=(0,r.useCallback)(e=>{p(t=>{const n={...t,...e};return setTimeout(()=>{x(n)},0),n})},[x]),N=(0,r.useCallback)(e=>{k({searchKey:e})},[k]),M=(0,r.useCallback)(e=>{k({status:e})},[k]),P=(0,r.useCallback)(e=>{k({trigger:e})},[k]);return{notificationFlows:u,fetchFlows:x,editFlow:w,cloneFlow:C,createFlow:_,getFlowById:b,deleteFlow:S,bulkDeleteFlows:E,refresh:x,statusCount:c,isFlowListLoading:()=>v("listFlows"),isFlowLoading:()=>v("getFlow"),isFlowSaving:()=>v("updateFlow"),isFlowDeleting:()=>v("deleteFlow"),isFlowCloning:()=>v("cloneFlow"),isFlowCreating:()=>v("createFlow"),isFlowBulkDeleting:()=>v("bulkDelete"),filterFlows:k,searchFlows:N,filterByStatus:M,filterByTrigger:P,currentFilters:g}};function ft(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,o=0;o<e.length;o++)""!==(n=ft(e[o]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var gt={value:()=>{}};function pt(){for(var e,t=0,n=arguments.length,o={};t<n;++t){if(!(e=arguments[t]+"")||e in o||/[\s.]/.test(e))throw new Error("illegal type: "+e);o[e]=[]}return new mt(o)}function mt(e){this._=e}function yt(e,t){for(var n,o=0,r=e.length;o<r;++o)if((n=e[o]).name===t)return n.value}function vt(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=gt,e=e.slice(0,o).concat(e.slice(o+1));break}return null!=n&&e.push({name:t,value:n}),e}mt.prototype=pt.prototype={constructor:mt,on:function(e,t){var n,o,r=this._,i=(o=r,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!o.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),a=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++a<s;)if(n=(e=i[a]).type)r[n]=vt(r[n],e.name,t);else if(null==t)for(n in r)r[n]=vt(r[n],e.name,null);return this}for(;++a<s;)if((n=(e=i[a]).type)&&(n=yt(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new mt(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,o,r=new Array(n),i=0;i<n;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(o=this._[e]).length;i<n;++i)o[i].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};var xt="http://www.w3.org/1999/xhtml",bt={svg:"http://www.w3.org/2000/svg",xhtml:xt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wt(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),bt.hasOwnProperty(t)?{space:bt[t],local:e}:e}function St(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xt&&t.documentElement.namespaceURI===xt?t.createElement(e):t.createElementNS(n,e)}}function Ct(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _t(e){var t=wt(e);return(t.local?Ct:St)(t)}function Et(){}function kt(e){return null==e?Et:function(){return this.querySelector(e)}}function Nt(){return[]}function Mt(e){return null==e?Nt:function(){return this.querySelectorAll(e)}}function Pt(e){return function(){return this.matches(e)}}function At(e){return function(t){return t.matches(e)}}var jt=Array.prototype.find;function zt(){return this.firstElementChild}var Ot=Array.prototype.filter;function Dt(){return Array.from(this.children)}function It(e){return new Array(e.length)}function Rt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Tt(e,t,n,o,r,i){for(var a,s=0,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new Rt(e,i[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function $t(e,t,n,o,r,i,a){var s,l,c,d=new Map,u=t.length,h=i.length,f=new Array(u);for(s=0;s<u;++s)(l=t[s])&&(f[s]=c=a.call(l,l.__data__,s,t)+"",d.has(c)?r[s]=l:d.set(c,l));for(s=0;s<h;++s)c=a.call(e,i[s],s,i)+"",(l=d.get(c))?(o[s]=l,l.__data__=i[s],d.delete(c)):n[s]=new Rt(e,i[s]);for(s=0;s<u;++s)(l=t[s])&&d.get(f[s])===l&&(r[s]=l)}function Lt(e){return e.__data__}function Bt(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Vt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ht(e){return function(){this.removeAttribute(e)}}function Ft(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Yt(e,t){return function(){this.setAttribute(e,t)}}function _n(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Zt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Xt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Wt(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function qt(e){return function(){this.style.removeProperty(e)}}function Kt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Gt(e,t,n){return function(){var o=t.apply(this,arguments);null==o?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function Ut(e,t){return e.style.getPropertyValue(t)||Wt(e).getComputedStyle(e,null).getPropertyValue(t)}function Qt(e){return function(){delete this[e]}}function Jt(e,t){return function(){this[e]=t}}function en(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function tn(e){return e.trim().split(/^|\s+/)}function nn(e){return e.classList||new on(e)}function on(e){this._node=e,this._names=tn(e.getAttribute("class")||"")}function rn(e,t){for(var n=nn(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function an(e,t){for(var n=nn(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function sn(e){return function(){rn(this,e)}}function ln(e){return function(){an(this,e)}}function cn(e,t){return function(){(t.apply(this,arguments)?rn:an)(this,e)}}function dn(){this.textContent=""}function un(e){return function(){this.textContent=e}}function hn(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function fn(){this.innerHTML=""}function gn(e){return function(){this.innerHTML=e}}function pn(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function mn(){this.nextSibling&&this.parentNode.appendChild(this)}function yn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function vn(){return null}function xn(){var e=this.parentNode;e&&e.removeChild(this)}function bn(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wn(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Sn(e){return function(){var t=this.__on;if(t){for(var n,o=0,r=-1,i=t.length;o<i;++o)n=t[o],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?t.length=r:delete this.__on}}}function Cn(e,t,n){return function(){var o,r=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(r)for(var a=0,s=r.length;a<s;++a)if((o=r[a]).type===e.type&&o.name===e.name)return this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),void(o.value=t);this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function En(e,t,n){var o=Wt(e),r=o.CustomEvent;"function"==typeof r?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function kn(e,t){return function(){return En(this,e,t)}}function Nn(e,t){return function(){return En(this,e,t.apply(this,arguments))}}Rt.prototype={constructor:Rt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},on.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Mn=[null];function Pn(e,t){this._groups=e,this._parents=t}function An(){return new Pn([[document.documentElement]],Mn)}function jn(e){return"string"==typeof e?new Pn([[document.querySelector(e)]],[document.documentElement]):new Pn([[e]],Mn)}function zn(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,[(o=o.matrixTransform(t.getScreenCTM().inverse())).x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}Pn.prototype=An.prototype={constructor:Pn,select:function(e){"function"!=typeof e&&(e=kt(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i,a,s=t[r],l=s.length,c=o[r]=new Array(l),d=0;d<l;++d)(i=s[d])&&(a=e.call(i,i.__data__,d,s))&&("__data__"in i&&(a.__data__=i.__data__),c[d]=a);return new Pn(o,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}(e):Mt(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var a,s=t[i],l=s.length,c=0;c<l;++c)(a=s[c])&&(o.push(e.call(a,a.__data__,c,s)),r.push(a));return new Pn(o,r)},selectChild:function(e){return this.select(null==e?zt:function(e){return function(){return jt.call(this.children,e)}}("function"==typeof e?e:At(e)))},selectChildren:function(e){return this.selectAll(null==e?Dt:function(e){return function(){return Ot.call(this.children,e)}}("function"==typeof e?e:At(e)))},filter:function(e){"function"!=typeof e&&(e=Pt(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i,a=t[r],s=a.length,l=o[r]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new Pn(o,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Lt);var n,o=t?$t:Tt,r=this._parents,i=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=i.length,s=new Array(a),l=new Array(a),c=new Array(a),d=0;d<a;++d){var u=r[d],h=i[d],f=h.length,g=Bt(e.call(u,u&&u.__data__,d,r)),p=g.length,m=l[d]=new Array(p),y=s[d]=new Array(p);o(u,h,m,y,c[d]=new Array(f),g,t);for(var v,x,b=0,w=0;b<p;++b)if(v=m[b]){for(b>=w&&(w=b+1);!(x=y[w])&&++w<p;);v._next=x||null}}return(s=new Pn(s,r))._enter=l,s._exit=c,s},enter:function(){return new Pn(this._enter||this._groups.map(It),this._parents)},exit:function(){return new Pn(this._exit||this._groups.map(It),this._parents)},join:function(e,t,n){var o=this.enter(),r=this,i=this.exit();return"function"==typeof e?(o=e(o))&&(o=o.selection()):o=o.append(e+""),null!=t&&(r=t(r))&&(r=r.selection()),null==n?i.remove():n(i),o&&r?o.merge(r).order():r},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,a=Math.min(r,i),s=new Array(r),l=0;l<a;++l)for(var c,d=n[l],u=o[l],h=d.length,f=s[l]=new Array(h),g=0;g<h;++g)(c=d[g]||u[g])&&(f[g]=c);for(;l<r;++l)s[l]=n[l];return new Pn(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o,r=e[t],i=r.length-1,a=r[i];--i>=0;)(o=r[i])&&(a&&4^o.compareDocumentPosition(a)&&a.parentNode.insertBefore(o,a),a=o);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Vt);for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var a,s=n[i],l=s.length,c=r[i]=new Array(l),d=0;d<l;++d)(a=s[d])&&(c[d]=a);c.sort(t)}return new Pn(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var a=o[r];if(a)return a}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r,i=t[n],a=0,s=i.length;a<s;++a)(r=i[a])&&e.call(r,r.__data__,a,i);return this},attr:function(e,t){var n=wt(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((null==t?n.local?Ft:Ht:"function"==typeof t?n.local?Xt:Zt:n.local?_n:Yt)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?qt:"function"==typeof t?Gt:Kt)(e,t,null==n?"":n)):Ut(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Qt:"function"==typeof t?en:Jt)(e,t)):this.node()[e]},classed:function(e,t){var n=tn(e+"");if(arguments.length<2){for(var o=nn(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?cn:t?sn:ln)(n,t))},text:function(e){return arguments.length?this.each(null==e?dn:("function"==typeof e?hn:un)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?fn:("function"==typeof e?pn:gn)(e)):this.node().innerHTML},raise:function(){return this.each(mn)},lower:function(){return this.each(yn)},append:function(e){var t="function"==typeof e?e:_t(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:_t(e),o=null==t?vn:"function"==typeof t?t:kt(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})},remove:function(){return this.each(xn)},clone:function(e){return this.select(e?wn:bn)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var o,r,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),a=i.length;if(!(arguments.length<2)){for(s=t?Cn:Sn,o=0;o<a;++o)this.each(s(i[o],t,n));return this}var s=this.node().__on;if(s)for(var l,c=0,d=s.length;c<d;++c)for(o=0,l=s[c];o<a;++o)if((r=i[o]).type===l.type&&r.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?Nn:kn)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o,r=e[t],i=0,a=r.length;i<a;++i)(o=r[i])&&(yield o)}};const On={passive:!1},Dn={capture:!0,passive:!1};function In(e){e.stopImmediatePropagation()}function Rn(e){e.preventDefault(),e.stopImmediatePropagation()}function Tn(e){var t=e.document.documentElement,n=jn(e).on("dragstart.drag",Rn,Dn);"onselectstart"in t?n.on("selectstart.drag",Rn,Dn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function $n(e,t){var n=e.document.documentElement,o=jn(e).on("dragstart.drag",null);t&&(o.on("click.drag",Rn,Dn),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ln=e=>()=>e;function Bn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:a,y:s,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}function Vn(e){return!e.ctrlKey&&!e.button}function Hn(){return this.parentNode}function Fn(e,t){return null==t?{x:e.x,y:e.y}:t}function Yn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zn(){var e,t,n,o,r=Vn,i=Hn,a=Fn,s=Yn,l={},c=pt("start","drag","end"),d=0,u=0;function h(e){e.on("mousedown.drag",f).filter(s).on("touchstart.drag",m).on("touchmove.drag",y,On).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(a,s){if(!o&&r.call(this,a,s)){var l=x(this,i.call(this,a,s),a,s,"mouse");l&&(jn(a.view).on("mousemove.drag",g,Dn).on("mouseup.drag",p,Dn),Tn(a.view),In(a),n=!1,e=a.clientX,t=a.clientY,l("start",a))}}function g(o){if(Rn(o),!n){var r=o.clientX-e,i=o.clientY-t;n=r*r+i*i>u}l.mouse("drag",o)}function p(e){jn(e.view).on("mousemove.drag mouseup.drag",null),$n(e.view,n),Rn(e),l.mouse("end",e)}function m(e,t){if(r.call(this,e,t)){var n,o,a=e.changedTouches,s=i.call(this,e,t),l=a.length;for(n=0;n<l;++n)(o=x(this,s,e,t,a[n].identifier,a[n]))&&(In(e),o("start",e,a[n]))}}function y(e){var t,n,o=e.changedTouches,r=o.length;for(t=0;t<r;++t)(n=l[o[t].identifier])&&(Rn(e),n("drag",e,o[t]))}function v(e){var t,n,r=e.changedTouches,i=r.length;for(o&&clearTimeout(o),o=setTimeout(function(){o=null},500),t=0;t<i;++t)(n=l[r[t].identifier])&&(In(e),n("end",e,r[t]))}function x(e,t,n,o,r,i){var s,u,f,g=c.copy(),p=zn(i||n,t);if(null!=(f=a.call(e,new Bn("beforestart",{sourceEvent:n,target:h,identifier:r,active:d,x:p[0],y:p[1],dx:0,dy:0,dispatch:g}),o)))return s=f.x-p[0]||0,u=f.y-p[1]||0,function n(i,a,c){var m,y=p;switch(i){case"start":l[r]=n,m=d++;break;case"end":delete l[r],--d;case"drag":p=zn(c||a,t),m=d}g.call(i,e,new Bn(i,{sourceEvent:a,subject:f,target:h,identifier:r,active:m,x:p[0]+s,y:p[1]+u,dx:p[0]-y[0],dy:p[1]-y[1],dispatch:g}),o)}}return h.filter=function(e){return arguments.length?(r="function"==typeof e?e:Ln(!!e),h):r},h.container=function(e){return arguments.length?(i="function"==typeof e?e:Ln(e),h):i},h.subject=function(e){return arguments.length?(a="function"==typeof e?e:Ln(e),h):a},h.touchable=function(e){return arguments.length?(s="function"==typeof e?e:Ln(!!e),h):s},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(u=(e=+e)*e,h):Math.sqrt(u)},h}function Xn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Wn(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function qn(){}Bn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Kn=.7,Gn=1/Kn,Un="\\s*([+-]?\\d+)\\s*",Qn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eo=/^#([0-9a-f]{3,8})$/,to=new RegExp(`^rgb\\(${Un},${Un},${Un}\\)$`),no=new RegExp(`^rgb\\(${Jn},${Jn},${Jn}\\)$`),oo=new RegExp(`^rgba\\(${Un},${Un},${Un},${Qn}\\)$`),ro=new RegExp(`^rgba\\(${Jn},${Jn},${Jn},${Qn}\\)$`),io=new RegExp(`^hsl\\(${Qn},${Jn},${Jn}\\)$`),ao=new RegExp(`^hsla\\(${Qn},${Jn},${Jn},${Qn}\\)$`),so={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function lo(){return this.rgb().formatHex()}function co(){return this.rgb().formatRgb()}function uo(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=eo.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ho(t):3===n?new po(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?fo(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?fo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=to.exec(e))?new po(t[1],t[2],t[3],1):(t=no.exec(e))?new po(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=oo.exec(e))?fo(t[1],t[2],t[3],t[4]):(t=ro.exec(e))?fo(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=io.exec(e))?wo(t[1],t[2]/100,t[3]/100,1):(t=ao.exec(e))?wo(t[1],t[2]/100,t[3]/100,t[4]):so.hasOwnProperty(e)?ho(so[e]):"transparent"===e?new po(NaN,NaN,NaN,0):null}function ho(e){return new po(e>>16&255,e>>8&255,255&e,1)}function fo(e,t,n,o){return o<=0&&(e=t=n=NaN),new po(e,t,n,o)}function go(e,t,n,o){return 1===arguments.length?((r=e)instanceof qn||(r=uo(r)),r?new po((r=r.rgb()).r,r.g,r.b,r.opacity):new po):new po(e,t,n,null==o?1:o);var r}function po(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}function mo(){return`#${bo(this.r)}${bo(this.g)}${bo(this.b)}`}function yo(){const e=vo(this.opacity);return`${1===e?"rgb(":"rgba("}${xo(this.r)}, ${xo(this.g)}, ${xo(this.b)}${1===e?")":`, ${e})`}`}function vo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function bo(e){return((e=xo(e))<16?"0":"")+e.toString(16)}function wo(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Co(e,t,n,o)}function So(e){if(e instanceof Co)return new Co(e.h,e.s,e.l,e.opacity);if(e instanceof qn||(e=uo(e)),!e)return new Co;if(e instanceof Co)return e;var t=(e=e.rgb()).r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),a=NaN,s=i-r,l=(i+r)/2;return s?(a=t===i?(n-o)/s+6*(n<o):n===i?(o-t)/s+2:(t-n)/s+4,s/=l<.5?i+r:2-i-r,a*=60):s=l>0&&l<1?0:a,new Co(a,s,l,e.opacity)}function Co(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}function _o(e){return(e=(e||0)%360)<0?e+360:e}function Eo(e){return Math.max(0,Math.min(1,e||0))}function ko(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Xn(qn,uo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lo,formatHex:lo,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return So(this).formatHsl()},formatRgb:co,toString:co}),Xn(po,go,Wn(qn,{brighter(e){return e=null==e?Gn:Math.pow(Gn,e),new po(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Kn:Math.pow(Kn,e),new po(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new po(xo(this.r),xo(this.g),xo(this.b),vo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mo,formatHex:mo,formatHex8:function(){return`#${bo(this.r)}${bo(this.g)}${bo(this.b)}${bo(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:yo,toString:yo})),Xn(Co,function(e,t,n,o){return 1===arguments.length?So(e):new Co(e,t,n,null==o?1:o)},Wn(qn,{brighter(e){return e=null==e?Gn:Math.pow(Gn,e),new Co(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Kn:Math.pow(Kn,e),new Co(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new po(ko(e>=240?e-240:e+120,r,o),ko(e,r,o),ko(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new Co(_o(this.h),Eo(this.s),Eo(this.l),vo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=vo(this.opacity);return`${1===e?"hsl(":"hsla("}${_o(this.h)}, ${100*Eo(this.s)}%, ${100*Eo(this.l)}%${1===e?")":`, ${e})`}`}}));var No=e=>()=>e;function Mo(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):No(isNaN(e)?t:e)}var Po=function e(t){var n=function(e){return 1===(e=+e)?Mo:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}(t,n,e):No(isNaN(t)?n:t)}}(t);function o(e,t){var o=n((e=go(e)).r,(t=go(t)).r),r=n(e.g,t.g),i=n(e.b,t.b),a=Mo(e.opacity,t.opacity);return function(t){return e.r=o(t),e.g=r(t),e.b=i(t),e.opacity=a(t),e+""}}return o.gamma=e,o}(1);function Ao(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var jo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zo=new RegExp(jo.source,"g");function Oo(e,t){var n,o,r,i=jo.lastIndex=zo.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=jo.exec(e))&&(o=zo.exec(t));)(r=o.index)>i&&(r=t.slice(i,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(o=o[0])?s[a]?s[a]+=o:s[++a]=o:(s[++a]=null,l.push({i:a,x:Ao(n,o)})),i=zo.lastIndex;return i<t.length&&(r=t.slice(i),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,o=0;o<t;++o)s[(n=l[o]).i]=n.x(e);return s.join("")})}var Do,Io=180/Math.PI,Ro={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function To(e,t,n,o,r,i){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(s=Math.sqrt(n*n+o*o))&&(n/=s,o/=s,l/=s),e*o<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*Io,skewX:Math.atan(l)*Io,scaleX:a,scaleY:s}}function $o(e,t,n,o){function r(e){return e.length?e.pop()+" ":""}return function(i,a){var s=[],l=[];return i=e(i),a=e(a),function(e,o,r,i,a,s){if(e!==r||o!==i){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:Ao(e,r)},{i:l-2,x:Ao(o,i)})}else(r||i)&&a.push("translate("+r+t+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,s,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(r(n)+"rotate(",null,o)-2,x:Ao(e,t)})):t&&n.push(r(n)+"rotate("+t+o)}(i.rotate,a.rotate,s,l),function(e,t,n,i){e!==t?i.push({i:n.push(r(n)+"skewX(",null,o)-2,x:Ao(e,t)}):t&&n.push(r(n)+"skewX("+t+o)}(i.skewX,a.skewX,s,l),function(e,t,n,o,i,a){if(e!==n||t!==o){var s=i.push(r(i)+"scale(",null,",",null,")");a.push({i:s-4,x:Ao(e,n)},{i:s-2,x:Ao(t,o)})}else 1===n&&1===o||i.push(r(i)+"scale("+n+","+o+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,s,l),i=a=null,function(e){for(var t,n=-1,o=l.length;++n<o;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var Lo=$o(function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ro:To(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),Bo=$o(function(e){return null==e?Ro:(Do||(Do=document.createElementNS("http://www.w3.org/2000/svg","g")),Do.setAttribute("transform",e),(e=Do.transform.baseVal.consolidate())?To((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Ro)},", ",")",")");function Vo(e){return((e=Math.exp(e))+1/e)/2}var Ho,Fo,Yo=function e(t,n,o){function r(e,r){var i,a,s=e[0],l=e[1],c=e[2],d=r[0],u=r[1],h=r[2],f=d-s,g=u-l,p=f*f+g*g;if(p<1e-12)a=Math.log(h/c)/t,i=function(e){return[s+e*f,l+e*g,c*Math.exp(t*e*a)]};else{var m=Math.sqrt(p),y=(h*h-c*c+o*p)/(2*c*n*m),v=(h*h-c*c-o*p)/(2*h*n*m),x=Math.log(Math.sqrt(y*y+1)-y),b=Math.log(Math.sqrt(v*v+1)-v);a=(b-x)/t,i=function(e){var o,r=e*a,i=Vo(x),d=c/(n*m)*(i*(o=t*r+x,((o=Math.exp(2*o))-1)/(o+1))-function(e){return((e=Math.exp(e))-1/e)/2}(x));return[s+d*f,l+d*g,c*i/Vo(t*r+x)]}}return i.duration=1e3*a*t/Math.SQRT2,i}return r.rho=function(t){var n=Math.max(.001,+t),o=n*n;return e(n,o,o*o)},r}(Math.SQRT2,2,4),Zo=0,Xo=0,Wo=0,qo=0,Ko=0,Go=0,Uo="object"==typeof performance&&performance.now?performance:Date,Qo="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Jo(){return Ko||(Qo(er),Ko=Uo.now()+Go)}function er(){Ko=0}function tr(){this._call=this._time=this._next=null}function nr(e,t,n){var o=new tr;return o.restart(e,t,n),o}function or(){Ko=(qo=Uo.now())+Go,Zo=Xo=0;try{!function(){Jo(),++Zo;for(var e,t=Ho;t;)(e=Ko-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Zo}()}finally{Zo=0,function(){for(var e,t,n=Ho,o=1/0;n;)n._call?(o>n._time&&(o=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Ho=t);Fo=e,ir(o)}(),Ko=0}}function rr(){var e=Uo.now(),t=e-qo;t>1e3&&(Go-=t,qo=e)}function ir(e){Zo||(Xo&&(Xo=clearTimeout(Xo)),e-Ko>24?(e<1/0&&(Xo=setTimeout(or,e-Uo.now()-Go)),Wo&&(Wo=clearInterval(Wo))):(Wo||(qo=Uo.now(),Wo=setInterval(rr,1e3)),Zo=1,Qo(or)))}function ar(e,t,n){var o=new tr;return t=null==t?0:+t,o.restart(n=>{o.stop(),e(n+t)},t,n),o}tr.prototype=nr.prototype={constructor:tr,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Jo():+n)+(null==t?0:+t),this._next||Fo===this||(Fo?Fo._next=this:Ho=this,Fo=this),this._call=e,this._time=n,ir()},stop:function(){this._call&&(this._call=null,this._time=1/0,ir())}};var sr=pt("start","end","cancel","interrupt"),lr=[];function cr(e,t,n,o,r,i){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var o,r=e.__transition;function i(l){var c,d,u,h;if(1!==n.state)return s();for(c in r)if((h=r[c]).name===n.name){if(3===h.state)return ar(i);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(ar(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,o=new Array(u=n.tween.length),c=0,d=-1;c<u;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=h);o.length=d+1}}function a(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),i=-1,a=o.length;++i<a;)o[i].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var o in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=nr(function(e){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=e&&i(e-n.delay)},0,n.time)}(e,n,{name:t,index:o,group:r,on:sr,tween:lr,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function dr(e,t){var n=hr(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function ur(e,t){var n=hr(e,t);if(n.state>3)throw new Error("too late; already running");return n}function hr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function fr(e,t){var n,o,r,i=e.__transition,a=!0;if(i){for(r in t=null==t?null:t+"",i)(n=i[r]).name===t?(o=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(o?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[r]):a=!1;a&&delete e.__transition}}function gr(e,t){var n,o;return function(){var r=ur(this,e),i=r.tween;if(i!==n)for(var a=0,s=(o=n=i).length;a<s;++a)if(o[a].name===t){(o=o.slice()).splice(a,1);break}r.tween=o}}function pr(e,t,n){var o,r;if("function"!=typeof n)throw new Error;return function(){var i=ur(this,e),a=i.tween;if(a!==o){r=(o=a).slice();for(var s={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=s;break}l===c&&r.push(s)}i.tween=r}}function mr(e,t,n){var o=e._id;return e.each(function(){var e=ur(this,o);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return hr(e,o).value[t]}}function yr(e,t){var n;return("number"==typeof t?Ao:t instanceof uo?Po:(n=uo(t))?(t=n,Po):Oo)(e,t)}function vr(e){return function(){this.removeAttribute(e)}}function xr(e){return function(){this.removeAttributeNS(e.space,e.local)}}function br(e,t,n){var o,r,i=n+"";return function(){var a=this.getAttribute(e);return a===i?null:a===o?r:r=t(o=a,n)}}function wr(e,t,n){var o,r,i=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===o?r:r=t(o=a,n)}}function Sr(e,t,n){var o,r,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(e))===(s=l+"")?null:a===o&&s===r?i:(r=s,i=t(o=a,l));this.removeAttribute(e)}}function Cr(e,t,n){var o,r,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===o&&s===r?i:(r=s,i=t(o=a,l));this.removeAttributeNS(e.space,e.local)}}function _r(e,t){var n,o;function r(){var r=t.apply(this,arguments);return r!==o&&(n=(o=r)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,r)),n}return r._value=t,r}function Er(e,t){var n,o;function r(){var r=t.apply(this,arguments);return r!==o&&(n=(o=r)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,r)),n}return r._value=t,r}function kr(e,t){return function(){dr(this,e).delay=+t.apply(this,arguments)}}function Nr(e,t){return t=+t,function(){dr(this,e).delay=t}}function Mr(e,t){return function(){ur(this,e).duration=+t.apply(this,arguments)}}function Pr(e,t){return t=+t,function(){ur(this,e).duration=t}}var Ar=An.prototype.constructor;function jr(e){return function(){this.style.removeProperty(e)}}var zr=0;function Or(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function Dr(){return++zr}var Ir=An.prototype;Or.prototype={constructor:Or,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=kt(e));for(var o=this._groups,r=o.length,i=new Array(r),a=0;a<r;++a)for(var s,l,c=o[a],d=c.length,u=i[a]=new Array(d),h=0;h<d;++h)(s=c[h])&&(l=e.call(s,s.__data__,h,c))&&("__data__"in s&&(l.__data__=s.__data__),u[h]=l,cr(u[h],t,n,h,u,hr(s,n)));return new Or(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Mt(e));for(var o=this._groups,r=o.length,i=[],a=[],s=0;s<r;++s)for(var l,c=o[s],d=c.length,u=0;u<d;++u)if(l=c[u]){for(var h,f=e.call(l,l.__data__,u,c),g=hr(l,n),p=0,m=f.length;p<m;++p)(h=f[p])&&cr(h,t,n,p,f,g);i.push(f),a.push(l)}return new Or(i,a,t,n)},selectChild:Ir.selectChild,selectChildren:Ir.selectChildren,filter:function(e){"function"!=typeof e&&(e=Pt(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i,a=t[r],s=a.length,l=o[r]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new Or(o,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),a=new Array(o),s=0;s<i;++s)for(var l,c=t[s],d=n[s],u=c.length,h=a[s]=new Array(u),f=0;f<u;++f)(l=c[f]||d[f])&&(h[f]=l);for(;s<o;++s)a[s]=t[s];return new Or(a,this._parents,this._name,this._id)},selection:function(){return new Ar(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Dr(),o=this._groups,r=o.length,i=0;i<r;++i)for(var a,s=o[i],l=s.length,c=0;c<l;++c)if(a=s[c]){var d=hr(a,t);cr(a,e,n,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Or(o,this._parents,e,n)},call:Ir.call,nodes:Ir.nodes,node:Ir.node,size:Ir.size,empty:Ir.empty,each:Ir.each,on:function(e,t){var n=this._id;return arguments.length<2?hr(this.node(),n).on.on(e):this.each(function(e,t,n){var o,r,i=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?dr:ur;return function(){var a=i(this,e),s=a.on;s!==o&&(r=(o=s).copy()).on(t,n),a.on=r}}(n,e,t))},attr:function(e,t){var n=wt(e),o="transform"===n?Bo:yr;return this.attrTween(e,"function"==typeof t?(n.local?Cr:Sr)(n,o,mr(this,"attr."+e,t)):null==t?(n.local?xr:vr)(n):(n.local?wr:br)(n,o,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var o=wt(e);return this.tween(n,(o.local?_r:Er)(o,t))},style:function(e,t,n){var o="transform"==(e+="")?Lo:yr;return null==t?this.styleTween(e,function(e,t){var n,o,r;return function(){var i=Ut(this,e),a=(this.style.removeProperty(e),Ut(this,e));return i===a?null:i===n&&a===o?r:r=t(n=i,o=a)}}(e,o)).on("end.style."+e,jr(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var o,r,i;return function(){var a=Ut(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=Ut(this,e)),a===l?null:a===o&&l===r?i:(r=l,i=t(o=a,s))}}(e,o,mr(this,"style."+e,t))).each(function(e,t){var n,o,r,i,a="style."+t,s="end."+a;return function(){var l=ur(this,e),c=l.on,d=null==l.value[a]?i||(i=jr(t)):void 0;c===n&&r===d||(o=(n=c).copy()).on(s,r=d),l.on=o}}(this._id,e)):this.styleTween(e,function(e,t,n){var o,r,i=n+"";return function(){var a=Ut(this,e);return a===i?null:a===o?r:r=t(o=a,n)}}(e,o,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==t)return this.tween(o,null);if("function"!=typeof t)throw new Error;return this.tween(o,function(e,t,n){var o,r;function i(){var i=t.apply(this,arguments);return i!==r&&(o=(r=i)&&function(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}(e,i,n)),o}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(mr(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,n;function o(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&function(e){return function(t){this.textContent=e.call(this,t)}}(o)),t}return o._value=e,o}(e))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o,r=hr(this.node(),n).tween,i=0,a=r.length;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((null==t?gr:pr)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?kr:Nr)(t,e)):hr(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Mr:Pr)(t,e)):hr(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){ur(this,e).ease=t}}(t,e)):hr(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;ur(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,a){var s={value:a},l={value:function(){0===--r&&i()}};n.each(function(){var n=ur(this,o),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t}),0===r&&i()})},[Symbol.iterator]:Ir[Symbol.iterator]};var Rr={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Tr(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}An.prototype.interrupt=function(e){return this.each(function(){fr(this,e)})},An.prototype.transition=function(e){var t,n;e instanceof Or?(t=e._id,e=e._name):(t=Dr(),(n=Rr).time=Jo(),e=null==e?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var a,s=o[i],l=s.length,c=0;c<l;++c)(a=s[c])&&cr(a,e,t,c,s,n||Tr(a,t));return new Or(o,this._parents,e,t)};var $r=e=>()=>e;function Lr(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function Br(e,t,n){this.k=e,this.x=t,this.y=n}Br.prototype={constructor:Br,scale:function(e){return 1===e?this:new Br(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Br(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Vr=new Br(1,0,0);function Hr(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Vr;return e.__zoom}function Fr(e){e.stopImmediatePropagation()}function Yr(e){e.preventDefault(),e.stopImmediatePropagation()}function Zr(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function Xr(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Wr(){return this.__zoom||Vr}function qr(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Kr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Gr(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function Ur(){var e,t,n,o=Zr,r=Xr,i=Gr,a=qr,s=Kr,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],d=250,u=Yo,h=pt("start","zoom","end"),f=0,g=10;function p(e){e.property("__zoom",Wr).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",_).filter(s).on("touchstart.zoom",E).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new Br(t,e.x,e.y)}function y(e,t,n){var o=t[0]-n[0]*e.k,r=t[1]-n[1]*e.k;return o===e.x&&r===e.y?e:new Br(e.k,o,r)}function v(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,t,n,o){e.on("start.zoom",function(){b(this,arguments).event(o).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(o).end()}).tween("zoom",function(){var e=this,i=arguments,a=b(e,i).event(o),s=r.apply(e,i),l=null==n?v(s):"function"==typeof n?n.apply(e,i):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),d=e.__zoom,h="function"==typeof t?t.apply(e,i):t,f=u(d.invert(l).concat(c/d.k),h.invert(l).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=f(e),n=c/t[2];e=new Br(n,l[0]-t[0]*n,l[1]-t[1]*n)}a.zoom(null,e)}})}function b(e,t,n){return!n&&e.__zooming||new w(e,t)}function w(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=r.apply(e,t),this.taps=0}function S(e,...t){if(o.apply(this,arguments)){var n=b(this,t).event(e),r=this.__zoom,s=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,a.apply(this,arguments)))),d=zn(e);if(n.wheel)n.mouse[0][0]===d[0]&&n.mouse[0][1]===d[1]||(n.mouse[1]=r.invert(n.mouse[0]=d)),clearTimeout(n.wheel);else{if(r.k===s)return;n.mouse=[d,r.invert(d)],fr(this),n.start()}Yr(e),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",i(y(m(r,s),n.mouse[0],n.mouse[1]),n.extent,c))}}function C(e,...t){if(!n&&o.apply(this,arguments)){var r=e.currentTarget,a=b(this,t,!0).event(e),s=jn(e.view).on("mousemove.zoom",function(e){if(Yr(e),!a.moved){var t=e.clientX-d,n=e.clientY-u;a.moved=t*t+n*n>f}a.event(e).zoom("mouse",i(y(a.that.__zoom,a.mouse[0]=zn(e,r),a.mouse[1]),a.extent,c))},!0).on("mouseup.zoom",function(e){s.on("mousemove.zoom mouseup.zoom",null),$n(e.view,a.moved),Yr(e),a.event(e).end()},!0),l=zn(e,r),d=e.clientX,u=e.clientY;Tn(e.view),Fr(e),a.mouse=[l,this.__zoom.invert(l)],fr(this),a.start()}}function _(e,...t){if(o.apply(this,arguments)){var n=this.__zoom,a=zn(e.changedTouches?e.changedTouches[0]:e,this),s=n.invert(a),l=n.k*(e.shiftKey?.5:2),u=i(y(m(n,l),a,s),r.apply(this,t),c);Yr(e),d>0?jn(this).transition().duration(d).call(x,u,a,e):jn(this).call(p.transform,u,a,e)}}function E(n,...r){if(o.apply(this,arguments)){var i,a,s,l,c=n.touches,d=c.length,u=b(this,r,n.changedTouches.length===d).event(n);for(Fr(n),a=0;a<d;++a)l=[l=zn(s=c[a],this),this.__zoom.invert(l),s.identifier],u.touch0?u.touch1||u.touch0[2]===l[2]||(u.touch1=l,u.taps=0):(u.touch0=l,i=!0,u.taps=1+!!e);e&&(e=clearTimeout(e)),i&&(u.taps<2&&(t=l[0],e=setTimeout(function(){e=null},500)),fr(this),u.start())}}function k(e,...t){if(this.__zooming){var n,o,r,a,s=b(this,t).event(e),l=e.changedTouches,d=l.length;for(Yr(e),n=0;n<d;++n)r=zn(o=l[n],this),s.touch0&&s.touch0[2]===o.identifier?s.touch0[0]=r:s.touch1&&s.touch1[2]===o.identifier&&(s.touch1[0]=r);if(o=s.that.__zoom,s.touch1){var u=s.touch0[0],h=s.touch0[1],f=s.touch1[0],g=s.touch1[1],p=(p=f[0]-u[0])*p+(p=f[1]-u[1])*p,v=(v=g[0]-h[0])*v+(v=g[1]-h[1])*v;o=m(o,Math.sqrt(p/v)),r=[(u[0]+f[0])/2,(u[1]+f[1])/2],a=[(h[0]+g[0])/2,(h[1]+g[1])/2]}else{if(!s.touch0)return;r=s.touch0[0],a=s.touch0[1]}s.zoom("touch",i(y(o,r,a),s.extent,c))}}function N(e,...o){if(this.__zooming){var r,i,a=b(this,o).event(e),s=e.changedTouches,l=s.length;for(Fr(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),r=0;r<l;++r)i=s[r],a.touch0&&a.touch0[2]===i.identifier?delete a.touch0:a.touch1&&a.touch1[2]===i.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(i=zn(i,this),Math.hypot(t[0]-i[0],t[1]-i[1])<g)){var c=jn(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return p.transform=function(e,t,n,o){var r=e.selection?e.selection():e;r.property("__zoom",Wr),e!==r?x(e,t,n,o):r.interrupt().each(function(){b(this,arguments).event(o).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},p.scaleBy=function(e,t,n,o){p.scaleTo(e,function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)},n,o)},p.scaleTo=function(e,t,n,o){p.transform(e,function(){var e=r.apply(this,arguments),o=this.__zoom,a=null==n?v(e):"function"==typeof n?n.apply(this,arguments):n,s=o.invert(a),l="function"==typeof t?t.apply(this,arguments):t;return i(y(m(o,l),a,s),e,c)},n,o)},p.translateBy=function(e,t,n,o){p.transform(e,function(){return i(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)},null,o)},p.translateTo=function(e,t,n,o,a){p.transform(e,function(){var e=r.apply(this,arguments),a=this.__zoom,s=null==o?v(e):"function"==typeof o?o.apply(this,arguments):o;return i(Vr.translate(s[0],s[1]).scale(a.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)},o,a)},w.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=jn(this.that).datum();h.call(e,this.that,new Lr(e,{sourceEvent:this.sourceEvent,target:p,transform:this.that.__zoom,dispatch:h}),t)}},p.wheelDelta=function(e){return arguments.length?(a="function"==typeof e?e:$r(+e),p):a},p.filter=function(e){return arguments.length?(o="function"==typeof e?e:$r(!!e),p):o},p.touchable=function(e){return arguments.length?(s="function"==typeof e?e:$r(!!e),p):s},p.extent=function(e){return arguments.length?(r="function"==typeof e?e:$r([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),p):r},p.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],p):[l[0],l[1]]},p.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],p):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},p.constrain=function(e){return arguments.length?(i=e,p):i},p.duration=function(e){return arguments.length?(d=+e,p):d},p.interpolate=function(e){return arguments.length?(u=e,p):u},p.on=function(){var e=h.on.apply(h,arguments);return e===h?p:e},p.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,p):Math.sqrt(f)},p.tapDistance=function(e){return arguments.length?(g=+e,p):g},p}Hr.prototype=Br.prototype;const Qr=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Jr=["Enter"," ","Escape"];var ei,ti,ni,oi;(oi=ei||(ei={})).Strict="strict",oi.Loose="loose",function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(ti||(ti={})),function(e){e.Partial="partial",e.Full="full"}(ni||(ni={}));const ri={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var ii,ai,si;!function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(ii||(ii={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(ai||(ai={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(si||(si={}));const li={[si.Left]:si.Right,[si.Right]:si.Left,[si.Top]:si.Bottom,[si.Bottom]:si.Top};function ci(e){return null===e?null:e?"valid":"invalid"}const di=e=>"id"in e&&"source"in e&&"target"in e,ui=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),hi=(e,t=[0,0])=>{const{width:n,height:o}=$i(e),r=e.origin??t,i=n*r[0],a=o*r[1];return{x:e.position.x-i,y:e.position.y-a}},fi=(e,t={})=>{if(0===e.size)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(e=>{if(void 0===t.filter||t.filter(e)){const t=Ei(e);n=wi(n,t)}}),Ci(n)},gi=(e,t,[n,o,r]=[0,0,1],i=!1,a=!1)=>{const s={...zi(t,[n,o,r]),width:t.width/r,height:t.height/r},l=[];for(const t of e.values()){const{measured:e,selectable:n=!0,hidden:o=!1}=t;if(a&&!n||o)continue;const r=e.width??t.width??t.initialWidth??null,c=e.height??t.height??t.initialHeight??null,d=Ni(s,_i(t)),u=(r??0)*(c??0),h=i&&d>0;(!t.internals.handleBounds||h||d>=u||t.dragging)&&l.push(t)}return l};function pi({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){const a=n.get(e),s=a.parentId?n.get(a.parentId):void 0,{x:l,y:c}=s?s.internals.positionAbsolute:{x:0,y:0},d=a.origin??o;let u=r;if("parent"!==a.extent||a.expandParent)s&&Ti(a.extent)&&(u=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);else if(s){const e=s.measured.width,t=s.measured.height;e&&t&&(u=[[l,c],[l+e,c+t]])}else i?.("005","Only child nodes can use a parent extent.");const h=Ti(u)?yi(t,u,a.measured):t;return void 0!==a.measured.width&&void 0!==a.measured.height||i?.("015","It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."),{position:{x:h.x-l+(a.measured.width??0)*d[0],y:h.y-c+(a.measured.height??0)*d[1]},positionAbsolute:h}}const mi=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),yi=(e={x:0,y:0},t,n)=>({x:mi(e.x,t[0][0],t[1][0]-(n?.width??0)),y:mi(e.y,t[0][1],t[1][1]-(n?.height??0))});function vi(e,t,n){const{width:o,height:r}=$i(n),{x:i,y:a}=n.internals.positionAbsolute;return yi(e,[[i,a],[i+o,a+r]],t)}const xi=(e,t,n)=>e<t?mi(Math.abs(e-t),1,t)/t:e>n?-mi(Math.abs(e-n),1,t)/t:0,bi=(e,t,n=15,o=40)=>[xi(e.x,o,t.width-o)*n,xi(e.y,o,t.height-o)*n],wi=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Si=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),Ci=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),_i=(e,t=[0,0])=>{const{x:n,y:o}=ui(e)?e.internals.positionAbsolute:hi(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Ei=(e,t=[0,0])=>{const{x:n,y:o}=ui(e)?e.internals.positionAbsolute:hi(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},ki=(e,t)=>Ci(wi(Si(e),Si(t))),Ni=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Mi=e=>Pi(e.width)&&Pi(e.height)&&Pi(e.x)&&Pi(e.y),Pi=e=>!isNaN(e)&&isFinite(e),Ai=(e,t)=>{},ji=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),zi=({x:e,y:t},[n,o,r],i=!1,a=[1,1])=>{const s={x:(e-n)/r,y:(t-o)/r};return i?ji(s,a):s},Oi=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function Di(e,t){if("number"==typeof e)return Math.floor(.5*(t-t/(1+e)));if("string"==typeof e&&e.endsWith("px")){const t=parseFloat(e);if(!Number.isNaN(t))return Math.floor(t)}if("string"==typeof e&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}const Ii=(e,t,n,o,r,i)=>{const a=function(e,t,n){if("string"==typeof e||"number"==typeof e){const o=Di(e,n),r=Di(e,t);return{top:o,right:r,bottom:o,left:r,x:2*r,y:2*o}}if("object"==typeof e){const o=Di(e.top??e.y??0,n),r=Di(e.bottom??e.y??0,n),i=Di(e.left??e.x??0,t),a=Di(e.right??e.x??0,t);return{top:o,right:a,bottom:r,left:i,x:i+a,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}(i,t,n),s=(t-a.x)/e.width,l=(n-a.y)/e.height,c=Math.min(s,l),d=mi(c,o,r),u=t/2-(e.x+e.width/2)*d,h=n/2-(e.y+e.height/2)*d,f=function(e,t,n,o,r,i){const{x:a,y:s}=Oi(e,[t,n,o]),{x:l,y:c}=Oi({x:e.x+e.width,y:e.y+e.height},[t,n,o]),d=r-l,u=i-c;return{left:Math.floor(a),top:Math.floor(s),right:Math.floor(d),bottom:Math.floor(u)}}(e,u,h,d,t,n),g=Math.min(f.left-a.left,0),p=Math.min(f.top-a.top,0);return{x:u-g+Math.min(f.right-a.right,0),y:h-p+Math.min(f.bottom-a.bottom,0),zoom:d}},Ri=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0;function Ti(e){return void 0!==e&&"parent"!==e}function $i(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Li(e){return void 0!==(e.measured?.width??e.width??e.initialWidth)&&void 0!==(e.measured?.height??e.height??e.initialHeight)}function Bi(e,t={width:0,height:0},n,o,r){const i={...e},a=o.get(n);if(a){const e=a.origin||r;i.x+=a.internals.positionAbsolute.x-(t.width??0)*e[0],i.y+=a.internals.positionAbsolute.y-(t.height??0)*e[1]}return i}function Vi(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Hi(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:i,y:a}=qi(e),s=zi({x:i-(r?.left??0),y:a-(r?.top??0)},o),{x:l,y:c}=n?ji(s,t):s;return{xSnapped:l,ySnapped:c,...s}}const Fi=e=>({width:e.offsetWidth,height:e.offsetHeight}),Yi=e=>e?.getRootNode?.()||window?.document,Zi=["INPUT","SELECT","TEXTAREA"];function Xi(e){const t=e.composedPath?.()?.[0]||e.target;return 1===t?.nodeType&&(Zi.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey"))}const Wi=e=>"clientX"in e,qi=(e,t)=>{const n=Wi(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},Ki=(e,t,n,o,r)=>{const i=t.querySelectorAll(`.${e}`);return i&&i.length?Array.from(i).map(t=>{const i=t.getBoundingClientRect();return{id:t.getAttribute("data-handleid"),type:e,nodeId:r,position:t.getAttribute("data-handlepos"),x:(i.left-n.left)/o,y:(i.top-n.top)/o,...Fi(t)}}):null};function Gi({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:a,targetControlY:s}){const l=.125*e+.375*r+.375*a+.125*n,c=.125*t+.375*i+.375*s+.125*o;return[l,c,Math.abs(l-e),Math.abs(c-t)]}function Ui(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function Qi({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case si.Left:return[t-Ui(t-o,i),n];case si.Right:return[t+Ui(o-t,i),n];case si.Top:return[t,n-Ui(n-r,i)];case si.Bottom:return[t,n+Ui(r-n,i)]}}function Ji({sourceX:e,sourceY:t,sourcePosition:n=si.Bottom,targetX:o,targetY:r,targetPosition:i=si.Top,curvature:a=.25}){const[s,l]=Qi({pos:n,x1:e,y1:t,x2:o,y2:r,c:a}),[c,d]=Qi({pos:i,x1:o,y1:r,x2:e,y2:t,c:a}),[u,h,f,g]=Gi({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:s,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${s},${l} ${c},${d} ${o},${r}`,u,h,f,g]}function ea({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,a=Math.abs(o-t)/2;return[i,o<t?o+a:o-a,r,a]}function ta({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const i=wi(Ei(e),Ei(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const a={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return Ni(a,Ci(i))>0}const na=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`;function oa({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,i,a,s]=ea({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,a,s]}const ra={[si.Left]:{x:-1,y:0},[si.Right]:{x:1,y:0},[si.Top]:{x:0,y:-1},[si.Bottom]:{x:0,y:1}},ia=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function aa({sourceX:e,sourceY:t,sourcePosition:n=si.Bottom,targetX:o,targetY:r,targetPosition:i=si.Top,borderRadius:a=5,centerX:s,centerY:l,offset:c=20}){const[d,u,h,f,g]=function({source:e,sourcePosition:t=si.Bottom,target:n,targetPosition:o=si.Top,center:r,offset:i}){const a=ra[t],s=ra[o],l={x:e.x+a.x*i,y:e.y+a.y*i},c={x:n.x+s.x*i,y:n.y+s.y*i},d=(({source:e,sourcePosition:t=si.Bottom,target:n})=>t===si.Left||t===si.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1})({source:l,sourcePosition:t,target:c}),u=0!==d.x?"x":"y",h=d[u];let f,g,p=[];const m={x:0,y:0},y={x:0,y:0},[v,x,b,w]=ea({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[u]*s[u]===-1){f=r.x??v,g=r.y??x;const e=[{x:f,y:l.y},{x:f,y:c.y}],t=[{x:l.x,y:g},{x:c.x,y:g}];p=a[u]===h?"x"===u?e:t:"x"===u?t:e}else{const r=[{x:l.x,y:c.y}],d=[{x:c.x,y:l.y}];if(p="x"===u?a.x===h?d:r:a.y===h?r:d,t===o){const t=Math.abs(e[u]-n[u]);if(t<=i){const o=Math.min(i-1,i-t);a[u]===h?m[u]=(l[u]>e[u]?-1:1)*o:y[u]=(c[u]>n[u]?-1:1)*o}}if(t!==o){const e="x"===u?"y":"x",t=a[u]===s[e],n=l[e]>c[e],o=l[e]<c[e];(1===a[u]&&(!t&&n||t&&o)||1!==a[u]&&(!t&&o||t&&n))&&(p="x"===u?r:d)}const v={x:l.x+m.x,y:l.y+m.y},x={x:c.x+y.x,y:c.y+y.y};Math.max(Math.abs(v.x-p[0].x),Math.abs(x.x-p[0].x))>=Math.max(Math.abs(v.y-p[0].y),Math.abs(x.y-p[0].y))?(f=(v.x+x.x)/2,g=p[0].y):(f=p[0].x,g=(v.y+x.y)/2)}return[[e,{x:l.x+m.x,y:l.y+m.y},...p,{x:c.x+y.x,y:c.y+y.y},n],f,g,b,w]}({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:s,y:l},offset:c});return[d.reduce((e,t,n)=>{let o="";return o=n>0&&n<d.length-1?function(e,t,n,o){const r=Math.min(ia(e,t)/2,ia(t,n)/2,o),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a)return`L ${i+r*(e.x<n.x?-1:1)},${a}Q ${i},${a} ${i},${a+r*(e.y<n.y?1:-1)}`;const s=e.x<n.x?1:-1;return`L ${i},${a+r*(e.y<n.y?-1:1)}Q ${i},${a} ${i+r*s},${a}`}(d[n-1],t,d[n+1],a):`${0===n?"M":"L"}${t.x} ${t.y}`,e+o},""),u,h,f,g]}function sa(e){return e&&!(!e.internals.handleBounds&&!e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function la(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,"source"===o.type?t.push(o):"target"===o.type&&n.push(o);return{source:t,target:n}}function ca(e,t,n=si.Left,o=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:a,height:s}=t??$i(e);if(o)return{x:r+a/2,y:i+s/2};switch(t?.position??n){case si.Top:return{x:r+a/2,y:i};case si.Right:return{x:r+a,y:i+s/2};case si.Bottom:return{x:r+a/2,y:i+s};case si.Left:return{x:r,y:i+s/2}}}function da(e,t){return e&&(t?e.find(e=>e.id===t):e[0])||null}function ua(e,t){return e?"string"==typeof e?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(t=>`${t}=${e[t]}`).join("&")}`:""}const ha={nodeOrigin:[0,0],nodeExtent:Qr,elevateNodesOnSelect:!0,defaults:{}},fa={...ha,checkEquality:!0};function ga(e,t){const n={...e};for(const e in t)void 0!==t[e]&&(n[e]=t[e]);return n}function pa(e,t,n,o){const r=ga(fa,o);let i=e.length>0;const a=new Map(t),s=r?.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let e=a.get(l.id);if(r.checkEquality&&l===e?.internals.userNode)t.set(l.id,e);else{const n=hi(l,r.nodeOrigin),o=Ti(l.extent)?l.extent:r.nodeExtent,i=yi(n,o,$i(l));e={...r.defaults,...l,measured:{width:l.measured?.width,height:l.measured?.height},internals:{positionAbsolute:i,handleBounds:l.measured?e?.internals.handleBounds:void 0,z:ya(l,s),userNode:l}},t.set(l.id,e)}void 0!==e.measured&&void 0!==e.measured.width&&void 0!==e.measured.height||e.hidden||(i=!1),l.parentId&&ma(e,t,n,o)}return i}function ma(e,t,n,o){const{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:a}=ga(ha,o),s=e.parentId,l=t.get(s);if(!l)return void console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);!function(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}(e,n);const c=r?1e3:0,{x:d,y:u,z:h}=function(e,t,n,o,r){const{x:i,y:a}=t.internals.positionAbsolute,s=$i(e),l=hi(e,n),c=Ti(e.extent)?yi(l,e.extent,s):l;let d=yi({x:i+c.x,y:a+c.y},o,s);"parent"===e.extent&&(d=vi(d,s,t));const u=ya(e,r),h=t.internals.z??0;return{x:d.x,y:d.y,z:h>u?h:u}}(e,l,i,a,c),{positionAbsolute:f}=e.internals,g=d!==f.x||u!==f.y;(g||h!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:g?{x:d,y:u}:f,z:h}})}function ya(e,t){return(Pi(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function va(e,t,n,o=[0,0]){const r=[],i=new Map;for(const n of e){const e=t.get(n.parentId);if(!e)continue;const o=i.get(n.parentId)?.expandedRect??_i(e),r=ki(o,n.rect);i.set(n.parentId,{expandedRect:r,parent:e})}return i.size>0&&i.forEach(({expandedRect:t,parent:i},a)=>{const s=i.internals.positionAbsolute,l=$i(i),c=i.origin??o,d=t.x<s.x?Math.round(Math.abs(s.x-t.x)):0,u=t.y<s.y?Math.round(Math.abs(s.y-t.y)):0,h=Math.max(l.width,Math.round(t.width)),f=Math.max(l.height,Math.round(t.height)),g=(h-l.width)*c[0],p=(f-l.height)*c[1];(d>0||u>0||g||p)&&(r.push({id:a,type:"position",position:{x:i.position.x-d+g,y:i.position.y-u+p}}),n.get(a)?.forEach(t=>{e.some(e=>e.id===t.id)||r.push({id:t.id,type:"position",position:{x:t.position.x+d,y:t.position.y+u}})})),(l.width<t.width||l.height<t.height||d||u)&&r.push({id:a,type:"dimensions",setAttributes:!0,dimensions:{width:h+(d?c[0]*d-g:0),height:f+(u?c[1]*u-p:0)}})}),r}function xa(e,t,n,o,r,i){let a=r;const s=o.get(a)||new Map;o.set(a,s.set(n,t)),a=`${r}-${e}`;const l=o.get(a)||new Map;if(o.set(a,l.set(n,t)),i){a=`${r}-${e}-${i}`;const s=o.get(a)||new Map;o.set(a,s.set(n,t))}}function ba(e,t,n){e.clear(),t.clear();for(const o of n){const{source:n,target:r,sourceHandle:i=null,targetHandle:a=null}=o,s={edgeId:o.id,source:n,target:r,sourceHandle:i,targetHandle:a},l=`${n}-${i}--${r}-${a}`;xa("source",s,`${r}-${a}--${n}-${i}`,e,n,i),xa("target",s,l,e,r,a),t.set(o.id,o)}}function wa(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return!!n&&(!!n.selected||wa(n,t))}function Sa(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function Ca({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const r=[];for(const[e,i]of t){const t=n.get(e)?.internals.userNode;t&&r.push({...t,position:i.position,dragging:o})}if(!e)return[r[0],r];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function _a(e,t,n,o,r,i=!1){const a=o.get(e);if(!a)return null;const s="strict"===r?a.internals.handleBounds?.[t]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],l=(n?s?.find(e=>e.id===n):s?.[0])??null;return l&&i?{...l,...ca(a,l,l.position,!0)}:l}function Ea(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}const ka=()=>!0;function Na(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:a,lib:s,flowId:l,isValidConnection:c=ka,nodeLookup:d}){const u="target"===i,h=t?a.querySelector(`.${s}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:f,y:g}=qi(e),p=a.elementFromPoint(f,g),m=p?.classList.contains(`${s}-flow__handle`)?p:h,y={handleDomNode:m,isValid:!1,connection:null,toHandle:null};if(m){const e=Ea(void 0,m),t=m.getAttribute("data-nodeid"),i=m.getAttribute("data-handleid"),a=m.classList.contains("connectable"),s=m.classList.contains("connectableend");if(!t||!e)return y;const l={source:u?t:o,sourceHandle:u?i:r,target:u?o:t,targetHandle:u?r:i};y.connection=l;const h=a&&s&&(n===ei.Strict?u&&"source"===e||!u&&"target"===e:t!==o||i!==r);y.isValid=h&&c(l),y.toHandle=_a(t,e,i,d,n,!0)}return y}const Ma={onPointerDown:function(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:a,domNode:s,nodeLookup:l,lib:c,autoPanOnConnect:d,flowId:u,panBy:h,cancelConnection:f,onConnectStart:g,onConnect:p,onConnectEnd:m,isValidConnection:y=ka,onReconnectEnd:v,updateConnection:x,getTransform:b,getFromHandle:w,autoPanSpeed:S}){const C=Yi(e.target);let _,E=0;const{x:k,y:N}=qi(e),M=C?.elementFromPoint(k,N),P=Ea(i,M),A=s?.getBoundingClientRect();if(!A||!P)return;const j=_a(r,P,o,l,t);if(!j)return;let z=qi(e,A),O=!1,D=null,I=!1,R=null;function T(){if(!d||!A)return;const[e,t]=bi(z,A,S);h({x:e,y:t}),E=requestAnimationFrame(T)}const $={...j,nodeId:r,type:P,position:j.position},L=l.get(r),B={inProgress:!0,isValid:null,from:ca(L,$,si.Left,!0),fromHandle:$,fromPosition:$.position,fromNode:L,to:z,toHandle:null,toPosition:li[$.position],toNode:null};x(B);let V=B;function H(e){if(!w()||!$)return void F(e);const i=b();z=qi(e,A),_=function(e,t,n,o){let r=[],i=1/0;const a=function(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:2*n,height:2*n};for(const e of t.values())Ni(r,_i(e))>0&&o.push(e);return o}(e,n,t+250);for(const n of a){const a=[...n.internals.handleBounds?.source??[],...n.internals.handleBounds?.target??[]];for(const s of a){if(o.nodeId===s.nodeId&&o.type===s.type&&o.id===s.id)continue;const{x:a,y:l}=ca(n,s,s.position,!0),c=Math.sqrt(Math.pow(a-e.x,2)+Math.pow(l-e.y,2));c>t||(c<i?(r=[{...s,x:a,y:l}],i=c):c===i&&r.push({...s,x:a,y:l}))}}if(!r.length)return null;if(r.length>1){const e="source"===o.type?"target":"source";return r.find(t=>t.type===e)??r[0]}return r[0]}(zi(z,i,!1,[1,1]),n,l,$),O||(T(),O=!0);const s=Na(e,{handle:_,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:a?"target":"source",isValidConnection:y,doc:C,lib:c,flowId:u,nodeLookup:l});R=s.handleDomNode,D=s.connection,I=function(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}(!!_,s.isValid);const d={...V,isValid:I,to:s.toHandle&&I?Oi({x:s.toHandle.x,y:s.toHandle.y},i):z,toHandle:s.toHandle,toPosition:I&&s.toHandle?s.toHandle.position:li[$.position],toNode:s.toHandle?l.get(s.toHandle.nodeId):null};I&&_&&V.toHandle&&d.toHandle&&V.toHandle.type===d.toHandle.type&&V.toHandle.nodeId===d.toHandle.nodeId&&V.toHandle.id===d.toHandle.id&&V.to.x===d.to.x&&V.to.y===d.to.y||(x(d),V=d)}function F(e){(_||R)&&D&&I&&p?.(D);const{inProgress:t,...n}=V,o={...n,toPosition:V.toHandle?V.toPosition:null};m?.(e,o),i&&v?.(e,o),f(),cancelAnimationFrame(E),O=!1,I=!1,D=null,R=null,C.removeEventListener("mousemove",H),C.removeEventListener("mouseup",F),C.removeEventListener("touchmove",H),C.removeEventListener("touchend",F)}g?.(e,{nodeId:r,handleId:o,handleType:P}),C.addEventListener("mousemove",H),C.addEventListener("mouseup",F),C.addEventListener("touchmove",H),C.addEventListener("touchend",F)},isValid:Na},Pa=e=>({x:e.x,y:e.y,zoom:e.k}),Aa=({x:e,y:t,zoom:n})=>Vr.translate(e,t).scale(n),ja=(e,t)=>e.target.closest(`.${t}`),za=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),Oa=(e,t=0,n=()=>{})=>{const o="number"==typeof t&&t>0;return o||n(),o?e.transition().duration(t).on("end",n):e},Da=e=>{const t=e.ctrlKey&&Ri()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t};var Ia;function Ra(e,t){return Math.max(0,t-e)}function Ta(e,t){return Math.max(0,e-t)}function $a(e,t,n){return Math.max(0,t-e,e-n)}function La(e,t){return e?!t:t}!function(e){e.Line="line",e.Handle="handle"}(Ia||(Ia={}));const Ba={width:0,height:0,x:0,y:0},Va={...Ba,pointerX:0,pointerY:0,aspectRatio:1};function Ha(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,a=e.measured.height??0,s=n[0]*i,l=n[1]*a;return[[o-s,r-l],[o+i-s,r+a-l]]}var Fa,Ya,Za,Xa={exports:{}},Wa={},qa={exports:{}},Ka={};Xa.exports=function(){if(Za)return Wa;Za=1;var e=r,t=(Ya||(Ya=1,qa.exports=function(){if(Fa)return Ka;Fa=1;var e=r,t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useState,o=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function s(e){var n=e.getSnapshot;e=e.value;try{var o=n();return!t(e,o)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),l=n({inst:{value:r,getSnapshot:t}}),c=l[0].inst,d=l[1];return i(function(){c.value=r,c.getSnapshot=t,s(c)&&d({inst:c})},[e,r,t]),o(function(){return s(c)&&d({inst:c}),e(function(){s(c)&&d({inst:c})})},[e]),a(r),r};return Ka.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,Ka}()),qa.exports),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,s=e.useMemo,l=e.useDebugValue;return Wa.useSyncExternalStoreWithSelector=function(e,t,r,c,d){var u=i(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;u=s(function(){function e(e){if(!a){if(a=!0,o=e,e=c(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return i=t}return i=e}if(t=i,n(o,e))return t;var r=c(e);return void 0!==d&&d(t,r)?(o=e,t):(o=e,i=r)}var o,i,a=!1,s=void 0===r?null:r;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]},[t,r,c,d]);var f=o(e,u[0],u[1]);return a(function(){h.hasValue=!0,h.value=f},[f]),l(f),f},Wa}();var Ga=I(Xa.exports);const Ua=e=>{let t;const n=new Set,o=(e,o)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=o?o:"object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,i={setState:o,getState:r,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(o,r,i);return i},{useDebugValue:Qa}=r,{useSyncExternalStoreWithSelector:Ja}=Ga,es=e=>e;function ts(e,t=es,n){const o=Ja(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Qa(o),o}const ns=(e,t)=>{const n=(e=>e?Ua(e):Ua)(e),o=(e,o=t)=>ts(n,e,o);return Object.assign(o,n),o};function os(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,o]of e)if(!Object.is(o,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const rs=(0,r.createContext)(null),is=rs.Provider,as="[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001";function ss(e,t){const n=(0,r.useContext)(rs);if(null===n)throw new Error(as);return ts(n,e,t)}function ls(){const e=(0,r.useContext)(rs);if(null===e)throw new Error(as);return(0,r.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const cs={display:"none"},ds={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},us="react-flow__node-desc",hs="react-flow__edge-desc",fs=e=>e.ariaLiveMessage;function gs({rfId:e}){const t=ss(fs);return(0,o.jsx)("div",{id:`react-flow__aria-live-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ds,children:t})}function ps({rfId:e,disableKeyboardA11y:t}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{id:`${us}-${e}`,style:cs,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),(0,o.jsx)("div",{id:`${hs}-${e}`,style:cs,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&(0,o.jsx)(gs,{rfId:e})]})}const ms=e=>e.userSelectionActive?"none":"all",ys=(0,r.forwardRef)(({position:e="top-left",children:t,className:n,style:r,...i},a)=>{const s=ss(ms),l=`${e}`.split("-");return(0,o.jsx)("div",{className:ft(["react-flow__panel",n,...l]),style:{...r,pointerEvents:s},ref:a,...i,children:t})});function vs({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:(0,o.jsx)(ys,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,o.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}ys.displayName="Panel";const xs=e=>{const t=[],n=[];for(const[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(const[,t]of e.edgeLookup)t.selected&&n.push(t);return{selectedNodes:t,selectedEdges:n}},bs=e=>e.id;function ws(e,t){return os(e.selectedNodes.map(bs),t.selectedNodes.map(bs))&&os(e.selectedEdges.map(bs),t.selectedEdges.map(bs))}function Ss({onSelectionChange:e}){const t=ls(),{selectedNodes:n,selectedEdges:o}=ss(xs,ws);return(0,r.useEffect)(()=>{const r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(e=>e(r))},[n,o,e]),null}const Cs=e=>!!e.onSelectionChangeHandlers;function _s({onSelectionChange:e}){const t=ss(Cs);return e||t?(0,o.jsx)(Ss,{onSelectionChange:e}):null}const Es=[0,0],ks={x:0,y:0,zoom:1},Ns=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","rfId"],Ms=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Ps={translateExtent:Qr,nodeOrigin:Es,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function As(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:i,setTranslateExtent:a,setNodeExtent:s,reset:l,setDefaultNodesAndEdges:c,setPaneClickDistance:d}=ss(Ms,os),u=ls();(0,r.useEffect)(()=>(c(e.defaultNodes,e.defaultEdges),()=>{h.current=Ps,l()}),[]);const h=(0,r.useRef)(Ps);return(0,r.useEffect)(()=>{for(const r of Ns){const l=e[r];l!==h.current[r]&&void 0!==e[r]&&("nodes"===r?t(l):"edges"===r?n(l):"minZoom"===r?o(l):"maxZoom"===r?i(l):"translateExtent"===r?a(l):"nodeExtent"===r?s(l):"paneClickDistance"===r?d(l):"fitView"===r?u.setState({fitViewQueued:l}):"fitViewOptions"===r?u.setState({fitViewOptions:l}):u.setState({[r]:l}))}h.current=e},Ns.map(t=>e[t])),null}function js(){return"undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null}const zs="undefined"!=typeof document?document:null;function Os(e=null,t={target:zs,actInsideInputWithModifier:!0}){const[n,o]=(0,r.useState)(!1),i=(0,r.useRef)(!1),a=(0,r.useRef)(new Set([])),[s,l]=(0,r.useMemo)(()=>{if(null!==e){const t=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.replace("+","\n").replace("\n\n","\n+").split("\n")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,r.useEffect)(()=>{const n=t?.target??zs,r=t?.actInsideInputWithModifier??!0;if(null!==e){const e=e=>{if(i.current=e.ctrlKey||e.metaKey||e.shiftKey||e.altKey,(!i.current||i.current&&!r)&&Xi(e))return!1;const n=Is(e.code,l);if(a.current.add(e[n]),Ds(s,a.current,!1)){const n=e.composedPath?.()?.[0]||e.target,r="BUTTON"===n?.nodeName||"A"===n?.nodeName;!1===t.preventDefault||!i.current&&r||e.preventDefault(),o(!0)}},c=e=>{const t=Is(e.code,l);Ds(s,a.current,!0)?(o(!1),a.current.clear()):a.current.delete(e[t]),"Meta"===e.key&&a.current.clear(),i.current=!1},d=()=>{a.current.clear(),o(!1)};return n?.addEventListener("keydown",e),n?.addEventListener("keyup",c),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{n?.removeEventListener("keydown",e),n?.removeEventListener("keyup",c),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,o]),n}function Ds(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function Is(e,t){return t.includes(e)?"code":"key"}function Rs(e,t){const n=[],o=new Map,r=[];for(const t of e)if("add"!==t.type)if("remove"===t.type||"replace"===t.type)o.set(t.id,[t]);else{const e=o.get(t.id);e?e.push(t):o.set(t.id,[t])}else r.push(t);for(const e of t){const t=o.get(e.id);if(!t){n.push(e);continue}if("remove"===t[0].type)continue;if("replace"===t[0].type){n.push({...t[0].item});continue}const r={...e};for(const e of t)Ts(e,r);n.push(r)}return r.length&&r.forEach(e=>{void 0!==e.index?n.splice(e.index,0,{...e.item}):n.push({...e.item})}),n}function Ts(e,t){switch(e.type){case"select":t.selected=e.selected;break;case"position":void 0!==e.position&&(t.position=e.position),void 0!==e.dragging&&(t.dragging=e.dragging);break;case"dimensions":void 0!==e.dimensions&&(t.measured??={},t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(!0!==e.setAttributes&&"width"!==e.setAttributes||(t.width=e.dimensions.width),!0!==e.setAttributes&&"height"!==e.setAttributes||(t.height=e.dimensions.height))),"boolean"==typeof e.resizing&&(t.resizing=e.resizing)}}function $s(e,t){return Rs(e,t)}function Ls(e,t){return Rs(e,t)}function Bs(e,t){return{id:e,type:"select",selected:t}}function Vs(e,t=new Set,n=!1){const o=[];for(const[r,i]of e){const e=t.has(r);void 0===i.selected&&!e||i.selected===e||(n&&(i.selected=e),o.push(Bs(i.id,e)))}return o}function Hs({items:e=[],lookup:t}){const n=[],o=new Map(e.map(e=>[e.id,e]));for(const[o,r]of e.entries()){const e=t.get(r.id),i=e?.internals?.userNode??e;void 0!==i&&i!==r&&n.push({id:r.id,item:r,type:"replace"}),void 0===i&&n.push({item:r,type:"add",index:o})}for(const[e]of t)void 0===o.get(e)&&n.push({id:e,type:"remove"});return n}function Fs(e){return{id:e.id,type:"remove"}}const Ys=e=>(e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e))(e);function Zs(e){return(0,r.forwardRef)(e)}const Xs="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;function Ws(e){const[t,n]=(0,r.useState)(BigInt(0)),[o]=(0,r.useState)(()=>function(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}(()=>n(e=>e+BigInt(1))));return Xs(()=>{const t=o.get();t.length&&(e(t),o.reset())},[t]),o}const qs=(0,r.createContext)(null);function Ks({children:e}){const t=ls(),n=Ws((0,r.useCallback)(e=>{const{nodes:n=[],setNodes:o,hasDefaultNodes:r,onNodesChange:i,nodeLookup:a,fitViewQueued:s}=t.getState();let l=n;for(const t of e)l="function"==typeof t?t(l):t;const c=Hs({items:l,lookup:a});r&&o(l),c.length>0?i?.(c):s&&window.requestAnimationFrame(()=>{const{fitViewQueued:e,nodes:n,setNodes:o}=t.getState();e&&o(n)})},[])),i=Ws((0,r.useCallback)(e=>{const{edges:n=[],setEdges:o,hasDefaultEdges:r,onEdgesChange:i,edgeLookup:a}=t.getState();let s=n;for(const t of e)s="function"==typeof t?t(s):t;r?o(s):i&&i(Hs({items:s,lookup:a}))},[])),a=(0,r.useMemo)(()=>({nodeQueue:n,edgeQueue:i}),[]);return(0,o.jsx)(qs.Provider,{value:a,children:e})}const Gs=e=>!!e.panZoom;function Us(){const e=(()=>{const e=ls();return(0,r.useMemo)(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,i],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??i},{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>{const{width:r,height:i,maxZoom:a,panZoom:s}=e.getState(),l=void 0!==o?.zoom?o.zoom:a,c=r/2-t*l,d=i/2-n*l;return s?(await s.setViewport({x:c,y:d,zoom:l},{duration:o?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:i,maxZoom:a,panZoom:s}=e.getState(),l=Ii(t,o,r,i,a,n?.padding??.1);return s?(await s.setViewport(l,{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:i,domNode:a}=e.getState();if(!a)return t;const{x:s,y:l}=a.getBoundingClientRect(),c={x:t.x-s,y:t.y-l},d=n.snapGrid??r,u=n.snapToGrid??i;return zi(c,o,u,d)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:i}=o.getBoundingClientRect(),a=Oi(t,n);return{x:a.x+r,y:a.y+i}}}),[])})(),t=ls(),n=function(){const e=(0,r.useContext)(qs);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}(),o=ss(Gs),i=(0,r.useMemo)(()=>{const e=e=>t.getState().nodeLookup.get(e),o=e=>{n.nodeQueue.push(e)},r=e=>{n.edgeQueue.push(e)},i=e=>{const{nodeLookup:n,nodeOrigin:o}=t.getState(),r=Ys(e)?e:n.get(e.id),i=r.parentId?Bi(r.position,r.measured,r.parentId,n,o):r.position,a={...r,position:i,width:r.measured?.width??r.width,height:r.measured?.height??r.height};return _i(a)},a=(e,t,n={replace:!1})=>{o(o=>o.map(o=>{if(o.id===e){const e="function"==typeof t?t(o):t;return n.replace&&Ys(e)?e:{...o,...e}}return o}))},s=(e,t,n={replace:!1})=>{r(o=>o.map(o=>{if(o.id===e){const e="function"==typeof t?t(o):t;return n.replace&&di(e)?e:{...o,...e}}return o}))};return{getNodes:()=>t.getState().nodes.map(e=>({...e})),getNode:t=>e(t)?.internals.userNode,getInternalNode:e,getEdges:()=>{const{edges:e=[]}=t.getState();return e.map(e=>({...e}))},getEdge:e=>t.getState().edgeLookup.get(e),setNodes:o,setEdges:r,addNodes:e=>{const t=Array.isArray(e)?e:[e];n.nodeQueue.push(e=>[...e,...t])},addEdges:e=>{const t=Array.isArray(e)?e:[e];n.edgeQueue.push(e=>[...e,...t])},toObject:()=>{const{nodes:e=[],edges:n=[],transform:o}=t.getState(),[r,i,a]=o;return{nodes:e.map(e=>({...e})),edges:n.map(e=>({...e})),viewport:{x:r,y:i,zoom:a}}},deleteElements:async({nodes:e=[],edges:n=[]})=>{const{nodes:o,edges:r,onNodesDelete:i,onEdgesDelete:a,triggerNodeChanges:s,triggerEdgeChanges:l,onDelete:c,onBeforeDelete:d}=t.getState(),{nodes:u,edges:h}=await async function({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const i=new Set(e.map(e=>e.id)),a=[];for(const e of n){if(!1===e.deletable)continue;const t=i.has(e.id),n=!t&&e.parentId&&a.find(t=>t.id===e.parentId);(t||n)&&a.push(e)}const s=new Set(t.map(e=>e.id)),l=o.filter(e=>!1!==e.deletable),c=((e,t)=>{const n=new Set;return e.forEach(e=>{n.add(e.id)}),t.filter(e=>n.has(e.source)||n.has(e.target))})(a,l),d=c;for(const e of l)s.has(e.id)&&!d.find(t=>t.id===e.id)&&d.push(e);if(!r)return{edges:d,nodes:a};const u=await r({nodes:a,edges:d});return"boolean"==typeof u?u?{edges:d,nodes:a}:{edges:[],nodes:[]}:u}({nodesToRemove:e,edgesToRemove:n,nodes:o,edges:r,onBeforeDelete:d}),f=h.length>0,g=u.length>0;if(f){const e=h.map(Fs);a?.(h),l(e)}if(g){const e=u.map(Fs);i?.(u),s(e)}return(g||f)&&c?.({nodes:u,edges:h}),{deletedNodes:u,deletedEdges:h}},getIntersectingNodes:(e,n=!0,o)=>{const r=Mi(e),a=r?e:i(e),s=void 0!==o;return a?(o||t.getState().nodes).filter(o=>{const i=t.getState().nodeLookup.get(o.id);if(i&&!r&&(o.id===e.id||!i.internals.positionAbsolute))return!1;const l=_i(s?o:i),c=Ni(l,a);return n&&c>0||c>=a.width*a.height}):[]},isNodeIntersecting:(e,t,n=!0)=>{const o=Mi(e)?e:i(e);if(!o)return!1;const r=Ni(o,t);return n&&r>0||r>=o.width*o.height},updateNode:a,updateNodeData:(e,t,n={replace:!1})=>{a(e,e=>{const o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},updateEdge:s,updateEdgeData:(e,t,n={replace:!1})=>{s(e,e=>{const o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},getNodesBounds:e=>{const{nodeLookup:n,nodeOrigin:o}=t.getState();return((e,t={nodeOrigin:[0,0]})=>{if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce((e,n)=>{const o="string"==typeof n;let r=t.nodeLookup||o?void 0:n;t.nodeLookup&&(r=o?t.nodeLookup.get(n):ui(n)?n:t.nodeLookup.get(n.id));const i=r?Ei(r,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return wi(e,i)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ci(n)})(e,{nodeLookup:n,nodeOrigin:o})},getHandleConnections:({type:e,id:n,nodeId:o})=>Array.from(t.getState().connectionLookup.get(`${o}-${e}${n?`-${n}`:""}`)?.values()??[]),getNodeConnections:({type:e,handleId:n,nodeId:o})=>Array.from(t.getState().connectionLookup.get(`${o}${e?n?`-${e}-${n}`:`-${e}`:""}`)?.values()??[]),fitView:async e=>{const o=t.getState().fitViewResolver??function(){let e,t;return{promise:new Promise((n,o)=>{e=n,t=o}),resolve:e,reject:t}}();return t.setState({fitViewQueued:!0,fitViewOptions:e,fitViewResolver:o}),n.nodeQueue.push(e=>[...e]),o.promise}}},[]);return(0,r.useMemo)(()=>({...i,...e,viewportInitialized:o}),[o])}const Qs=e=>e.selected,Js="undefined"!=typeof window?window:void 0,el={position:"absolute",width:"100%",height:"100%",top:0,left:0},tl=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function nl({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:s=ti.Free,zoomOnDoubleClick:l=!0,panOnDrag:c=!0,defaultViewport:d,translateExtent:u,minZoom:h,maxZoom:f,zoomActivationKeyCode:g,preventScrolling:p=!0,children:m,noWheelClassName:y,noPanClassName:v,onViewportChange:x,isControlledViewport:b,paneClickDistance:w}){const S=ls(),C=(0,r.useRef)(null),{userSelectionActive:_,lib:E}=ss(tl,os),k=Os(g),N=(0,r.useRef)();!function(e){const t=ls();(0,r.useEffect)(()=>{const n=()=>{if(!e.current)return!1;const n=Fi(e.current);0!==n.height&&0!==n.width||t.getState().onError?.("004","The React Flow parent container needs a width and a height to render the graph."),t.setState({width:n.width||500,height:n.height||500})};if(e.current){n(),window.addEventListener("resize",n);const t=new ResizeObserver(()=>n());return t.observe(e.current),()=>{window.removeEventListener("resize",n),t&&e.current&&t.unobserve(e.current)}}},[])}(C);const M=(0,r.useCallback)(e=>{x?.({x:e[0],y:e[1],zoom:e[2]}),b||S.setState({transform:e})},[x,b]);return(0,r.useEffect)(()=>{if(C.current){N.current=function({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:r,viewport:i,onPanZoom:a,onPanZoomStart:s,onPanZoomEnd:l,onDraggingChange:c}){const d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),h=Ur().clickDistance(!Pi(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(r),f=jn(e).call(h);v({x:i.x,y:i.y,zoom:mi(i.zoom,t,n)},[[0,0],[u.width,u.height]],r);const g=f.on("wheel.zoom"),p=f.on("dblclick.zoom");function m(e,t){return f?new Promise(n=>{h?.transform(Oa(f,t?.duration,()=>n(!0)),e)}):Promise.resolve(!1)}function y(){h.on("zoom",null)}async function v(e,t,n){const o=Aa(e),r=h?.constrain()(o,t,n);return r&&await m(r),new Promise(e=>e(r))}return h.wheelDelta(Da),{update:function({noWheelClassName:e,noPanClassName:t,onPaneContextMenu:n,userSelectionActive:o,panOnScroll:r,panOnDrag:i,panOnScrollMode:u,panOnScrollSpeed:m,preventScrolling:v,zoomOnPinch:x,zoomOnScroll:b,zoomOnDoubleClick:w,zoomActivationKeyPressed:S,lib:C,onTransformChange:_}){o&&!d.isZoomingOrPanning&&y();const E=!r||S||o?function({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const i="wheel"===o.type,a=!t&&i&&!o.ctrlKey,s=ja(o,e);if(o.ctrlKey&&i&&s&&o.preventDefault(),a||s)return null;o.preventDefault(),n.call(this,o,r)}}({noWheelClassName:e,preventScrolling:v,d3ZoomHandler:g}):function({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:a,onPanZoomStart:s,onPanZoom:l,onPanZoomEnd:c}){return d=>{if(ja(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();const u=n.property("__zoom").k||1;if(d.ctrlKey&&a){const e=zn(d),t=Da(d),r=u*Math.pow(2,t);return void o.scaleTo(n,r,e,d)}const h=1===d.deltaMode?20:1;let f=r===ti.Vertical?0:d.deltaX*h,g=r===ti.Horizontal?0:d.deltaY*h;!Ri()&&d.shiftKey&&r!==ti.Vertical&&(f=d.deltaY*h,g=0),o.translateBy(n,-f/u*i,-g/u*i,{internal:!0});const p=Pa(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s?.(d,p)),e.isPanScrolling&&(l?.(d,p),e.panScrollTimeout=setTimeout(()=>{c?.(d,p),e.isPanScrolling=!1},150))}}({zoomPanValues:d,noWheelClassName:e,d3Selection:f,d3Zoom:h,panOnScrollMode:u,panOnScrollSpeed:m,zoomOnPinch:x,onPanZoomStart:s,onPanZoom:a,onPanZoomEnd:l});if(f.on("wheel.zoom",E,{passive:!1}),!o){const e=function({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=Pa(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,"mousedown"===o.sourceEvent?.type&&t(!0),n&&n?.(o.sourceEvent,r)}}({zoomPanValues:d,onDraggingChange:c,onPanZoomStart:s});h.on("start",e);const t=function({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!(!n||!za(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,Pa(i.transform))}}({zoomPanValues:d,panOnDrag:i,onPaneContextMenu:!!n,onPanZoom:a,onTransformChange:_});h.on("zoom",t);const o=function({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return a=>{var s,l;if(!a.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&za(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&i(a.sourceEvent),e.usedRightMouseButton=!1,o(!1),r&&(s=e.prevViewport,l=a.transform,s.x!==l.x||s.y!==l.y||s.zoom!==l.k))){const t=Pa(a.transform);e.prevViewport=t,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(a.sourceEvent,t)},n?150:0)}}}({zoomPanValues:d,panOnDrag:i,panOnScroll:r,onPaneContextMenu:n,onPanZoomEnd:l,onDraggingChange:c});h.on("end",o)}const k=function({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:a,noWheelClassName:s,noPanClassName:l,lib:c}){return d=>{const u=e||t,h=n&&d.ctrlKey;if(1===d.button&&"mousedown"===d.type&&(ja(d,`${c}-flow__node`)||ja(d,`${c}-flow__edge`)))return!0;if(!(o||u||r||i||n))return!1;if(a)return!1;if(ja(d,s)&&"wheel"===d.type)return!1;if(ja(d,l)&&("wheel"!==d.type||r&&"wheel"===d.type&&!e))return!1;if(!n&&d.ctrlKey&&"wheel"===d.type)return!1;if(!n&&"touchstart"===d.type&&d.touches?.length>1)return d.preventDefault(),!1;if(!u&&!r&&!h&&"wheel"===d.type)return!1;if(!o&&("mousedown"===d.type||"touchstart"===d.type))return!1;if(Array.isArray(o)&&!o.includes(d.button)&&"mousedown"===d.type)return!1;const f=Array.isArray(o)&&o.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||"wheel"===d.type)&&f}}({zoomActivationKeyPressed:S,panOnDrag:i,zoomOnScroll:b,panOnScroll:r,zoomOnDoubleClick:w,zoomOnPinch:x,userSelectionActive:o,noPanClassName:t,noWheelClassName:e,lib:C});h.filter(k),w?f.on("dblclick.zoom",p):f.on("dblclick.zoom",null)},destroy:y,setViewport:async function(e,t){const n=Aa(e);return await m(n,t),new Promise(e=>e(n))},setViewportConstrained:v,getViewport:function(){const e=f?Hr(f.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,t){return f?new Promise(n=>{h?.scaleTo(Oa(f,t?.duration,()=>n(!0)),e)}):Promise.resolve(!1)},scaleBy:function(e,t){return f?new Promise(n=>{h?.scaleBy(Oa(f,t?.duration,()=>n(!0)),e)}):Promise.resolve(!1)},setScaleExtent:function(e){h?.scaleExtent(e)},setTranslateExtent:function(e){h?.translateExtent(e)},syncViewport:function(e){if(f){const t=Aa(e),n=f.property("__zoom");n.k===e.zoom&&n.x===e.x&&n.y===e.y||h?.transform(f,t,null,{sync:!0})}},setClickDistance:function(e){const t=!Pi(e)||e<0?0:e;h?.clickDistance(t)}}}({domNode:C.current,minZoom:h,maxZoom:f,translateExtent:u,viewport:d,paneClickDistance:w,onDraggingChange:e=>S.setState({paneDragging:e}),onPanZoomStart:(e,t)=>{const{onViewportChangeStart:n,onMoveStart:o}=S.getState();o?.(e,t),n?.(t)},onPanZoom:(e,t)=>{const{onViewportChange:n,onMove:o}=S.getState();o?.(e,t),n?.(t)},onPanZoomEnd:(e,t)=>{const{onViewportChangeEnd:n,onMoveEnd:o}=S.getState();o?.(e,t),n?.(t)}});const{x:e,y:t,zoom:n}=N.current.getViewport();return S.setState({panZoom:N.current,transform:[e,t,n],domNode:C.current.closest(".react-flow")}),()=>{N.current?.destroy()}}},[]),(0,r.useEffect)(()=>{N.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:i,panOnScrollSpeed:a,panOnScrollMode:s,zoomOnDoubleClick:l,panOnDrag:c,zoomActivationKeyPressed:k,preventScrolling:p,noPanClassName:v,userSelectionActive:_,noWheelClassName:y,lib:E,onTransformChange:M})},[e,t,n,i,a,s,l,c,k,p,v,_,y,E,M]),(0,o.jsx)("div",{className:"react-flow__renderer",ref:C,style:el,children:m})}const ol=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function rl(){const{userSelectionActive:e,userSelectionRect:t}=ss(ol,os);return e&&t?(0,o.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const il=(e,t)=>n=>{n.target===t.current&&e?.(n)},al=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function sl({isSelecting:e,selectionKeyPressed:t,selectionMode:n=ni.Full,panOnDrag:i,selectionOnDrag:a,onSelectionStart:s,onSelectionEnd:l,onPaneClick:c,onPaneContextMenu:d,onPaneScroll:u,onPaneMouseEnter:h,onPaneMouseMove:f,onPaneMouseLeave:g,children:p}){const m=ls(),{userSelectionActive:y,elementsSelectable:v,dragging:x,connectionInProgress:b}=ss(al,os),w=v&&(e||y),S=(0,r.useRef)(null),C=(0,r.useRef)(),_=(0,r.useRef)(new Set),E=(0,r.useRef)(new Set),k=(0,r.useRef)(!1),N=(0,r.useRef)(!1),M=e=>{k.current||b?k.current=!1:(c?.(e),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1}))},P=u?e=>u(e):void 0,A=!0===i||Array.isArray(i)&&i.includes(0);return(0,o.jsxs)("div",{className:ft(["react-flow__pane",{draggable:A,dragging:x,selection:e}]),onClick:w?void 0:il(M,S),onContextMenu:il(e=>{Array.isArray(i)&&i?.includes(2)?e.preventDefault():d?.(e)},S),onWheel:il(P,S),onPointerEnter:w?void 0:h,onPointerDown:w?t=>{const{resetSelectedElements:n,domNode:o}=m.getState();if(C.current=o?.getBoundingClientRect(),!v||!e||0!==t.button||t.target!==S.current||!C.current)return;t.target?.setPointerCapture?.(t.pointerId),N.current=!0,k.current=!1;const{x:r,y:i}=qi(t.nativeEvent,C.current);n(),m.setState({userSelectionRect:{width:0,height:0,startX:r,startY:i,x:r,y:i}}),s?.(t)}:f,onPointerMove:w?e=>{const{userSelectionRect:t,transform:o,nodeLookup:r,edgeLookup:i,connectionLookup:a,triggerNodeChanges:s,triggerEdgeChanges:l,defaultEdgeOptions:c}=m.getState();if(!C.current||!t)return;k.current=!0;const{x:d,y:u}=qi(e.nativeEvent,C.current),{startX:h,startY:f}=t,g={startX:h,startY:f,x:d<h?d:h,y:u<f?u:f,width:Math.abs(d-h),height:Math.abs(u-f)},p=_.current,y=E.current;_.current=new Set(gi(r,g,o,n===ni.Partial,!0).map(e=>e.id)),E.current=new Set;const v=c?.selectable??!0;for(const e of _.current){const t=a.get(e);if(t)for(const{edgeId:e}of t.values()){const t=i.get(e);t&&(t.selectable??v)&&E.current.add(e)}}Vi(p,_.current)||s(Vs(r,_.current,!0)),Vi(y,E.current)||l(Vs(i,E.current)),m.setState({userSelectionRect:g,userSelectionActive:!0,nodesSelectionActive:!1})}:f,onPointerUp:w?e=>{if(0!==e.button||!N.current)return;e.target?.releasePointerCapture?.(e.pointerId);const{userSelectionRect:n}=m.getState();!y&&n&&e.target===S.current&&M?.(e),m.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:_.current.size>0}),l?.(e),(t||a)&&(k.current=!1),N.current=!1}:void 0,onPointerLeave:g,ref:S,style:el,children:[p,(0,o.jsx)(rl,{})]})}function ll({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:a,nodeLookup:s,onError:l}=t.getState(),c=s.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&a)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])):l?.("012",(e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`)(e))}function cl({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:i,isSelectable:a,nodeClickDistance:s}){const l=ls(),[c,d]=(0,r.useState)(!1),u=(0,r.useRef)();return(0,r.useEffect)(()=>{u.current=function({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},a=0,s=new Map,l=!1,c={x:0,y:0},d=null,u=!1,h=null,f=!1;return{update:function({noDragClassName:g,handleSelector:p,domNode:m,isSelectable:y,nodeId:v,nodeClickDistance:x=0}){function b({x:e,y:n},r){const{nodeLookup:a,nodeExtent:l,snapGrid:c,snapToGrid:d,nodeOrigin:u,onNodeDrag:h,onSelectionDrag:f,onError:g,updateNodePositions:p}=t();i={x:e,y:n};let m=!1,y={x:0,y:0,x2:0,y2:0};if(s.size>1&&l){const e=fi(s);y=Si(e)}for(const[t,o]of s){if(!a.has(t))continue;let r={x:e-o.distance.x,y:n-o.distance.y};d&&(r=ji(r,c));let i=[[l[0][0],l[0][1]],[l[1][0],l[1][1]]];if(s.size>1&&l&&!o.extent){const{positionAbsolute:e}=o.internals,t=e.x-y.x+l[0][0],n=e.x+o.measured.width-y.x2+l[1][0];i=[[t,e.y-y.y+l[0][1]],[n,e.y+o.measured.height-y.y2+l[1][1]]]}const{position:h,positionAbsolute:f}=pi({nodeId:t,nextPosition:r,nodeLookup:a,nodeExtent:i,nodeOrigin:u,onError:g});m=m||o.position.x!==h.x||o.position.y!==h.y,o.position=h,o.internals.positionAbsolute=f}if(m&&(p(s,!0),r&&(o||h||!v&&f))){const[e,t]=Ca({nodeId:v,dragItems:s,nodeLookup:a});o?.(r,s,e,t),h?.(r,e,t),v||f?.(r,t)}}async function w(){if(!d)return;const{transform:e,panBy:n,autoPanSpeed:o,autoPanOnNodeDrag:r}=t();if(!r)return l=!1,void cancelAnimationFrame(a);const[s,u]=bi(c,d,o);0===s&&0===u||(i.x=(i.x??0)-s/e[2],i.y=(i.y??0)-u/e[2],await n({x:s,y:u})&&b(i,null)),a=requestAnimationFrame(w)}function S(o){const{nodeLookup:r,multiSelectionActive:a,nodesDraggable:l,transform:c,snapGrid:h,snapToGrid:f,selectNodesOnDrag:g,onNodeDragStart:p,onSelectionDragStart:m,unselectNodesAndEdges:x}=t();u=!0,g&&y||a||!v||r.get(v)?.selected||x(),y&&g&&v&&e?.(v);const b=Hi(o.sourceEvent,{transform:c,snapGrid:h,snapToGrid:f,containerBounds:d});if(i=b,s=function(e,t,n,o){const r=new Map;for(const[i,a]of e)if((a.selected||a.id===o)&&(!a.parentId||!wa(a,e))&&(a.draggable||t&&void 0===a.draggable)){const t=e.get(i);t&&r.set(i,{id:i,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:t.measured.width??0,height:t.measured.height??0}})}return r}(r,l,b,v),s.size>0&&(n||p||!v&&m)){const[e,t]=Ca({nodeId:v,dragItems:s,nodeLookup:r});n?.(o.sourceEvent,s,e,t),p?.(o.sourceEvent,e,t),v||m?.(o.sourceEvent,t)}}h=jn(m);const C=Zn().clickDistance(x).on("start",e=>{const{domNode:n,nodeDragThreshold:o,transform:r,snapGrid:a,snapToGrid:s}=t();d=n?.getBoundingClientRect()||null,f=!1,0===o&&S(e);const l=Hi(e.sourceEvent,{transform:r,snapGrid:a,snapToGrid:s,containerBounds:d});i=l,c=qi(e.sourceEvent,d)}).on("drag",e=>{const{autoPanOnNodeDrag:n,transform:o,snapGrid:r,snapToGrid:a,nodeDragThreshold:h,nodeLookup:g}=t(),p=Hi(e.sourceEvent,{transform:o,snapGrid:r,snapToGrid:a,containerBounds:d});if(("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1||v&&!g.has(v))&&(f=!0),!f){if(!l&&n&&u&&(l=!0,w()),!u){const t=p.xSnapped-(i.x??0),n=p.ySnapped-(i.y??0);Math.sqrt(t*t+n*n)>h&&S(e)}(i.x!==p.xSnapped||i.y!==p.ySnapped)&&s&&u&&(c=qi(e.sourceEvent,d),b(p,e.sourceEvent))}}).on("end",e=>{if(u&&!f&&(l=!1,u=!1,cancelAnimationFrame(a),s.size>0)){const{nodeLookup:n,updateNodePositions:o,onNodeDragStop:i,onSelectionDragStop:a}=t();if(o(s,!1),r||i||!v&&a){const[t,o]=Ca({nodeId:v,dragItems:s,nodeLookup:n,dragging:!1});r?.(e.sourceEvent,s,t,o),i?.(e.sourceEvent,t,o),v||a?.(e.sourceEvent,o)}}}).filter(e=>{const t=e.target;return!e.button&&(!g||!Sa(t,`.${g}`,m))&&(!p||Sa(t,p,m))});h.call(C)},destroy:function(){h?.on(".drag",null)}}}({getStoreItems:()=>l.getState(),onNodeMouseDown:t=>{ll({id:t,store:l,nodeRef:e})},onDragStart:()=>{d(!0)},onDragStop:()=>{d(!1)}})},[]),(0,r.useEffect)(()=>{if(t)u.current?.destroy();else if(e.current)return u.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:a,nodeId:i,nodeClickDistance:s}),()=>{u.current?.destroy()}},[n,o,t,a,e,i]),c}function dl(){const e=ls();return(0,r.useCallback)(t=>{const{nodeExtent:n,snapToGrid:o,snapGrid:r,nodesDraggable:i,onError:a,updateNodePositions:s,nodeLookup:l,nodeOrigin:c}=e.getState(),d=new Map,u=(e=>t=>t.selected&&(t.draggable||e&&void 0===t.draggable))(i),h=o?r[0]:5,f=o?r[1]:5,g=t.direction.x*h*t.factor,p=t.direction.y*f*t.factor;for(const[,e]of l){if(!u(e))continue;let t={x:e.internals.positionAbsolute.x+g,y:e.internals.positionAbsolute.y+p};o&&(t=ji(t,r));const{position:i,positionAbsolute:s}=pi({nodeId:e.id,nextPosition:t,nodeLookup:l,nodeExtent:n,nodeOrigin:c,onError:a});e.position=i,e.internals.positionAbsolute=s,d.set(e.id,e)}s(d)},[])}const ul=(0,r.createContext)(null),hl=ul.Provider;ul.Consumer;const fl=()=>(0,r.useContext)(ul),gl=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),pl=(0,r.memo)(Zs(function({type:e="source",position:t=si.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:a=!0,id:s,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:h,...f},g){const p=s||null,m="target"===e,y=ls(),v=fl(),{connectOnClick:x,noPanClassName:b,rfId:w}=ss(gl,os),{connectingFrom:S,connectingTo:C,clickConnecting:_,isPossibleEndHandle:E,connectionInProcess:k,clickConnectionInProcess:N,valid:M}=ss(((e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:i,connection:a}=o,{fromHandle:s,toHandle:l,isValid:c}=a,d=l?.nodeId===e&&l?.id===t&&l?.type===n;return{connectingFrom:s?.nodeId===e&&s?.id===t&&s?.type===n,connectingTo:d,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:i===ei.Strict?s?.type!==n:e!==s?.nodeId||t!==s?.id,connectionInProcess:!!s,clickConnectionInProcess:!!r,valid:d&&c}})(v,p,e),os);v||y.getState().onError?.("010","Handle: No node id found. Make sure to only use a Handle inside a custom Node.");const P=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:o}=y.getState(),r={...t,...e};if(o){const{edges:e,setEdges:t}=y.getState();t(((e,t)=>{if(!e.source||!e.target)return t;let n;return n=di(e)?{...e}:{...e,id:na(e)},((e,t)=>t.some(t=>!(t.source!==e.source||t.target!==e.target||t.sourceHandle!==e.sourceHandle&&(t.sourceHandle||e.sourceHandle)||t.targetHandle!==e.targetHandle&&(t.targetHandle||e.targetHandle))))(n,t)?t:(null===n.sourceHandle&&delete n.sourceHandle,null===n.targetHandle&&delete n.targetHandle,t.concat(n))})(r,e))}n?.(r),l?.(r)},A=e=>{if(!v)return;const t=Wi(e.nativeEvent);if(i&&(t&&0===e.button||!t)){const t=y.getState();Ma.onPointerDown(e.nativeEvent,{autoPanOnConnect:t.autoPanOnConnect,connectionMode:t.connectionMode,connectionRadius:t.connectionRadius,domNode:t.domNode,nodeLookup:t.nodeLookup,lib:t.lib,isTarget:m,handleId:p,nodeId:v,flowId:t.rfId,panBy:t.panBy,cancelConnection:t.cancelConnection,onConnectStart:t.onConnectStart,onConnectEnd:t.onConnectEnd,updateConnection:t.updateConnection,onConnect:P,isValidConnection:n||t.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:t.autoPanSpeed})}t?u?.(e):h?.(e)};return(0,o.jsx)("div",{"data-handleid":p,"data-nodeid":v,"data-handlepos":t,"data-id":`${w}-${v}-${p}-${e}`,className:ft(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!m,target:m,connectable:r,connectablestart:i,connectableend:a,clickconnecting:_,connectingfrom:S,connectingto:C,valid:M,connectionindicator:r&&(!k||E)&&(k||N?a:i)}]),onMouseDown:A,onTouchStart:A,onClick:x?t=>{const{onClickConnectStart:o,onClickConnectEnd:r,connectionClickStartHandle:a,connectionMode:s,isValidConnection:l,lib:c,rfId:d,nodeLookup:u,connection:h}=y.getState();if(!v||!a&&!i)return;if(!a)return o?.(t.nativeEvent,{nodeId:v,handleId:p,handleType:e}),void y.setState({connectionClickStartHandle:{nodeId:v,type:e,id:p}});const f=Yi(t.target),g=n||l,{connection:m,isValid:x}=Ma.isValid(t.nativeEvent,{handle:{nodeId:v,id:p,type:e},connectionMode:s,fromNodeId:a.nodeId,fromHandleId:a.id||null,fromType:a.type,isValidConnection:g,flowId:d,doc:f,lib:c,nodeLookup:u});x&&m&&P(m);const b=structuredClone(h);delete b.inProgress,b.toPosition=b.toHandle?b.toHandle.position:null,r?.(t,b),y.setState({connectionClickStartHandle:null})}:void 0,ref:g,...f,children:c})})),ml={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},yl={input:function({data:e,isConnectable:t,sourcePosition:n=si.Bottom}){return(0,o.jsxs)(o.Fragment,{children:[e?.label,(0,o.jsx)(pl,{type:"source",position:n,isConnectable:t})]})},default:function({data:e,isConnectable:t,targetPosition:n=si.Top,sourcePosition:r=si.Bottom}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(pl,{type:"target",position:n,isConnectable:t}),e?.label,(0,o.jsx)(pl,{type:"source",position:r,isConnectable:t})]})},output:function({data:e,isConnectable:t,targetPosition:n=si.Top}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(pl,{type:"target",position:n,isConnectable:t}),e?.label]})},group:function(){return null}},vl=e=>{const{width:t,height:n,x:o,y:r}=fi(e.nodeLookup,{filter:e=>!!e.selected});return{width:Pi(t)?t:null,height:Pi(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function xl({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const i=ls(),{width:a,height:s,transformString:l,userSelectionActive:c}=ss(vl,os),d=dl(),u=(0,r.useRef)(null);if((0,r.useEffect)(()=>{n||u.current?.focus({preventScroll:!0})},[n]),cl({nodeRef:u}),c||!a||!s)return null;const h=e?t=>{const n=i.getState().nodes.filter(e=>e.selected);e(t,n)}:void 0;return(0,o.jsx)("div",{className:ft(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l},children:(0,o.jsx)("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(ml,e.key)&&(e.preventDefault(),d({direction:ml[e.key],factor:e.shiftKey?4:1}))},style:{width:a,height:s}})})}const bl="undefined"!=typeof window?window:void 0,wl=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Sl({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,paneClickDistance:c,deleteKeyCode:d,selectionKeyCode:u,selectionOnDrag:h,selectionMode:f,onSelectionStart:g,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:w,panOnScroll:S,panOnScrollSpeed:C,panOnScrollMode:_,zoomOnDoubleClick:E,panOnDrag:k,defaultViewport:N,translateExtent:M,minZoom:P,maxZoom:A,preventScrolling:j,onSelectionContextMenu:z,noWheelClassName:O,noPanClassName:D,disableKeyboardA11y:I,onViewportChange:R,isControlledViewport:T}){const{nodesSelectionActive:$,userSelectionActive:L}=ss(wl),B=Os(u,{target:bl}),V=Os(y,{target:bl}),H=V||k,F=V||S,Y=h&&!0!==H,Z=B||L||Y;return function({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ls(),{deleteElements:o}=Us(),i=Os(e,{actInsideInputWithModifier:!1}),a=Os(t,{target:Js});(0,r.useEffect)(()=>{if(i){const{edges:e,nodes:t}=n.getState();o({nodes:t.filter(Qs),edges:e.filter(Qs)}),n.setState({nodesSelectionActive:!1})}},[i]),(0,r.useEffect)(()=>{n.setState({multiSelectionActive:a})},[a])}({deleteKeyCode:d,multiSelectionKeyCode:m}),(0,o.jsx)(nl,{onPaneContextMenu:s,elementsSelectable:x,zoomOnScroll:b,zoomOnPinch:w,panOnScroll:F,panOnScrollSpeed:C,panOnScrollMode:_,zoomOnDoubleClick:E,panOnDrag:!B&&H,defaultViewport:N,translateExtent:M,minZoom:P,maxZoom:A,zoomActivationKeyCode:v,preventScrolling:j,noWheelClassName:O,noPanClassName:D,onViewportChange:R,isControlledViewport:T,paneClickDistance:c,children:(0,o.jsxs)(sl,{onSelectionStart:g,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:i,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,panOnDrag:H,isSelecting:!!Z,selectionMode:f,selectionKeyPressed:B,selectionOnDrag:Y,children:[e,$&&(0,o.jsx)(xl,{onSelectionContextMenu:z,noPanClassName:D,disableKeyboardA11y:I})]})})}Sl.displayName="FlowRenderer";const Cl=(0,r.memo)(Sl),_l=e=>e.updateNodeInternals;function El({id:e,onClick:t,onMouseEnter:n,onMouseMove:i,onMouseLeave:a,onContextMenu:s,onDoubleClick:l,nodesDraggable:c,elementsSelectable:d,nodesConnectable:u,nodesFocusable:h,resizeObserver:f,noDragClassName:g,noPanClassName:p,disableKeyboardA11y:m,rfId:y,nodeTypes:v,nodeClickDistance:x,onError:b}){const{node:w,internals:S,isParent:C}=ss(t=>{const n=t.nodeLookup.get(e),o=t.parentLookup.has(e);return{node:n,internals:n.internals,isParent:o}},os);let _=w.type||"default",E=v?.[_]||yl[_];void 0===E&&(b?.("003",(e=>`Node type "${e}" not found. Using fallback type "default".`)(_)),_="default",E=yl.default);const k=!!(w.draggable||c&&void 0===w.draggable),N=!!(w.selectable||d&&void 0===w.selectable),M=!!(w.connectable||u&&void 0===w.connectable),P=!!(w.focusable||h&&void 0===w.focusable),A=ls(),j=Li(w),z=function({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const i=ls(),a=(0,r.useRef)(null),s=(0,r.useRef)(null),l=(0,r.useRef)(e.sourcePosition),c=(0,r.useRef)(e.targetPosition),d=(0,r.useRef)(t),u=n&&!!e.internals.handleBounds;return(0,r.useEffect)(()=>{!a.current||e.hidden||u&&s.current===a.current||(s.current&&o?.unobserve(s.current),o?.observe(a.current),s.current=a.current)},[u,e.hidden]),(0,r.useEffect)(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),(0,r.useEffect)(()=>{if(a.current){const n=d.current!==t,o=l.current!==e.sourcePosition,r=c.current!==e.targetPosition;(n||o||r)&&(d.current=t,l.current=e.sourcePosition,c.current=e.targetPosition,i.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:a.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),a}({node:w,nodeType:_,hasDimensions:j,resizeObserver:f}),O=cl({nodeRef:z,disabled:w.hidden||!k,noDragClassName:g,handleSelector:w.dragHandle,nodeId:e,isSelectable:N,nodeClickDistance:x}),D=dl();if(w.hidden)return null;const I=$i(w),R=function(e){return void 0===e.internals.handleBounds?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}(w),T=N||k||t||n||i||a,$=n?e=>n(e,{...S.userNode}):void 0,L=i?e=>i(e,{...S.userNode}):void 0,B=a?e=>a(e,{...S.userNode}):void 0,V=s?e=>s(e,{...S.userNode}):void 0,H=l?e=>l(e,{...S.userNode}):void 0;return(0,o.jsx)("div",{className:ft(["react-flow__node",`react-flow__node-${_}`,{[p]:k},w.className,{selected:w.selected,selectable:N,parent:C,draggable:k,dragging:O}]),ref:z,style:{zIndex:S.z,transform:`translate(${S.positionAbsolute.x}px,${S.positionAbsolute.y}px)`,pointerEvents:T?"all":"none",visibility:j?"visible":"hidden",...w.style,...R},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:$,onMouseMove:L,onMouseLeave:B,onContextMenu:V,onClick:n=>{const{selectNodesOnDrag:o,nodeDragThreshold:r}=A.getState();N&&(!o||!k||r>0)&&ll({id:e,store:A,nodeRef:z}),t&&t(n,{...S.userNode})},onDoubleClick:H,onKeyDown:P?t=>{if(!Xi(t.nativeEvent)&&!m)if(Jr.includes(t.key)&&N){const n="Escape"===t.key;ll({id:e,store:A,unselect:n,nodeRef:z})}else k&&w.selected&&Object.prototype.hasOwnProperty.call(ml,t.key)&&(t.preventDefault(),A.setState({ariaLiveMessage:`Moved selected node ${t.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~S.positionAbsolute.x}, y: ${~~S.positionAbsolute.y}`}),D({direction:ml[t.key],factor:t.shiftKey?4:1}))}:void 0,tabIndex:P?0:void 0,role:P?"button":void 0,"aria-describedby":m?void 0:`${us}-${y}`,"aria-label":w.ariaLabel,children:(0,o.jsx)(hl,{value:e,children:(0,o.jsx)(E,{id:e,data:w.data,type:_,positionAbsoluteX:S.positionAbsolute.x,positionAbsoluteY:S.positionAbsolute.y,selected:w.selected??!1,selectable:N,draggable:k,deletable:w.deletable??!0,isConnectable:M,sourcePosition:w.sourcePosition,targetPosition:w.targetPosition,dragging:O,dragHandle:w.dragHandle,zIndex:S.z,parentId:w.parentId,...I})})})}const kl=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Nl(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:i,elementsSelectable:a,onError:s}=ss(kl,os),l=function(e){return ss((0,r.useCallback)((e=>t=>e?gi(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(e=>e.id):Array.from(t.nodeLookup.keys()))(e),[e]),os)}(e.onlyRenderVisibleElements),c=function(){const e=ss(_l),[t]=(0,r.useState)(()=>"undefined"==typeof ResizeObserver?null:new ResizeObserver(t=>{const n=new Map;t.forEach(e=>{const t=e.target.getAttribute("data-id");n.set(t,{id:t,nodeElement:e.target,force:!0})}),e(n)}));return(0,r.useEffect)(()=>()=>{t?.disconnect()},[t]),t}();return(0,o.jsx)("div",{className:"react-flow__nodes",style:el,children:l.map(r=>(0,o.jsx)(El,{id:r,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:c,nodesDraggable:t,nodesConnectable:n,nodesFocusable:i,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:s},r))})}Nl.displayName="NodeRenderer";const Ml=(0,r.memo)(Nl),Pl={[ai.Arrow]:({color:e="none",strokeWidth:t=1})=>(0,o.jsx)("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),[ai.ArrowClosed]:({color:e="none",strokeWidth:t=1})=>(0,o.jsx)("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Al=({id:e,type:t,color:n,width:i=12.5,height:a=12.5,markerUnits:s="strokeWidth",strokeWidth:l,orient:c="auto-start-reverse"})=>{const d=function(e){const t=ls();return(0,r.useMemo)(()=>Object.prototype.hasOwnProperty.call(Pl,e)?Pl[e]:(t.getState().onError?.("009",(e=>`Marker type "${e}" doesn't exist.`)(e)),null),[e])}(t);return d?(0,o.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${i}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:c,refX:"0",refY:"0",children:(0,o.jsx)(d,{color:n,strokeWidth:l})}):null},jl=({defaultColor:e,rfId:t})=>{const n=ss(e=>e.edges),i=ss(e=>e.defaultEdgeOptions),a=(0,r.useMemo)(()=>{const o=function(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const i=new Set;return e.reduce((e,a)=>([a.markerStart||o,a.markerEnd||r].forEach(o=>{if(o&&"object"==typeof o){const r=ua(o,t);i.has(r)||(e.push({id:r,color:o.color||n,...o}),i.add(r))}}),e),[]).sort((e,t)=>e.id.localeCompare(t.id))}(n,{id:t,defaultColor:e,defaultMarkerStart:i?.markerStart,defaultMarkerEnd:i?.markerEnd});return o},[n,i,t,e]);return a.length?(0,o.jsx)("svg",{className:"react-flow__marker","aria-hidden":"true",children:(0,o.jsx)("defs",{children:a.map(e=>(0,o.jsx)(Al,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};jl.displayName="MarkerDefinitions";var zl=(0,r.memo)(jl);function Ol({x:e,y:t,label:n,labelStyle:i,labelShowBg:a=!0,labelBgStyle:s,labelBgPadding:l=[2,4],labelBgBorderRadius:c=2,children:d,className:u,...h}){const[f,g]=(0,r.useState)({x:1,y:0,width:0,height:0}),p=ft(["react-flow__edge-textwrapper",u]),m=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(m.current){const e=m.current.getBBox();g({x:e.x,y:e.y,width:e.width,height:e.height})}},[n]),n?(0,o.jsxs)("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:p,visibility:f.width?"visible":"hidden",...h,children:[a&&(0,o.jsx)("rect",{width:f.width+2*l[0],x:-l[0],y:-l[1],height:f.height+2*l[1],className:"react-flow__edge-textbg",style:s,rx:c,ry:c}),(0,o.jsx)("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:m,style:i,children:n}),d]}):null}Ol.displayName="EdgeText";const Dl=(0,r.memo)(Ol);function Il({path:e,labelX:t,labelY:n,label:r,labelStyle:i,labelShowBg:a,labelBgStyle:s,labelBgPadding:l,labelBgBorderRadius:c,interactionWidth:d=20,...u}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{...u,d:e,fill:"none",className:ft(["react-flow__edge-path",u.className])}),d&&(0,o.jsx)("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:d,className:"react-flow__edge-interaction"}),r&&Pi(t)&&Pi(n)?(0,o.jsx)(Dl,{x:t,y:n,label:r,labelStyle:i,labelShowBg:a,labelBgStyle:s,labelBgPadding:l,labelBgBorderRadius:c}):null]})}function Rl({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===si.Left||e===si.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function Tl({sourceX:e,sourceY:t,sourcePosition:n=si.Bottom,targetX:o,targetY:r,targetPosition:i=si.Top}){const[a,s]=Rl({pos:n,x1:e,y1:t,x2:o,y2:r}),[l,c]=Rl({pos:i,x1:o,y1:r,x2:e,y2:t}),[d,u,h,f]=Gi({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:s,targetControlX:l,targetControlY:c});return[`M${e},${t} C${a},${s} ${l},${c} ${o},${r}`,d,u,h,f]}function $l(e){return(0,r.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,sourcePosition:s,targetPosition:l,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:p,markerEnd:m,markerStart:y,interactionWidth:v})=>{const[x,b,w]=Tl({sourceX:n,sourceY:r,sourcePosition:s,targetX:i,targetY:a,targetPosition:l}),S=e.isInternal?void 0:t;return(0,o.jsx)(Il,{id:S,path:x,labelX:b,labelY:w,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:p,markerEnd:m,markerStart:y,interactionWidth:v})})}const Ll=$l({isInternal:!1}),Bl=$l({isInternal:!0});function Vl(e){return(0,r.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,sourcePosition:g=si.Bottom,targetPosition:p=si.Top,markerEnd:m,markerStart:y,pathOptions:v,interactionWidth:x})=>{const[b,w,S]=aa({sourceX:n,sourceY:r,sourcePosition:g,targetX:i,targetY:a,targetPosition:p,borderRadius:v?.borderRadius,offset:v?.offset}),C=e.isInternal?void 0:t;return(0,o.jsx)(Il,{id:C,path:b,labelX:w,labelY:S,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:y,interactionWidth:x})})}Ll.displayName="SimpleBezierEdge",Bl.displayName="SimpleBezierEdgeInternal";const Hl=Vl({isInternal:!1}),Fl=Vl({isInternal:!0});function Yl(e){return(0,r.memo)(({id:t,...n})=>{const i=e.isInternal?void 0:t;return(0,o.jsx)(Hl,{...n,id:i,pathOptions:(0,r.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}Hl.displayName="SmoothStepEdge",Fl.displayName="SmoothStepEdgeInternal";const Zl=Yl({isInternal:!1}),Xl=Yl({isInternal:!0});function Wl(e){return(0,r.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:p,interactionWidth:m})=>{const[y,v,x]=oa({sourceX:n,sourceY:r,targetX:i,targetY:a}),b=e.isInternal?void 0:t;return(0,o.jsx)(Il,{id:b,path:y,labelX:v,labelY:x,label:s,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:p,interactionWidth:m})})}Zl.displayName="StepEdge",Xl.displayName="StepEdgeInternal";const ql=Wl({isInternal:!1}),Kl=Wl({isInternal:!0});function Gl(e){return(0,r.memo)(({id:t,sourceX:n,sourceY:r,targetX:i,targetY:a,sourcePosition:s=si.Bottom,targetPosition:l=si.Top,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:p,markerEnd:m,markerStart:y,pathOptions:v,interactionWidth:x})=>{const[b,w,S]=Ji({sourceX:n,sourceY:r,sourcePosition:s,targetX:i,targetY:a,targetPosition:l,curvature:v?.curvature}),C=e.isInternal?void 0:t;return(0,o.jsx)(Il,{id:C,path:b,labelX:w,labelY:S,label:c,labelStyle:d,labelShowBg:u,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:p,markerEnd:m,markerStart:y,interactionWidth:x})})}ql.displayName="StraightEdge",Kl.displayName="StraightEdgeInternal";const Ul=Gl({isInternal:!1}),Ql=Gl({isInternal:!0});Ul.displayName="BezierEdge",Ql.displayName="BezierEdgeInternal";const Jl={default:Ql,straight:Kl,step:Xl,smoothstep:Fl,simplebezier:Bl},ec={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},tc=(e,t,n)=>n===si.Left?e-t:n===si.Right?e+t:e,nc=(e,t,n)=>n===si.Top?e-t:n===si.Bottom?e+t:e,oc="react-flow__edgeupdater";function rc({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:a,onMouseOut:s,type:l}){return(0,o.jsx)("circle",{onMouseDown:i,onMouseEnter:a,onMouseOut:s,className:ft([oc,`${oc}-${l}`]),cx:tc(t,r,e),cy:nc(n,r,e),r,stroke:"transparent",fill:"transparent"})}function ic({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:i,targetX:a,targetY:s,sourcePosition:l,targetPosition:c,onReconnect:d,onReconnectStart:u,onReconnectEnd:h,setReconnecting:f,setUpdateHover:g}){const p=ls(),m=(e,t)=>{if(0!==e.button)return;const{autoPanOnConnect:o,domNode:r,isValidConnection:i,connectionMode:a,connectionRadius:s,lib:l,onConnectStart:c,onConnectEnd:g,cancelConnection:m,nodeLookup:y,rfId:v,panBy:x,updateConnection:b}=p.getState(),w="target"===t.type;f(!0),u?.(e,n,t.type),Ma.onPointerDown(e.nativeEvent,{autoPanOnConnect:o,connectionMode:a,connectionRadius:s,domNode:r,handleId:t.id,nodeId:t.nodeId,nodeLookup:y,isTarget:w,edgeUpdaterType:t.type,lib:l,flowId:v,cancelConnection:m,panBy:x,isValidConnection:i,onConnect:e=>d?.(n,e),onConnectStart:c,onConnectEnd:g,onReconnectEnd:(e,o)=>{f(!1),h?.(e,n,t.type,o)},updateConnection:b,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},y=()=>g(!0),v=()=>g(!1);return(0,o.jsxs)(o.Fragment,{children:[(!0===e||"source"===e)&&(0,o.jsx)(rc,{position:l,centerX:r,centerY:i,radius:t,onMouseDown:e=>m(e,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),onMouseEnter:y,onMouseOut:v,type:"source"}),(!0===e||"target"===e)&&(0,o.jsx)(rc,{position:c,centerX:a,centerY:s,radius:t,onMouseDown:e=>m(e,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),onMouseEnter:y,onMouseOut:v,type:"target"})]})}function ac({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:i,onClick:a,onDoubleClick:s,onContextMenu:l,onMouseEnter:c,onMouseMove:d,onMouseLeave:u,reconnectRadius:h,onReconnect:f,onReconnectStart:g,onReconnectEnd:p,rfId:m,edgeTypes:y,noPanClassName:v,onError:x,disableKeyboardA11y:b}){let w=ss(t=>t.edgeLookup.get(e));const S=ss(e=>e.defaultEdgeOptions);w=S?{...S,...w}:w;let C=w.type||"default",_=y?.[C]||Jl[C];void 0===_&&(x?.("011",(e=>`Edge type "${e}" not found. Using fallback type "default".`)(C)),C="default",_=Jl.default);const E=!!(w.focusable||t&&void 0===w.focusable),k=void 0!==f&&(w.reconnectable||n&&void 0===w.reconnectable),N=!!(w.selectable||i&&void 0===w.selectable),M=(0,r.useRef)(null),[P,A]=(0,r.useState)(!1),[j,z]=(0,r.useState)(!1),O=ls(),{zIndex:D,sourceX:I,sourceY:R,targetX:T,targetY:$,sourcePosition:L,targetPosition:B}=ss((0,r.useCallback)(t=>{const n=t.nodeLookup.get(w.source),o=t.nodeLookup.get(w.target);if(!n||!o)return{zIndex:w.zIndex,...ec};const r=function(e){const{sourceNode:t,targetNode:n}=e;if(!sa(t)||!sa(n))return null;const o=t.internals.handleBounds||la(t.handles),r=n.internals.handleBounds||la(n.handles),i=da(o?.source??[],e.sourceHandle),a=da(e.connectionMode===ei.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!a)return e.onError?.("008",((e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${"source"===e?n:o}", edge id: ${t}.`)(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=i?.position||si.Bottom,l=a?.position||si.Top,c=ca(t,i,s),d=ca(n,a,l);return{sourceX:c.x,sourceY:c.y,targetX:d.x,targetY:d.y,sourcePosition:s,targetPosition:l}}({id:e,sourceNode:n,targetNode:o,sourceHandle:w.sourceHandle||null,targetHandle:w.targetHandle||null,connectionMode:t.connectionMode,onError:x}),i=function({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1}){if(!r)return o;const i=n||t.selected||e.selected,a=Math.max(e.internals.z||0,t.internals.z||0,1e3);return o+(i?a:0)}({selected:w.selected,zIndex:w.zIndex,sourceNode:n,targetNode:o,elevateOnSelect:t.elevateEdgesOnSelect});return{zIndex:i,...r||ec}},[w.source,w.target,w.sourceHandle,w.targetHandle,w.selected,w.zIndex]),os),V=(0,r.useMemo)(()=>w.markerStart?`url('#${ua(w.markerStart,m)}')`:void 0,[w.markerStart,m]),H=(0,r.useMemo)(()=>w.markerEnd?`url('#${ua(w.markerEnd,m)}')`:void 0,[w.markerEnd,m]);if(w.hidden||null===I||null===R||null===T||null===$)return null;const F=s?e=>{s(e,{...w})}:void 0,Y=l?e=>{l(e,{...w})}:void 0,Z=c?e=>{c(e,{...w})}:void 0,X=d?e=>{d(e,{...w})}:void 0,W=u?e=>{u(e,{...w})}:void 0;return(0,o.jsx)("svg",{style:{zIndex:D},children:(0,o.jsxs)("g",{className:ft(["react-flow__edge",`react-flow__edge-${C}`,w.className,v,{selected:w.selected,animated:w.animated,inactive:!N&&!a,updating:P,selectable:N}]),onClick:t=>{const{addSelectedEdges:n,unselectNodesAndEdges:o,multiSelectionActive:r}=O.getState();N&&(O.setState({nodesSelectionActive:!1}),w.selected&&r?(o({nodes:[],edges:[w]}),M.current?.blur()):n([e])),a&&a(t,w)},onDoubleClick:F,onContextMenu:Y,onMouseEnter:Z,onMouseMove:X,onMouseLeave:W,onKeyDown:E?t=>{if(!b&&Jr.includes(t.key)&&N){const{unselectNodesAndEdges:n,addSelectedEdges:o}=O.getState();"Escape"===t.key?(M.current?.blur(),n({edges:[w]})):o([e])}}:void 0,tabIndex:E?0:void 0,role:E?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":null===w.ariaLabel?void 0:w.ariaLabel||`Edge from ${w.source} to ${w.target}`,"aria-describedby":E?`${hs}-${m}`:void 0,ref:M,children:[!j&&(0,o.jsx)(_,{id:e,source:w.source,target:w.target,type:w.type,selected:w.selected,animated:w.animated,selectable:N,deletable:w.deletable??!0,label:w.label,labelStyle:w.labelStyle,labelShowBg:w.labelShowBg,labelBgStyle:w.labelBgStyle,labelBgPadding:w.labelBgPadding,labelBgBorderRadius:w.labelBgBorderRadius,sourceX:I,sourceY:R,targetX:T,targetY:$,sourcePosition:L,targetPosition:B,data:w.data,style:w.style,sourceHandleId:w.sourceHandle,targetHandleId:w.targetHandle,markerStart:V,markerEnd:H,pathOptions:"pathOptions"in w?w.pathOptions:void 0,interactionWidth:w.interactionWidth}),k&&(0,o.jsx)(ic,{edge:w,isReconnectable:k,reconnectRadius:h,onReconnect:f,onReconnectStart:g,onReconnectEnd:p,sourceX:I,sourceY:R,targetX:T,targetY:$,sourcePosition:L,targetPosition:B,setUpdateHover:A,setReconnecting:z})]})})}const sc=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function lc({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:i,noPanClassName:a,onReconnect:s,onEdgeContextMenu:l,onEdgeMouseEnter:c,onEdgeMouseMove:d,onEdgeMouseLeave:u,onEdgeClick:h,reconnectRadius:f,onEdgeDoubleClick:g,onReconnectStart:p,onReconnectEnd:m,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:x,elementsSelectable:b,onError:w}=ss(sc,os),S=ss((0,r.useCallback)(e=>{if(!C)return e.edges.map(e=>e.id);const t=[];if(e.width&&e.height)for(const n of e.edges){const o=e.nodeLookup.get(n.source),r=e.nodeLookup.get(n.target);o&&r&&ta({sourceNode:o,targetNode:r,width:e.width,height:e.height,transform:e.transform})&&t.push(n.id)}return t},[C=t]),os);var C;return(0,o.jsxs)("div",{className:"react-flow__edges",children:[(0,o.jsx)(zl,{defaultColor:e,rfId:n}),S.map(e=>(0,o.jsx)(ac,{id:e,edgesFocusable:v,edgesReconnectable:x,elementsSelectable:b,noPanClassName:a,onReconnect:s,onContextMenu:l,onMouseEnter:c,onMouseMove:d,onMouseLeave:u,onClick:h,reconnectRadius:f,onDoubleClick:g,onReconnectStart:p,onReconnectEnd:m,rfId:n,onError:w,edgeTypes:i,disableKeyboardA11y:y},e))]})}lc.displayName="EdgeRenderer";const cc=(0,r.memo)(lc),dc=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function uc({children:e}){const t=ss(dc);return(0,o.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}const hc=e=>e.panZoom?.syncViewport;function fc(e){return e.connection.inProgress?{...e.connection,to:zi(e.connection.to,e.transform)}:{...e.connection}}const gc=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function pc({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:i,width:a,height:s,isValid:l,inProgress:c}=ss(gc,os);return a&&i&&c?(0,o.jsx)("svg",{style:e,width:a,height:s,className:"react-flow__connectionline react-flow__container",children:(0,o.jsx)("g",{className:ft(["react-flow__connection",ci(l)]),children:(0,o.jsx)(mc,{style:t,type:n,CustomComponent:r,isValid:l})})}):null}const mc=({style:e,type:t=ii.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:i,from:a,fromNode:s,fromHandle:l,fromPosition:c,to:d,toNode:u,toHandle:h,toPosition:f}=ss(fc,os);if(!i)return;if(n)return(0,o.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:l,fromX:a.x,fromY:a.y,toX:d.x,toY:d.y,fromPosition:c,toPosition:f,connectionStatus:ci(r),toNode:u,toHandle:h});let g="";const p={sourceX:a.x,sourceY:a.y,sourcePosition:c,targetX:d.x,targetY:d.y,targetPosition:f};switch(t){case ii.Bezier:[g]=Ji(p);break;case ii.SimpleBezier:[g]=Tl(p);break;case ii.Step:[g]=aa({...p,borderRadius:0});break;case ii.SmoothStep:[g]=aa(p);break;default:[g]=oa(p)}return(0,o.jsx)("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};mc.displayName="ConnectionLine";const yc={};function vc(e=yc){(0,r.useRef)(e),ls(),(0,r.useEffect)(()=>{},[e])}function xc({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:s,onEdgeDoubleClick:l,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:u,onNodeContextMenu:h,onSelectionContextMenu:f,onSelectionStart:g,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:x,selectionKeyCode:b,selectionOnDrag:w,selectionMode:S,multiSelectionKeyCode:C,panActivationKeyCode:_,zoomActivationKeyCode:E,deleteKeyCode:k,onlyRenderVisibleElements:N,elementsSelectable:M,defaultViewport:P,translateExtent:A,minZoom:j,maxZoom:z,preventScrolling:O,defaultMarkerColor:D,zoomOnScroll:I,zoomOnPinch:R,panOnScroll:T,panOnScrollSpeed:$,panOnScrollMode:L,zoomOnDoubleClick:B,panOnDrag:V,onPaneClick:H,onPaneMouseEnter:F,onPaneMouseMove:Y,onPaneMouseLeave:Z,onPaneScroll:X,onPaneContextMenu:W,paneClickDistance:q,nodeClickDistance:K,onEdgeContextMenu:G,onEdgeMouseEnter:U,onEdgeMouseMove:Q,onEdgeMouseLeave:J,reconnectRadius:ee,onReconnect:te,onReconnectStart:ne,onReconnectEnd:oe,noDragClassName:re,noWheelClassName:ie,noPanClassName:ae,disableKeyboardA11y:se,nodeExtent:le,rfId:ce,viewport:de,onViewportChange:ue}){return vc(e),vc(t),ls(),(0,r.useRef)(!1),(0,r.useEffect)(()=>{},[]),function(e){const t=Us(),n=(0,r.useRef)(!1);(0,r.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}(n),function(e){const t=ss(hc),n=ls();(0,r.useEffect)(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t])}(de),(0,o.jsx)(Cl,{onPaneClick:H,onPaneMouseEnter:F,onPaneMouseMove:Y,onPaneMouseLeave:Z,onPaneContextMenu:W,onPaneScroll:X,paneClickDistance:q,deleteKeyCode:k,selectionKeyCode:b,selectionOnDrag:w,selectionMode:S,onSelectionStart:g,onSelectionEnd:p,multiSelectionKeyCode:C,panActivationKeyCode:_,zoomActivationKeyCode:E,elementsSelectable:M,zoomOnScroll:I,zoomOnPinch:R,zoomOnDoubleClick:B,panOnScroll:T,panOnScrollSpeed:$,panOnScrollMode:L,panOnDrag:V,defaultViewport:P,translateExtent:A,minZoom:j,maxZoom:z,onSelectionContextMenu:f,preventScrolling:O,noDragClassName:re,noWheelClassName:ie,noPanClassName:ae,disableKeyboardA11y:se,onViewportChange:ue,isControlledViewport:!!de,children:(0,o.jsxs)(uc,{children:[(0,o.jsx)(cc,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:l,onReconnect:te,onReconnectStart:ne,onReconnectEnd:oe,onlyRenderVisibleElements:N,onEdgeContextMenu:G,onEdgeMouseEnter:U,onEdgeMouseMove:Q,onEdgeMouseLeave:J,reconnectRadius:ee,defaultMarkerColor:D,noPanClassName:ae,disableKeyboardA11y:se,rfId:ce}),(0,o.jsx)(pc,{style:y,type:m,component:v,containerStyle:x}),(0,o.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,o.jsx)(Ml,{nodeTypes:e,onNodeClick:i,onNodeDoubleClick:s,onNodeMouseEnter:c,onNodeMouseMove:d,onNodeMouseLeave:u,onNodeContextMenu:h,nodeClickDistance:K,onlyRenderVisibleElements:N,noPanClassName:ae,noDragClassName:re,disableKeyboardA11y:se,nodeExtent:le,rfId:ce}),(0,o.jsx)("div",{className:"react-flow__viewport-portal"})]})})}xc.displayName="GraphView";const bc=(0,r.memo)(xc),wc=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:a,fitViewOptions:s,minZoom:l=.5,maxZoom:c=2,nodeOrigin:d,nodeExtent:u}={})=>{const h=new Map,f=new Map,g=new Map,p=new Map,m=o??t??[],y=n??e??[],v=d??[0,0],x=u??Qr;ba(g,p,m);const b=pa(y,h,f,{nodeOrigin:v,nodeExtent:x,elevateNodesOnSelect:!1});let w=[0,0,1];if(a&&r&&i){const e=fi(h,{filter:e=>!(!e.width&&!e.initialWidth||!e.height&&!e.initialHeight)}),{x:t,y:n,zoom:o}=Ii(e,r,i,l,c,s?.padding??.1);w=[t,n,o]}return{rfId:"1",width:0,height:0,transform:w,nodes:y,nodesInitialized:b,nodeLookup:h,parentLookup:f,edges:m,edgeLookup:p,connectionLookup:g,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==n,hasDefaultEdges:void 0!==o,panZoom:null,minZoom:l,maxZoom:c,translateExtent:Qr,nodeExtent:x,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:ei.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:v,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:s,fitViewResolver:null,connection:{...ri},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Ai,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}};function Sc({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:i,initialWidth:a,initialHeight:s,initialMinZoom:l,initialMaxZoom:c,initialFitViewOptions:d,fitView:u,nodeOrigin:h,nodeExtent:f,children:g}){const[p]=(0,r.useState)(()=>(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:a,fitViewOptions:s,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:u})=>{return h=(h,f)=>{async function g(){const{nodeLookup:e,panZoom:t,fitViewOptions:n,fitViewResolver:o,width:r,height:i,minZoom:a,maxZoom:s}=f();t&&(await async function({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},a){if(0===e.size)return Promise.resolve(!0);const s=function(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(e=>e.id)):null;return e.forEach(e=>{!e.measured.width||!e.measured.height||!t?.includeHiddenNodes&&e.hidden||o&&!o.has(e.id)||n.set(e.id,e)}),n}(e,a),l=fi(s),c=Ii(l,t,n,a?.minZoom??r,a?.maxZoom??i,a?.padding??.1);return await o.setViewport(c,{duration:a?.duration}),Promise.resolve(!0)}({nodes:e,width:r,height:i,panZoom:t,minZoom:a,maxZoom:s},n),o?.resolve(!0),h({fitViewResolver:null}))}return{...wc({nodes:e,edges:t,width:r,height:i,fitView:a,fitViewOptions:s,minZoom:l,maxZoom:c,nodeOrigin:d,nodeExtent:u,defaultNodes:n,defaultEdges:o}),setNodes:e=>{const{nodeLookup:t,parentLookup:n,nodeOrigin:o,elevateNodesOnSelect:r,fitViewQueued:i}=f(),a=pa(e,t,n,{nodeOrigin:o,nodeExtent:u,elevateNodesOnSelect:r,checkEquality:!0});i&&a?(g(),h({nodes:e,nodesInitialized:a,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:e,nodesInitialized:a})},setEdges:e=>{const{connectionLookup:t,edgeLookup:n}=f();ba(t,n,e),h({edges:e})},setDefaultNodesAndEdges:(e,t)=>{if(e){const{setNodes:t}=f();t(e),h({hasDefaultNodes:!0})}if(t){const{setEdges:e}=f();e(t),h({hasDefaultEdges:!0})}},updateNodeInternals:e=>{const{triggerNodeChanges:t,nodeLookup:n,parentLookup:o,domNode:r,nodeOrigin:i,nodeExtent:a,debug:s,fitViewQueued:l}=f(),{changes:c,updatedInternals:d}=function(e,t,n,o,r,i){const a=o?.querySelector(".xyflow__viewport");let s=!1;if(!a)return{changes:[],updatedInternals:s};const l=[],c=window.getComputedStyle(a),{m22:d}=new window.DOMMatrixReadOnly(c.transform),u=[];for(const o of e.values()){const e=t.get(o.id);if(!e)continue;if(e.hidden){t.set(e.id,{...e,internals:{...e.internals,handleBounds:void 0}}),s=!0;continue}const a=Fi(o.nodeElement),c=e.measured.width!==a.width||e.measured.height!==a.height;if(a.width&&a.height&&(c||!e.internals.handleBounds||o.force)){const h=o.nodeElement.getBoundingClientRect(),f=Ti(e.extent)?e.extent:i;let{positionAbsolute:g}=e.internals;e.parentId&&"parent"===e.extent?g=vi(g,a,t.get(e.parentId)):f&&(g=yi(g,f,a));const p={...e,measured:a,internals:{...e.internals,positionAbsolute:g,handleBounds:{source:Ki("source",o.nodeElement,h,d,e.id),target:Ki("target",o.nodeElement,h,d,e.id)}}};t.set(e.id,p),e.parentId&&ma(p,t,n,{nodeOrigin:r}),s=!0,c&&(l.push({id:e.id,type:"dimensions",dimensions:a}),e.expandParent&&e.parentId&&u.push({id:e.id,parentId:e.parentId,rect:_i(p,r)}))}}if(u.length>0){const e=va(u,t,n,r);l.push(...e)}return{changes:l,updatedInternals:s}}(e,n,o,r,i,a);d&&(function(e,t,n){const o=ga(ha,n);for(const n of e.values())if(n.parentId)ma(n,e,t,o);else{const e=hi(n,o.nodeOrigin),t=Ti(n.extent)?n.extent:o.nodeExtent,r=yi(e,t,$i(n));n.internals.positionAbsolute=r}}(n,o,{nodeOrigin:i,nodeExtent:a}),l?(g(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),c?.length>0&&(s&&console.log("React Flow: trigger node changes",c),t?.(c)))},updateNodePositions:(e,t=!1)=>{const n=[],o=[],{nodeLookup:r,triggerNodeChanges:i}=f();for(const[i,a]of e){const e=r.get(i),s=!!(e?.expandParent&&e?.parentId&&a?.position),l={id:i,type:"position",position:s?{x:Math.max(0,a.position.x),y:Math.max(0,a.position.y)}:a.position,dragging:t};s&&e.parentId&&n.push({id:i,parentId:e.parentId,rect:{...a.internals.positionAbsolute,width:a.measured.width??0,height:a.measured.height??0}}),o.push(l)}if(n.length>0){const{parentLookup:e,nodeOrigin:t}=f(),i=va(n,r,e,t);o.push(...i)}i(o)},triggerNodeChanges:e=>{const{onNodesChange:t,setNodes:n,nodes:o,hasDefaultNodes:r,debug:i}=f();e?.length&&(r&&n($s(e,o)),i&&console.log("React Flow: trigger node changes",e),t?.(e))},triggerEdgeChanges:e=>{const{onEdgesChange:t,setEdges:n,edges:o,hasDefaultEdges:r,debug:i}=f();e?.length&&(r&&n(Ls(e,o)),i&&console.log("React Flow: trigger edge changes",e),t?.(e))},addSelectedNodes:e=>{const{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:i}=f();t?r(e.map(e=>Bs(e,!0))):(r(Vs(o,new Set([...e]),!0)),i(Vs(n)))},addSelectedEdges:e=>{const{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:r,triggerEdgeChanges:i}=f();t?i(e.map(e=>Bs(e,!0))):(i(Vs(n,new Set([...e]))),r(Vs(o,new Set,!0)))},unselectNodesAndEdges:({nodes:e,edges:t}={})=>{const{edges:n,nodes:o,nodeLookup:r,triggerNodeChanges:i,triggerEdgeChanges:a}=f(),s=t||n,l=(e||o).map(e=>{const t=r.get(e.id);return t&&(t.selected=!1),Bs(e.id,!1)}),c=s.map(e=>Bs(e.id,!1));i(l),a(c)},setMinZoom:e=>{const{panZoom:t,maxZoom:n}=f();t?.setScaleExtent([e,n]),h({minZoom:e})},setMaxZoom:e=>{const{panZoom:t,minZoom:n}=f();t?.setScaleExtent([n,e]),h({maxZoom:e})},setTranslateExtent:e=>{f().panZoom?.setTranslateExtent(e),h({translateExtent:e})},setPaneClickDistance:e=>{f().panZoom?.setClickDistance(e)},resetSelectedElements:()=>{const{edges:e,nodes:t,triggerNodeChanges:n,triggerEdgeChanges:o,elementsSelectable:r}=f();if(!r)return;const i=t.reduce((e,t)=>t.selected?[...e,Bs(t.id,!1)]:e,[]),a=e.reduce((e,t)=>t.selected?[...e,Bs(t.id,!1)]:e,[]);n(i),o(a)},setNodeExtent:e=>{const{nodes:t,nodeLookup:n,parentLookup:o,nodeOrigin:r,elevateNodesOnSelect:i,nodeExtent:a}=f();e[0][0]===a[0][0]&&e[0][1]===a[0][1]&&e[1][0]===a[1][0]&&e[1][1]===a[1][1]||(pa(t,n,o,{nodeOrigin:r,nodeExtent:e,elevateNodesOnSelect:i,checkEquality:!1}),h({nodeExtent:e}))},panBy:e=>{const{transform:t,width:n,height:o,panZoom:r,translateExtent:i}=f();return async function({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o),s=!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]);return Promise.resolve(s)}({delta:e,panZoom:r,transform:t,translateExtent:i,width:n,height:o})},cancelConnection:()=>{h({connection:{...ri}})},updateConnection:e=>{h({connection:e})},reset:()=>h({...wc()})}},f=Object.is,h?ns(h,f):ns;var h,f})({nodes:e,edges:t,defaultNodes:n,defaultEdges:i,width:a,height:s,fitView:u,minZoom:l,maxZoom:c,fitViewOptions:d,nodeOrigin:h,nodeExtent:f}));return(0,o.jsx)(is,{value:p,children:(0,o.jsx)(Ks,{children:g})})}function Cc({children:e,nodes:t,edges:n,defaultNodes:i,defaultEdges:a,width:s,height:l,fitView:c,fitViewOptions:d,minZoom:u,maxZoom:h,nodeOrigin:f,nodeExtent:g}){return(0,r.useContext)(rs)?(0,o.jsx)(o.Fragment,{children:e}):(0,o.jsx)(Sc,{initialNodes:t,initialEdges:n,defaultNodes:i,defaultEdges:a,initialWidth:s,initialHeight:l,fitView:c,initialFitViewOptions:d,initialMinZoom:u,initialMaxZoom:h,nodeOrigin:f,nodeExtent:g,children:e})}const _c={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var Ec=Zs(function({nodes:e,edges:t,defaultNodes:n,defaultEdges:i,className:a,nodeTypes:s,edgeTypes:l,onNodeClick:c,onEdgeClick:d,onInit:u,onMove:h,onMoveStart:f,onMoveEnd:g,onConnect:p,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:x,onNodeMouseEnter:b,onNodeMouseMove:w,onNodeMouseLeave:S,onNodeContextMenu:C,onNodeDoubleClick:_,onNodeDragStart:E,onNodeDrag:k,onNodeDragStop:N,onNodesDelete:M,onEdgesDelete:P,onDelete:A,onSelectionChange:j,onSelectionDragStart:z,onSelectionDrag:O,onSelectionDragStop:D,onSelectionContextMenu:I,onSelectionStart:R,onSelectionEnd:T,onBeforeDelete:$,connectionMode:L,connectionLineType:B=ii.Bezier,connectionLineStyle:V,connectionLineComponent:H,connectionLineContainerStyle:F,deleteKeyCode:Y="Backspace",selectionKeyCode:Z="Shift",selectionOnDrag:X=!1,selectionMode:W=ni.Full,panActivationKeyCode:q="Space",multiSelectionKeyCode:K=(Ri()?"Meta":"Control"),zoomActivationKeyCode:G=(Ri()?"Meta":"Control"),snapToGrid:U,snapGrid:Q,onlyRenderVisibleElements:J=!1,selectNodesOnDrag:ee,nodesDraggable:te,nodesConnectable:ne,nodesFocusable:oe,nodeOrigin:re=Es,edgesFocusable:ie,edgesReconnectable:ae,elementsSelectable:se=!0,defaultViewport:le=ks,minZoom:ce=.5,maxZoom:de=2,translateExtent:ue=Qr,preventScrolling:he=!0,nodeExtent:fe,defaultMarkerColor:ge="#b1b1b7",zoomOnScroll:pe=!0,zoomOnPinch:me=!0,panOnScroll:ye=!1,panOnScrollSpeed:ve=.5,panOnScrollMode:xe=ti.Free,zoomOnDoubleClick:be=!0,panOnDrag:we=!0,onPaneClick:Se,onPaneMouseEnter:Ce,onPaneMouseMove:_e,onPaneMouseLeave:Ee,onPaneScroll:ke,onPaneContextMenu:Ne,paneClickDistance:Me=0,nodeClickDistance:Pe=0,children:Ae,onReconnect:je,onReconnectStart:ze,onReconnectEnd:Oe,onEdgeContextMenu:De,onEdgeDoubleClick:Ie,onEdgeMouseEnter:Re,onEdgeMouseMove:Te,onEdgeMouseLeave:$e,reconnectRadius:Le=10,onNodesChange:Be,onEdgesChange:Ve,noDragClassName:He="nodrag",noWheelClassName:Fe="nowheel",noPanClassName:Ye="nopan",fitView:Ze,fitViewOptions:Xe,connectOnClick:We,attributionPosition:qe,proOptions:Ke,defaultEdgeOptions:Ge,elevateNodesOnSelect:Ue,elevateEdgesOnSelect:Qe,disableKeyboardA11y:Je=!1,autoPanOnConnect:et,autoPanOnNodeDrag:tt,autoPanSpeed:nt,connectionRadius:ot,isValidConnection:rt,onError:it,style:at,id:st,nodeDragThreshold:lt,viewport:ct,onViewportChange:dt,width:ut,height:ht,colorMode:gt="light",debug:pt,onScroll:mt,...yt},vt){const xt=st||"1",bt=function(e){const[t,n]=(0,r.useState)("system"===e?null:e);return(0,r.useEffect)(()=>{if("system"!==e)return void n(e);const t=js(),o=()=>n(t?.matches?"dark":"light");return o(),t?.addEventListener("change",o),()=>{t?.removeEventListener("change",o)}},[e]),null!==t?t:js()?.matches?"dark":"light"}(gt),wt=(0,r.useCallback)(e=>{e.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),mt?.(e)},[mt]);return(0,o.jsx)("div",{"data-testid":"rf__wrapper",...yt,onScroll:wt,style:{...at,..._c},ref:vt,className:ft(["react-flow",a,bt]),id:st,children:(0,o.jsxs)(Cc,{nodes:e,edges:t,width:ut,height:ht,fitView:Ze,fitViewOptions:Xe,minZoom:ce,maxZoom:de,nodeOrigin:re,nodeExtent:fe,children:[(0,o.jsx)(bc,{onInit:u,onNodeClick:c,onEdgeClick:d,onNodeMouseEnter:b,onNodeMouseMove:w,onNodeMouseLeave:S,onNodeContextMenu:C,onNodeDoubleClick:_,nodeTypes:s,edgeTypes:l,connectionLineType:B,connectionLineStyle:V,connectionLineComponent:H,connectionLineContainerStyle:F,selectionKeyCode:Z,selectionOnDrag:X,selectionMode:W,deleteKeyCode:Y,multiSelectionKeyCode:K,panActivationKeyCode:q,zoomActivationKeyCode:G,onlyRenderVisibleElements:J,defaultViewport:le,translateExtent:ue,minZoom:ce,maxZoom:de,preventScrolling:he,zoomOnScroll:pe,zoomOnPinch:me,zoomOnDoubleClick:be,panOnScroll:ye,panOnScrollSpeed:ve,panOnScrollMode:xe,panOnDrag:we,onPaneClick:Se,onPaneMouseEnter:Ce,onPaneMouseMove:_e,onPaneMouseLeave:Ee,onPaneScroll:ke,onPaneContextMenu:Ne,paneClickDistance:Me,nodeClickDistance:Pe,onSelectionContextMenu:I,onSelectionStart:R,onSelectionEnd:T,onReconnect:je,onReconnectStart:ze,onReconnectEnd:Oe,onEdgeContextMenu:De,onEdgeDoubleClick:Ie,onEdgeMouseEnter:Re,onEdgeMouseMove:Te,onEdgeMouseLeave:$e,reconnectRadius:Le,defaultMarkerColor:ge,noDragClassName:He,noWheelClassName:Fe,noPanClassName:Ye,rfId:xt,disableKeyboardA11y:Je,nodeExtent:fe,viewport:ct,onViewportChange:dt}),(0,o.jsx)(As,{nodes:e,edges:t,defaultNodes:n,defaultEdges:i,onConnect:p,onConnectStart:m,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:x,nodesDraggable:te,nodesConnectable:ne,nodesFocusable:oe,edgesFocusable:ie,edgesReconnectable:ae,elementsSelectable:se,elevateNodesOnSelect:Ue,elevateEdgesOnSelect:Qe,minZoom:ce,maxZoom:de,nodeExtent:fe,onNodesChange:Be,onEdgesChange:Ve,snapToGrid:U,snapGrid:Q,connectionMode:L,translateExtent:ue,connectOnClick:We,defaultEdgeOptions:Ge,fitView:Ze,fitViewOptions:Xe,onNodesDelete:M,onEdgesDelete:P,onDelete:A,onNodeDragStart:E,onNodeDrag:k,onNodeDragStop:N,onSelectionDrag:O,onSelectionDragStart:z,onSelectionDragStop:D,onMove:h,onMoveStart:f,onMoveEnd:g,noPanClassName:Ye,nodeOrigin:re,rfId:xt,autoPanOnConnect:et,autoPanOnNodeDrag:tt,autoPanSpeed:nt,onError:it,connectionRadius:ot,isValidConnection:rt,selectNodesOnDrag:ee,nodeDragThreshold:lt,onBeforeDelete:$,paneClickDistance:Me,debug:pt}),(0,o.jsx)(_s,{onSelectionChange:j}),Ae,(0,o.jsx)(vs,{proOptions:Ke,position:qe}),(0,o.jsx)(ps,{rfId:xt,disableKeyboardA11y:Je})]})})});const kc=e=>e.domNode?.querySelector(".react-flow__edgelabel-renderer");function Nc({children:e}){const t=ss(kc);return t?(0,E.createPortal)(e,t):null}function Mc({dimensions:e,lineWidth:t,variant:n,className:r}){return(0,o.jsx)("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ft(["react-flow__background-pattern",n,r])})}function Pc({radius:e,className:t}){return(0,o.jsx)("circle",{cx:e,cy:e,r:e,className:ft(["react-flow__background-pattern","dots",t])})}var Ac;!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(Ac||(Ac={}));const jc={[Ac.Dots]:1,[Ac.Lines]:1,[Ac.Cross]:6},zc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Oc({id:e,variant:t=Ac.Dots,gap:n=20,size:i,lineWidth:a=1,offset:s=0,color:l,bgColor:c,style:d,className:u,patternClassName:h}){const f=(0,r.useRef)(null),{transform:g,patternId:p}=ss(zc,os),m=i||jc[t],y=t===Ac.Dots,v=t===Ac.Cross,x=Array.isArray(n)?n:[n,n],b=[x[0]*g[2]||1,x[1]*g[2]||1],w=m*g[2],S=Array.isArray(s)?s:[s,s],C=v?[w,w]:b,_=[S[0]*g[2]||1+C[0]/2,S[1]*g[2]||1+C[1]/2],E=`${p}${e||""}`;return(0,o.jsxs)("svg",{className:ft(["react-flow__background",u]),style:{...d,...el,"--xy-background-color-props":c,"--xy-background-pattern-color-props":l},ref:f,"data-testid":"rf__background",children:[(0,o.jsx)("pattern",{id:E,x:g[0]%b[0],y:g[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${_[0]},-${_[1]})`,children:y?(0,o.jsx)(Pc,{radius:w/2,className:h}):(0,o.jsx)(Mc,{dimensions:C,lineWidth:a,variant:t,className:h})}),(0,o.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}Oc.displayName="Background";const Dc=(0,r.memo)(Oc);function Ic(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,o.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Rc(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,o.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function Tc(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,o.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function $c(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,o.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Lc(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,o.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Bc({children:e,className:t,...n}){return(0,o.jsx)("button",{type:"button",className:ft(["react-flow__controls-button",t]),...n,children:e})}const Vc=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Hc({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:a,onZoomOut:s,onFitView:l,onInteractiveChange:c,className:d,children:u,position:h="bottom-left",orientation:f="vertical","aria-label":g="React Flow controls"}){const p=ls(),{isInteractive:m,minZoomReached:y,maxZoomReached:v}=ss(Vc,os),{zoomIn:x,zoomOut:b,fitView:w}=Us();return(0,o.jsxs)(ys,{className:ft(["react-flow__controls","horizontal"===f?"horizontal":"vertical",d]),position:h,style:e,"data-testid":"rf__controls","aria-label":g,children:[t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Bc,{onClick:()=>{x(),a?.()},className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:v,children:(0,o.jsx)(Ic,{})}),(0,o.jsx)(Bc,{onClick:()=>{b(),s?.()},className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y,children:(0,o.jsx)(Rc,{})})]}),n&&(0,o.jsx)(Bc,{className:"react-flow__controls-fitview",onClick:()=>{w(i),l?.()},title:"fit view","aria-label":"fit view",children:(0,o.jsx)(Tc,{})}),r&&(0,o.jsx)(Bc,{className:"react-flow__controls-interactive",onClick:()=>{p.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c?.(!m)},title:"toggle interactivity","aria-label":"toggle interactivity",children:(0,o.jsx)(m?Lc:$c,{})}),u]})}Hc.displayName="Controls";const Fc=(0,r.memo)(Hc),Yc=(0,r.memo)(function({id:e,x:t,y:n,width:r,height:i,style:a,color:s,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:h,selected:f,onClick:g}){const{background:p,backgroundColor:m}=a||{},y=s||p||m;return(0,o.jsx)("rect",{className:ft(["react-flow__minimap-node",{selected:f},d]),x:t,y:n,rx:u,ry:u,width:r,height:i,style:{fill:y,stroke:l,strokeWidth:c},shapeRendering:h,onClick:g?t=>g(t,e):void 0})}),Zc=e=>e.nodes.map(e=>e.id),Xc=e=>e instanceof Function?e:()=>e,Wc=(0,r.memo)(function({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:i,nodeStrokeWidth:a,shapeRendering:s,NodeComponent:l,onClick:c}){const{node:d,x:u,y:h,width:f,height:g}=ss(t=>{const{internals:n}=t.nodeLookup.get(e),o=n.userNode,{x:r,y:i}=n.positionAbsolute,{width:a,height:s}=$i(o);return{node:o,x:r,y:i,width:a,height:s}},os);return d&&!d.hidden&&Li(d)?(0,o.jsx)(l,{x:u,y:h,width:f,height:g,style:d.style,selected:!!d.selected,className:r(d),color:t(d),borderRadius:i,strokeColor:n(d),strokeWidth:a,shapeRendering:s,onClick:c,id:d.id}):null});var qc=(0,r.memo)(function({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:a=Yc,onClick:s}){const l=ss(Zc,os),c=Xc(t),d=Xc(e),u=Xc(n),h="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return(0,o.jsx)(o.Fragment,{children:l.map(e=>(0,o.jsx)(Wc,{id:e,nodeColorFunc:c,nodeStrokeColorFunc:d,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:i,NodeComponent:a,onClick:s,shapeRendering:h},e))})});const Kc=e=>!e.hidden,Gc=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?ki(fi(e.nodeLookup,{filter:Kc}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}};function Uc({style:e,className:t,nodeStrokeColor:n,nodeColor:i,nodeClassName:a="",nodeBorderRadius:s=5,nodeStrokeWidth:l,nodeComponent:c,bgColor:d,maskColor:u,maskStrokeColor:h,maskStrokeWidth:f,position:g="bottom-right",onClick:p,onNodeClick:m,pannable:y=!1,zoomable:v=!1,ariaLabel:x="React Flow mini map",inversePan:b,zoomStep:w=10,offsetScale:S=5}){const C=ls(),_=(0,r.useRef)(null),{boundingRect:E,viewBB:k,rfId:N,panZoom:M,translateExtent:P,flowWidth:A,flowHeight:j}=ss(Gc,os),z=e?.width??200,O=e?.height??150,D=E.width/z,I=E.height/O,R=Math.max(D,I),T=R*z,$=R*O,L=S*R,B=E.x-(T-E.width)/2-L,V=E.y-($-E.height)/2-L,H=T+2*L,F=$+2*L,Y=`react-flow__minimap-desc-${N}`,Z=(0,r.useRef)(0),X=(0,r.useRef)();Z.current=R,(0,r.useEffect)(()=>{if(_.current&&M)return X.current=function({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=jn(e);return{update:function({translateExtent:e,width:i,height:a,zoomStep:s=10,pannable:l=!0,zoomable:c=!0,inversePan:d=!1}){let u=[0,0];const h=Ur().on("start",e=>{"mousedown"!==e.sourceEvent.type&&"touchstart"!==e.sourceEvent.type||(u=[e.sourceEvent.clientX??e.sourceEvent.touches[0].clientX,e.sourceEvent.clientY??e.sourceEvent.touches[0].clientY])}).on("zoom",l?r=>{const s=n();if("mousemove"!==r.sourceEvent.type&&"touchmove"!==r.sourceEvent.type||!t)return;const l=[r.sourceEvent.clientX??r.sourceEvent.touches[0].clientX,r.sourceEvent.clientY??r.sourceEvent.touches[0].clientY],c=[l[0]-u[0],l[1]-u[1]];u=l;const h=o()*Math.max(s[2],Math.log(s[2]))*(d?-1:1),f={x:s[0]-c[0]*h,y:s[1]-c[1]*h},g=[[0,0],[i,a]];t.setViewportConstrained({x:f.x,y:f.y,zoom:s[2]},g,e)}:null).on("zoom.wheel",c?e=>{const o=n();if("wheel"!==e.sourceEvent.type||!t)return;const r=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*s,i=o[2]*Math.pow(2,r);t.scaleTo(i)}:null);r.call(h,{})},destroy:function(){r.on("zoom",null)},pointer:zn}}({domNode:_.current,panZoom:M,getTransform:()=>C.getState().transform,getViewScale:()=>Z.current}),()=>{X.current?.destroy()}},[M]),(0,r.useEffect)(()=>{X.current?.update({translateExtent:P,width:A,height:j,inversePan:b,pannable:y,zoomStep:w,zoomable:v})},[y,v,b,w,P,A,j]);const W=p?e=>{const[t,n]=X.current?.pointer(e)||[0,0];p(e,{x:t,y:n})}:void 0,q=m?(0,r.useCallback)((e,t)=>{const n=C.getState().nodeLookup.get(t).internals.userNode;m(e,n)},[]):void 0;return(0,o.jsx)(ys,{position:g,style:{...e,"--xy-minimap-background-color-props":"string"==typeof d?d:void 0,"--xy-minimap-mask-background-color-props":"string"==typeof u?u:void 0,"--xy-minimap-mask-stroke-color-props":"string"==typeof h?h:void 0,"--xy-minimap-mask-stroke-width-props":"number"==typeof f?f*R:void 0,"--xy-minimap-node-background-color-props":"string"==typeof i?i:void 0,"--xy-minimap-node-stroke-color-props":"string"==typeof n?n:void 0,"--xy-minimap-node-stroke-width-props":"number"==typeof l?l:void 0},className:ft(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:(0,o.jsxs)("svg",{width:z,height:O,viewBox:`${B} ${V} ${H} ${F}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:_,onClick:W,children:[x&&(0,o.jsx)("title",{id:Y,children:x}),(0,o.jsx)(qc,{onClick:q,nodeColor:i,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:a,nodeStrokeWidth:l,nodeComponent:c}),(0,o.jsx)("path",{className:"react-flow__minimap-mask",d:`M${B-L},${V-L}h${H+2*L}v${F+2*L}h${-H-2*L}z\n        M${k.x},${k.y}h${k.width}v${k.height}h${-k.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}function Qc(){var e;const{prefix:t}=it();return"undefined"!=typeof window&&window[t]&&Array.isArray(window[t].triggers)?window[t].triggers:(console.warn("Error accessing triggers data, using fallback"),(null===(e=at.poptics_ens_data)||void 0===e?void 0:e.triggers)||[])}Uc.displayName="MiniMap",(0,r.memo)(Uc),(0,r.memo)(function({nodeId:e,position:t,variant:n=Ia.Handle,className:i,style:a={},children:s,color:l,minWidth:c=10,minHeight:d=10,maxWidth:u=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:g,shouldResize:p,onResizeStart:m,onResize:y,onResizeEnd:v}){const x=fl(),b="string"==typeof e?e:x,w=ls(),S=(0,r.useRef)(null),C=n===Ia.Line?"right":"bottom-right",_=t??C,E=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(S.current&&b)return E.current||(E.current=function({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const i=jn(e);return{update:function({controlPosition:e,boundaries:a,keepAspectRatio:s,resizeDirection:l,onResizeStart:c,onResize:d,onResizeEnd:u,shouldResize:h}){let f={...Ba},g={...Va};const p=function(e){return{isHorizontal:e.includes("right")||e.includes("left"),isVertical:e.includes("bottom")||e.includes("top"),affectsX:e.includes("left"),affectsY:e.includes("top")}}(e);let m,y,v,x,b=null,w=[];const S=Zn().on("start",e=>{const{nodeLookup:o,transform:r,snapGrid:i,snapToGrid:a,nodeOrigin:s,paneDomNode:l}=n();if(m=o.get(t),!m)return;b=l?.getBoundingClientRect()??null;const{xSnapped:d,ySnapped:u}=Hi(e.sourceEvent,{transform:r,snapGrid:i,snapToGrid:a,containerBounds:b});f={width:m.measured.width??0,height:m.measured.height??0,x:m.position.x??0,y:m.position.y??0},g={...f,pointerX:d,pointerY:u,aspectRatio:f.width/f.height},y=void 0,m.parentId&&("parent"===m.extent||m.expandParent)&&(y=o.get(m.parentId),v=y&&"parent"===m.extent?function(e){return[[0,0],[e.measured.width,e.measured.height]]}(y):void 0),w=[],x=void 0;for(const[e,n]of o)if(n.parentId===t&&(w.push({id:e,position:{...n.position},extent:n.extent}),"parent"===n.extent||n.expandParent)){const e=Ha(n,m,n.origin??s);x=x?[[Math.min(e[0][0],x[0][0]),Math.min(e[0][1],x[0][1])],[Math.max(e[1][0],x[1][0]),Math.max(e[1][1],x[1][1])]]:e}c?.(e,{...f})}).on("drag",e=>{const{transform:t,snapGrid:r,snapToGrid:i,nodeOrigin:c}=n(),u=Hi(e.sourceEvent,{transform:t,snapGrid:r,snapToGrid:i,containerBounds:b}),S=[];if(!m)return;const{x:C,y:_,width:E,height:k}=f,N={},M=m.origin??c,{width:P,height:A,x:j,y:z}=function(e,t,n,o,r,i,a,s){let{affectsX:l,affectsY:c}=t;const{isHorizontal:d,isVertical:u}=t,h=d&&u,{xSnapped:f,ySnapped:g}=n,{minWidth:p,maxWidth:m,minHeight:y,maxHeight:v}=o,{x,y:b,width:w,height:S,aspectRatio:C}=e;let _=Math.floor(d?f-e.pointerX:0),E=Math.floor(u?g-e.pointerY:0);const k=w+(l?-_:_),N=S+(c?-E:E),M=-i[0]*w,P=-i[1]*S;let A=$a(k,p,m),j=$a(N,y,v);if(a){let e=0,t=0;l&&_<0?e=Ra(x+_+M,a[0][0]):!l&&_>0&&(e=Ta(x+k+M,a[1][0])),c&&E<0?t=Ra(b+E+P,a[0][1]):!c&&E>0&&(t=Ta(b+N+P,a[1][1])),A=Math.max(A,e),j=Math.max(j,t)}if(s){let e=0,t=0;l&&_>0?e=Ta(x+_,s[0][0]):!l&&_<0&&(e=Ra(x+k,s[1][0])),c&&E>0?t=Ta(b+E,s[0][1]):!c&&E<0&&(t=Ra(b+N,s[1][1])),A=Math.max(A,e),j=Math.max(j,t)}if(r){if(d){const e=$a(k/C,y,v)*C;if(A=Math.max(A,e),a){let e=0;e=!l&&!c||l&&!c&&h?Ta(b+P+k/C,a[1][1])*C:Ra(b+P+(l?_:-_)/C,a[0][1])*C,A=Math.max(A,e)}if(s){let e=0;e=!l&&!c||l&&!c&&h?Ra(b+k/C,s[1][1])*C:Ta(b+(l?_:-_)/C,s[0][1])*C,A=Math.max(A,e)}}if(u){const e=$a(N*C,p,m)/C;if(j=Math.max(j,e),a){let e=0;e=!l&&!c||c&&!l&&h?Ta(x+N*C+M,a[1][0])/C:Ra(x+(c?E:-E)*C+M,a[0][0])/C,j=Math.max(j,e)}if(s){let e=0;e=!l&&!c||c&&!l&&h?Ra(x+N*C,s[1][0])/C:Ta(x+(c?E:-E)*C,s[0][0])/C,j=Math.max(j,e)}}}E+=E<0?j:-j,_+=_<0?A:-A,r&&(h?k>N*C?E=(La(l,c)?-_:_)/C:_=(La(l,c)?-E:E)*C:d?(E=_/C,c=l):(_=E*C,l=c));const z=l?x+_:x,O=c?b+E:b;return{width:w+(l?-_:_),height:S+(c?-E:E),x:i[0]*_*(l?-1:1)+z,y:i[1]*E*(c?-1:1)+O}}(g,p,u,a,s,M,v,x),O=P!==E,D=A!==k,I=j!==C&&O,R=z!==_&&D;if(!(I||R||O||D))return;if((I||R||1===M[0]||1===M[1])&&(N.x=I?j:f.x,N.y=R?z:f.y,f.x=N.x,f.y=N.y,w.length>0)){const e=j-C,t=z-_;for(const n of w)n.position={x:n.position.x-e+M[0]*(P-E),y:n.position.y-t+M[1]*(A-k)},S.push(n)}if((O||D)&&(N.width=!O||l&&"horizontal"!==l?f.width:P,N.height=!D||l&&"vertical"!==l?f.height:A,f.width=N.width,f.height=N.height),y&&m.expandParent){const e=M[0]*(N.width??0);N.x&&N.x<e&&(f.x=e,g.x=g.x-(N.x-e));const t=M[1]*(N.height??0);N.y&&N.y<t&&(f.y=t,g.y=g.y-(N.y-t))}const T=function({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:i}){const a=e-t,s=n-o,l=[a>0?1:a<0?-1:0,s>0?1:s<0?-1:0];return a&&r&&(l[0]=-1*l[0]),s&&i&&(l[1]=-1*l[1]),l}({width:f.width,prevWidth:E,height:f.height,prevHeight:k,affectsX:p.affectsX,affectsY:p.affectsY}),$={...f,direction:T},L=h?.(e,$);!1!==L&&(d?.(e,$),o(N,S))}).on("end",e=>{u?.(e,{...f}),r?.({...f})});i.call(S)},destroy:function(){i.on(".drag",null)}}}({domNode:S.current,nodeId:b,getStoreItems:()=>{const{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:r,domNode:i}=w.getState();return{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:r,paneDomNode:i}},onChange:(e,t)=>{const{triggerNodeChanges:n,nodeLookup:o,parentLookup:r,nodeOrigin:i}=w.getState(),a=[],s={x:e.x,y:e.y},l=o.get(b);if(l&&l.expandParent&&l.parentId){const t=l.origin??i,n=e.width??l.measured.width??0,c=e.height??l.measured.height??0,d=va([{id:l.id,parentId:l.parentId,rect:{width:n,height:c,...Bi({x:e.x??l.position.x,y:e.y??l.position.y},{width:n,height:c},l.parentId,o,t)}}],o,r,i);a.push(...d),s.x=e.x?Math.max(t[0]*n,e.x):void 0,s.y=e.y?Math.max(t[1]*c,e.y):void 0}if(void 0!==s.x&&void 0!==s.y){const e={id:b,type:"position",position:{...s}};a.push(e)}if(void 0!==e.width&&void 0!==e.height){const t={id:b,type:"dimensions",resizing:!0,setAttributes:!g||("horizontal"===g?"width":"height"),dimensions:{width:e.width,height:e.height}};a.push(t)}for(const e of t){const t={...e,type:"position"};a.push(t)}n(a)},onEnd:({width:e,height:t})=>{const n={id:b,type:"dimensions",resizing:!1,dimensions:{width:e,height:t}};w.getState().triggerNodeChanges([n])}})),E.current.update({controlPosition:_,boundaries:{minWidth:c,minHeight:d,maxWidth:u,maxHeight:h},keepAspectRatio:f,resizeDirection:g,onResizeStart:m,onResize:y,onResizeEnd:v,shouldResize:p}),()=>{E.current?.destroy()}},[_,c,d,u,h,f,m,y,v,p]);const k=_.split("-"),N=n===Ia.Line?"borderColor":"backgroundColor",M=l?{...a,[N]:l}:a;return(0,o.jsx)("div",{className:ft(["react-flow__resize-control","nodrag",...k,n,i]),ref:S,style:M,children:s})});const Jc=e=>{switch(e){case"trigger":return"#1890ff";case"condition":return"#faad14";case"end":return"#201000";default:return"#52c41a"}},ed=(e,t)=>e.map(e=>{var n;const o={...e};if("receiverType"===e.name&&(null==t?void 0:t.email_receivers)&&(o.props={...e.props,options:t.email_receivers}),"delayUnit"===e.name&&(o.props={...e.props}),"delayCondition"===e.name&&(null==t?void 0:t.delay_dependencies)){const r=(null===(n=e.props)||void 0===n?void 0:n.options)||[],i=t.delay_dependencies||[];o.props={...e.props,options:[...r,...i]}}return o}),td=({status:e,onChange:t,loading:n})=>{const r="publish"===e;return(0,o.jsx)(a.Ay,{variant:"outlined",onClick:()=>t(!r),loading:n,disabled:n,icon:(0,o.jsx)(r?nd:od,{}),children:r?"Active":"Inactive"})};function nd(){return(0,o.jsx)("span",{className:"anticon",children:(0,o.jsxs)("svg",{width:"33",height:"18",viewBox:"0 0 33 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"switch-icon switch-icon--on",children:[(0,o.jsx)("rect",{width:"32.5",height:"20",rx:"10",className:"switch-background"}),(0,o.jsx)("circle",{cx:"22",cy:"10",r:"7.5",fill:"white"})]})})}function od(){return(0,o.jsx)("span",{className:"anticon",children:(0,o.jsxs)("svg",{width:"33",height:"18",viewBox:"0 0 33 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("rect",{width:"32.5",height:"20",rx:"10",fill:"#F3F4F8"}),(0,o.jsx)("circle",{cx:"10",cy:"10",r:"7.5",fill:"white"})]})})}const{Text:rd}=_.A,id=({flowName:e,flowStatus:t,onFlowNameChange:n,isLoading:i})=>{const[s,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(e),h=(0,r.useRef)(null),f=async()=>{c.trim()&&n(c),l(!1)};return(0,o.jsx)("div",{className:"flow-name-section",children:(0,o.jsxs)("div",s?{className:"flow-name-edit-mode",children:[(0,o.jsx)(u.A,{ref:h,value:c,onChange:e=>d(e.target.value),onPressEnter:f,onBlur:f,variant:"outlined",placeholder:"Enter flow name",className:"flow-name-input",size:"middle",disabled:i}),(0,o.jsx)("div",{className:"flow-name-actions",children:(0,o.jsx)(a.Ay,{size:"small",onClick:()=>{d(e),l(!1)},children:"Cancel"})})]}:{className:"flow-name-display",children:[(0,o.jsx)(rd,{className:"flow-name",strong:!0,children:e}),(0,o.jsx)(S.A,{color:"publish"===t?"success":"default",children:t.charAt(0).toUpperCase()+t.slice(1)}),(0,o.jsx)(a.Ay,{type:"default",size:"small",icon:(0,o.jsx)(Te,{}),onClick:()=>{l(!0),d(e),setTimeout(()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.focus()},0)},className:"edit-button",disabled:i})]})})},ad=({flowName:e,onFlowNameChange:t,flowData:n,flowStatus:r,setFlowStatus:i,reactFlowInstanceRef:s})=>{const{editFlow:l,isFlowSaving:c}=ht();return(0,o.jsxs)("div",{className:"top-navbar",children:[(0,o.jsxs)("div",{className:"top-navbar__left",children:[(0,o.jsx)(a.Ay,{type:"text",icon:(0,o.jsx)(We,{}),onClick:()=>window.history.back()}),(0,o.jsx)(id,{flowName:e,flowStatus:r,onFlowNameChange:t,isLoading:c()})]}),(0,o.jsx)("div",{className:"top-navbar__right",children:(0,o.jsxs)(v.A,{children:[(0,o.jsx)(td,{status:r,onChange:async e=>{const t=e?"publish":"draft";await l(n.id,{...n,status:t},!1),i(t)},loading:c()}),(0,o.jsx)(a.Ay,{type:"primary",onClick:async()=>{if(!s.current)return void console.error("React Flow instance or flow ID not available");const{getNodes:t,getEdges:o}=s.current,i=t(),a=o(),c=((e,t,n,o="draft")=>({name:e,status:o,flow_config:{nodes:t.map(e=>{var t,n,o,r,i;const a=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.label)||"";switch(e.type){case"trigger":return{id:e.id,type:"trigger",name:"trigger",data:{...e.data},position:e.position};case"condition":return{id:e.id,type:"condition",name:"condition",data:{field:(null===(n=e.data)||void 0===n?void 0:n.conditionField)||"",operator:(null===(o=e.data)||void 0===o?void 0:o.operator)||"==",value:(null===(r=e.data)||void 0===r?void 0:r.value)||"",...e.data},position:e.position};case"action":return{id:e.id,type:"action",name:"send_email"===a?"email":"delay",data:{actionType:(null===(i=e.data)||void 0===i?void 0:i.actionType)||"",...e.data},position:e.position};case"end":return{id:e.id,type:"end",name:"end",data:{...e.data},position:e.position};default:return{id:e.id,type:e.type||"action",name:a,data:{...e.data},position:e.position}}}),edges:n.map(e=>{const{source:t,target:n,sourceHandle:o,targetHandle:r,data:i,label:a,...s}=e;return{...s,source:t,target:n,...o?{sourceHandle:o}:{},...r?{targetHandle:r}:{},...i?{data:i}:{},...a?{label:a}:{}}})}}))(e,i,a,r);try{await l(null==n?void 0:n.id,c,!1)}catch(t){console.error("Error saving flow:",t)}},loading:c(),disabled:c(),children:"Save Now"})]})})]})},{confirm:sd}=g.A,ld=({id:e,data:t,isConnectable:n,type:i})=>{const[a,s]=(0,r.useState)(!1),l=i||"end",c="end"!==l,d="trigger"!==l,u="condition"===l,h="trigger"!==l&&"end"!==l,f=(e=>{switch(e){case"trigger":return"Trigger Event";case"condition":return"Conditional";case"end":return"End Automation";case"action":return"Action";default:return"End"}})(l);return(0,o.jsxs)("div",{className:`flow-node flow-node--${l}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[h&&a&&(0,o.jsx)("button",{className:"node-delete-button",onClick:n=>{n.stopPropagation(),sd({title:"Do you want to delete this step?",icon:(0,o.jsx)(Le,{}),content:"",onOk(){t.onDeleteNode&&t.onDeleteNode(e)}})},"aria-label":"Delete node",children:(0,o.jsx)(je,{})}),d&&(0,o.jsx)(pl,{type:"target",position:si.Top,isConnectable:!!n}),(0,o.jsxs)("div",{className:"flow-node__content",children:[(0,o.jsx)("div",{className:"flow-node__icon",children:(()=>{switch(l){case"trigger":return(0,o.jsx)(Ee,{});case"condition":return(0,o.jsx)(Ce,{});case"end":default:return(0,o.jsx)(Ve,{});case"action":return"send_email"===t.actionType?(0,o.jsx)(Ke,{}):(0,o.jsx)(Pe,{})}})()}),(0,o.jsxs)("div",{className:"flow-node__details",children:[(0,o.jsx)("div",{className:"flow-node__title",children:f}),(null==t?void 0:t.subtitle)&&(0,o.jsx)("div",{className:"flow-node__subtitle",children:t.subtitle})]})]}),c&&!u&&(0,o.jsx)(pl,{type:"source",position:si.Bottom,isConnectable:!!n}),u&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(pl,{id:"false",type:"source",position:si.Left,isConnectable:!!n,style:{background:"#EF4444",left:-8}}),(0,o.jsx)(pl,{id:"true",type:"source",position:si.Right,isConnectable:!!n,style:{background:"#22B855",right:-8}})]})]})},cd=({id:e,sourceX:t,sourceY:n,targetX:r,targetY:i,sourcePosition:a,targetPosition:s,style:l={},label:c,data:d,markerEnd:u})=>{const[h,f,g]=aa({sourceX:t,sourceY:n,sourcePosition:a,targetX:r,targetY:i,targetPosition:s}),p=null==d?void 0:d.onPlusClick,m=null==d?void 0:d.condition,y={...l};"true"===m?(y.stroke="#22B855",y.strokeWidth=1):"false"===m&&(y.stroke="#EF4444",y.strokeWidth=1);const v=p?-20:0,x=c?25:0;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Il,{path:h,markerEnd:u,style:y}),c&&(0,o.jsx)(Nc,{children:(0,o.jsx)("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${f}px, ${g+v}px)`,background:"true"===m?"#22B855":"false"===m?"#EF4444":"#ffffff",color:m?"#ffffff":"#000000",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:500,pointerEvents:"all",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",zIndex:1001},children:c})}),p&&(0,o.jsx)(Nc,{children:(0,o.jsx)("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${f}px, ${g+x}px)`,pointerEvents:"all",zIndex:1e3},children:(0,o.jsx)("button",{className:"notif-flow-edge-plus-button",onClick:t=>{t.stopPropagation(),p(e)},"aria-label":"Add condition",children:(0,o.jsx)(Je,{})})})})]})},dd={trigger:e=>(0,o.jsx)(ld,{...e,type:"trigger"}),action:e=>(0,o.jsx)(ld,{...e,type:"action"}),condition:e=>(0,o.jsx)(ld,{...e,type:"condition"}),end:e=>(0,o.jsx)(ld,{...e,type:"end"})},ud=({onNodeClick:e,onPlusButtonClick:t,onInit:n})=>{const[i,a,s]=function(){const[e,t]=(0,r.useState)([]),n=(0,r.useCallback)(e=>t(t=>$s(e,t)),[]);return[e,t,n]}(),[l,c,d]=function(){const[e,t]=(0,r.useState)([]),n=(0,r.useCallback)(e=>t(t=>Ls(e,t)),[]);return[e,t,n]}();(0,r.useCallback)(e=>{t(e)},[t]);const u=(0,r.useCallback)((t,n)=>{"end"!==n.type&&"trigger"!==n.type&&e(n)},[e]),h=(0,r.useCallback)(e=>{const t=l.filter(t=>t.target===e),n=l.filter(t=>t.source===e),o=[];t.forEach(e=>{n.forEach(t=>{var n;const r=i.find(t=>t.id===e.source),a="condition"===(null==r?void 0:r.type);o.push({id:`edge_${e.source}_${t.target}`,source:e.source,target:t.target,type:e.type||"default",...a&&e.sourceHandle?{sourceHandle:e.sourceHandle}:{},markerEnd:e.markerEnd,...e.label?{label:e.label}:{},data:{...(null===(n=e.data)||void 0===n?void 0:n.condition)?{condition:e.data.condition}:{}}})})}),a(t=>t.filter(t=>t.id!==e)),c(t=>[...t.filter(t=>t.source!==e&&t.target!==e),...o])},[l,i,a,c]),f=i.map(e=>({...e,data:{...e.data,onDeleteNode:h}})),g={default:cd,smoothstep:cd,straight:cd,curved:cd},p=l.map(e=>{var n,o;return{...e,data:{...e.data,onPlusClick:t,...(null===(n=e.data)||void 0===n?void 0:n.condition)?{condition:e.data.condition}:{}},...(null===(o=e.data)||void 0===o?void 0:o.condition)&&!e.label?{label:e.data.condition}:{}}}),m=(0,r.useCallback)(e=>{n&&n(e)},[n]);return(0,o.jsxs)(Ec,{nodes:f,edges:p,onNodeClick:u,onNodesChange:s,onEdgesChange:d,nodeTypes:dd,edgeTypes:g,fitView:!0,onInit:m,connectionLineType:ii.SmoothStep,defaultEdgeOptions:{type:"default",markerEnd:{type:ai.ArrowClosed}},children:[(0,o.jsx)(Dc,{}),(0,o.jsx)(Fc,{})]})},hd=({onInsert:e,availableConditions:t})=>{const[n,i]=(0,r.useState)("action");return(0,o.jsxs)("div",{className:"node-insertion-content",children:[(0,o.jsxs)(p.Ay.Group,{value:n,onChange:e=>i(e.target.value),className:"node-type-tabs",children:[(0,o.jsxs)(p.Ay.Button,{value:"action",className:"tab-button",children:["action"===n&&(0,o.jsx)(Ne,{className:"check-icon"}),"Action"]}),(0,o.jsxs)(p.Ay.Button,{value:"condition",className:"tab-button",children:["condition"===n&&(0,o.jsx)(Ne,{className:"check-icon"}),"Condition"]})]}),(0,o.jsx)("div",{className:"node-type-header",children:(0,o.jsx)("h4",{children:"action"===n?"Available Actions":"Available Conditions"})}),(0,o.jsxs)("div",{className:"node-options-grid",children:["action"===n&&(0,o.jsx)(o.Fragment,{children:st.map(t=>(0,o.jsx)("div",{className:"node-option",onClick:()=>null==e?void 0:e({type:"action",value:t.value,label:t.label}),children:t.label},t.value))}),"condition"===n&&(0,o.jsx)(o.Fragment,{children:t.map(t=>(0,o.jsx)("div",{className:"node-option",onClick:()=>null==e?void 0:e({type:"condition",value:t.value,label:t.label}),children:t.label},t.value))})]})]})},fd=({label:e,tooltip:t,required:n=!1,className:r=""})=>(0,o.jsxs)("span",{className:`form-field-label ${r}`,style:{display:"flex",alignItems:"center"},children:[e,(()=>{if(!t)return null;const e="question"===t.icon?tt:Ze;return(0,o.jsx)(C.A,{title:t.title,placement:t.placement||"top",trigger:t.trigger||"hover",children:(0,o.jsx)(e,{className:"form-field-tooltip-icon",style:{marginLeft:4,color:"#8c8c8c",cursor:"pointer",fontSize:"13px"}})})})()]}),gd=({customizationSettings:e})=>{const t=(null==e?void 0:e.formFields)||[],n=null==e?void 0:e.triggerData,i=ed(t,n);return(0,o.jsx)("div",{className:"delay-action-form",children:(0,o.jsx)("div",{className:"delay-form-row",children:i.map((e,t)=>(0,o.jsx)(d.A.Item,{name:e.name,label:(0,o.jsx)(fd,{label:e.label,tooltip:e.tooltip,required:e.required}),rules:e.rules,className:"delay-form-field",children:r.createElement(e.component,e.props||{})},t))})})},pd=({triggerType:e,onVariableSelect:t})=>{var n;const r=Qc(),i=(null===(n=null==r?void 0:r.find(t=>t.trigger_value===e))||void 0===n?void 0:n.trigger_data)||[];return 0===i.length?(0,o.jsx)("div",{className:"dynamic-variables-empty",children:"No variables available for this trigger"}):(0,o.jsx)("div",{className:"dynamic-variables-container",children:i.map(e=>(0,o.jsx)(C.A,{title:`Insert ${e.label} variable`,children:(0,o.jsx)(a.Ay,{className:"dynamic-variable-chip",onClick:()=>t(`{%${e.value}%}`),children:`{%${e.value}%}`})},e.value))})},md=({customizationSettings:e,selectedTrigger:t,setQuillRef:n,onVariableInsert:i})=>{const a=(null==e?void 0:e.triggerData)||{};if(!a)return null;const s=ed(e.formFields||[],a);return(0,o.jsx)("div",{className:"notification-flow-customization-form-field",children:s.map(e=>"richText"===e.component?(0,o.jsxs)("div",{className:"notification-flow-email-body",children:[(0,o.jsx)(d.A.Item,{name:e.name,label:e.label,rules:e.rules,className:"notif-flow-rich-text-form-item",children:(0,o.jsx)(N,{theme:"snow",...e.props||{},ref:e=>n(e)})}),(0,o.jsxs)("div",{className:"email-variable-section",children:[(0,o.jsx)("div",{className:"email-variable-header",children:(0,o.jsx)("p",{children:"Variables for Email Body Content"})}),(0,o.jsx)(pd,{triggerType:t,onVariableSelect:i})]})]},e.name):(0,o.jsx)(d.A.Item,{name:e.name,label:e.label,rules:e.rules,children:r.createElement(e.component,e.props||{})},e.name))})},yd=({nodeData:e,customizationSettings:t,selectedTrigger:n,quillRef:r,setQuillRef:i,onVariableInsert:a})=>{if(!e)return null;const s=e.actionType||(null==t?void 0:t.actionType);return s?"add_delay"===s?(0,o.jsx)(gd,{customizationSettings:t}):(0,o.jsx)(md,{customizationSettings:t,selectedTrigger:n,quillRef:r,setQuillRef:i,onVariableInsert:a}):null},vd=({customizationSettings:e})=>{if(!e)return null;const{type:t}=e,n=(e=>{switch(e){case"number":return ct;case"string":default:return dt;case"date":return ut}})(t);return(0,o.jsx)("div",{className:"condition-form",children:(0,o.jsxs)("div",{className:"condition-form-row",children:[(0,o.jsx)(d.A.Item,{name:"operator",label:"Operator",className:"condition-operator",rules:[{required:!0,message:"Please select an operator"}],children:(0,o.jsx)(m.A,{options:n,getPopupContainer:e=>e.parentNode})}),(0,o.jsx)(d.A.Item,"date"===t?{name:"dateValue",label:"Value",className:"condition-value",rules:[{required:!0,message:"Please select a date"}],children:(0,o.jsx)(s.A,{style:{width:"100%"},getPopupContainer:e=>e.parentNode})}:{name:"value",label:"Value",className:"condition-value",rules:[{required:!0,message:"Please enter a value"}],children:(0,o.jsx)(u.A,{type:"number"===t?"number":"text",style:{width:"100%"}})})]})})},xd=({visible:e,onClose:t,nodeType:n,nodeData:i,onSave:a,customizationSettings:s,selectedTrigger:c,mode:u="edit",onInsert:h,availableConditions:f=[]})=>{const[g]=d.A.useForm(),[p,m]=(0,r.useState)(null),{handleVariableInsert:y}=(e=>({handleVariableInsert:(0,r.useCallback)(t=>{if(e){const n=e.getEditor(),o=n.getSelection(),r=o?o.index:0;n.insertText(r,t),n.setSelection(r+t.length)}},[e])}))(p),{initializeForm:v}=((e,t,n,o,i)=>({initializeForm:(0,r.useCallback)(()=>{if(o&&"edit"===i){e.resetFields();const o={label:(null==t?void 0:t.label)||"",subtitle:(null==t?void 0:t.subtitle)||"",operator:(null==t?void 0:t.operator)||"=",value:(null==t?void 0:t.value)||"",..."date"===(null==n?void 0:n.type)&&(null==t?void 0:t.value)?{dateValue:t.value?k(t.value,"YYYY-MM-DD"):null}:{}};t&&Object.keys(t).forEach(e=>{"label"!==e&&"subtitle"!==e&&(o[e]=t[e])}),e.setFieldsValue(o)}},[o,t,n,e,i])}))(g,i,s,e,u),{handleSave:x}=((e,t,n,o,i)=>({handleSave:(0,r.useCallback)(()=>{e.validateFields().then(e=>{var r,a,s;if("date"===(null==n?void 0:n.type)&&e.dateValue&&(e.value=k(e.dateValue).format("YYYY-MM-DD"),delete e.dateValue),"condition"===t&&n){const t=n.label||"",o=(e=>{switch(e){case"equal":return"=";case"not_equal":return"≠";case"greater_then":return">";case"greater_equal":return"≥";case"less_then":return"<";case"less_equal":return"≤";case"before":return"before";case"after":return"after";default:return e}})(e.operator),r="date"===(null==n?void 0:n.type)?new Date(e.value).toLocaleDateString():e.value||"";e.subtitle=`${t} ${o} ${r}`}if("action"===t){const t=(null==o?void 0:o.actionType)||"";if("add_delay"===t&&e.delay&&e.delayUnit){let t=`Wait for ${e.delay} ${e.delayUnit}`;if(e.delayCondition&&e.delayDependency){const o=(null===(s=null===(a=null===(r=null==n?void 0:n.triggerData)||void 0===r?void 0:r.delay_dependencies)||void 0===a?void 0:a.find(t=>t.value===e.delayDependency))||void 0===s?void 0:s.label)||e.delayDependency;t+=` ${e.delayCondition} ${o}`}e.subtitle=t}else"send_email"===t&&e.subject&&(e.subtitle=`Subject: ${e.subject.substring(0,30)}${e.subject.length>30?"...":""}`)}null==i||i(e)})},[e,t,n,o,i])}))(g,n,s,i,a);(0,r.useEffect)(()=>{v()},[e,i,s,g,u]);const b="send_email"===(null==i?void 0:i.actionType)?520:400;return(0,o.jsx)(l.A,{open:e,width:b,zIndex:99999,title:(0,o.jsx)(bd,{mode:u,customizationSettings:s,nodeType:n}),placement:"right",onClose:t,className:"node-sidebar "+("insert"===u?"insert-mode":"edit-mode"),footer:(0,o.jsx)(wd,{mode:u,onClose:t,onSave:x}),children:"insert"===u?(0,o.jsx)(hd,{onInsert:h,availableConditions:f}):(0,o.jsx)(Sd,{form:g,nodeType:n,nodeData:i,customizationSettings:s,selectedTrigger:c,quillRef:p,setQuillRef:m,onVariableInsert:y})})},bd=({mode:e,customizationSettings:t,nodeType:n})=>"insert"===e?(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:"Add New Node"}):(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:["Edit ",null==t?void 0:t.label,(0,o.jsx)(i.A,{count:n&&n.slice(0,1).toUpperCase()+n.slice(1),style:{backgroundColor:`${Jc(n||"action")}16`,color:Jc(n||"action"),fontSize:"12px",fontWeight:"normal",borderRadius:"4px"}})]}),wd=({mode:e,onClose:t,onSave:n})=>(0,o.jsxs)("div",{className:"node-sidebar__footer",children:[(0,o.jsx)(a.Ay,{onClick:t,children:"Cancel"}),"edit"===e&&(0,o.jsx)(a.Ay,{type:"primary",onClick:n,children:"Save"})]}),Sd=({form:e,nodeType:t,nodeData:n,customizationSettings:r,selectedTrigger:i,quillRef:a,setQuillRef:s,onVariableInsert:l})=>(0,o.jsxs)(d.A,{form:e,layout:"vertical",initialValues:{},children:["condition"===t&&(0,o.jsx)(vd,{customizationSettings:r}),"action"===t&&(0,o.jsx)(yd,{nodeData:n,customizationSettings:r,selectedTrigger:i,quillRef:a,setQuillRef:s,onVariableInsert:l})]}),Cd=()=>(0,o.jsxs)("div",{className:"builder-page-skeleton",children:[(0,o.jsxs)("div",{className:"top-navbar",children:[(0,o.jsxs)("div",{className:"top-navbar__left",children:[(0,o.jsx)(a.Ay,{type:"text",icon:(0,o.jsx)(We,{}),disabled:!0}),(0,o.jsx)(y.A.Input,{active:!0,style:{width:200}})]}),(0,o.jsx)("div",{className:"top-navbar__right",children:(0,o.jsxs)(v.A,{children:[(0,o.jsx)(y.A.Button,{active:!0}),(0,o.jsx)(y.A.Button,{active:!0})]})})]}),(0,o.jsx)("div",{className:"builder-page__body",style:{height:"calc(100vh - 64px)",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,o.jsx)(x.A,{size:"large",tip:"Loading flow data..."})})]}),_d=({flowId:e})=>{var t;const[n,i]=(0,r.useState)("Untitled"),[a,s]=(0,r.useState)("draft"),[l,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(null),[h,f]=(0,r.useState)(""),[g,p]=(0,r.useState)(null),m=(0,r.useRef)(null),{getFlowById:y,isFlowLoading:v}=ht(),{sidebarVisible:x,sidebarMode:b,edgeToSplit:w,setSidebarVisible:S,setSidebarMode:C,setEdgeToSplit:_,handleSidebarClose:E,handleNodeClick:k,handlePlusButtonClick:N}=(e=>{const[t,n]=(0,r.useState)(!1),[o,i]=(0,r.useState)("edit"),[a,s]=(0,r.useState)(null),l=(0,r.useCallback)(t=>{e(t),i("edit"),n(!0)},[e]),c=(0,r.useCallback)(e=>{e&&s(e),i("insert"),n(!0)},[]),d=(0,r.useCallback)(()=>{n(!1),"insert"===o&&s(null)},[o]);return{sidebarVisible:t,sidebarMode:o,edgeToSplit:a,setSidebarVisible:n,setSidebarMode:i,setEdgeToSplit:s,handleSidebarClose:d,handleNodeClick:l,handlePlusButtonClick:c}})(u),{loadFlowData:M}=((e,t,n,o,i,a,s)=>({loadFlowData:(0,r.useCallback)(async()=>{if(e)try{const{data:r}=await t(e);if(r&&(n(r.name||"Untitled"),o(r.trigger||""),i(r.status||"draft"),a(r),r.flow_config&&s)){const{setNodes:e,setEdges:t}=s;Array.isArray(r.flow_config.nodes)&&e(r.flow_config.nodes),Array.isArray(r.flow_config.edges)&&t(r.flow_config.edges.map(e=>{var t,n;return"true"===(null===(t=e.data)||void 0===t?void 0:t.condition)?{...e,sourceHandle:"true"}:"false"===(null===(n=e.data)||void 0===n?void 0:n.condition)?{...e,sourceHandle:"false"}:e}))}}catch(e){console.error("Error loading flow:",e)}},[e,t,n,o,i,a,s])}))(e,y,i,f,s,c,g),{handleInsertNode:P}=((e,t,n,o,i,a)=>{const s=Qc(),l=(0,r.useCallback)((e,t,n,o)=>({id:e,type:t.type,position:n,data:{label:"condition"===t.type?(null==o?void 0:o.value)||"Conditional":t.value,subtitle:t.label,..."condition"===t.type&&{operator:"=",value:"",conditionField:t.value},..."action"===t.type&&{actionType:t.value}}}),[]),c=(0,r.useCallback)((e,t,n)=>{var o;return{id:`edge_${e.id}-${t}`,source:e.id,target:t,type:n.type||"default",markerEnd:n.markerEnd,...n.sourceHandle&&{sourceHandle:n.sourceHandle},data:{...(null===(o=n.data)||void 0===o?void 0:o.condition)&&{condition:n.data.condition}}}},[]),d=(0,r.useCallback)((t,n,o,r,i,a=300,s=180)=>{var l;const{getNodes:c,setNodes:d,setEdges:u}=e.current,h={...n,position:{x:t.position.x+a,y:t.position.y+s}},f={id:`end_${(null===(l=c())||void 0===l?void 0:l.length)+1}`,type:"end",position:{x:t.position.x-a,y:t.position.y+s},data:{label:"End Flow",subtitle:"Automation stops here"}},g={id:`edge_${t.id}-${n.id}_true`,source:t.id,sourceHandle:"true",target:n.id,type:"smoothstep",markerEnd:{type:ai.ArrowClosed},label:"True",data:{condition:"true",conditionInfo:i?{field:i.label,operator:"=",value:""}:void 0}},p={id:`edge_${t.id}-${f.id}_false`,source:t.id,sourceHandle:"false",target:f.id,type:"smoothstep",markerEnd:{type:ai.ArrowClosed},label:"false",data:{condition:"false",conditionInfo:i?{field:i.label,operator:"=",value:""}:void 0}};d([...c().map(e=>e.id===n.id?h:e),t,f]),u(e=>[...e.filter(e=>e.id!==r),o,g,p])},[e]),u=(0,r.useCallback)((t,n,o,r,i,a=180)=>{var s,l,c;const{getNodes:d,setNodes:u,setEdges:h}=e.current,f={id:`edge_${t.id}-${n.id}`,source:t.id,target:n.id,type:"smoothstep",markerEnd:i.markerEnd,...(null===(s=i.data)||void 0===s?void 0:s.condition)&&{label:null===(l=i.data)||void 0===l?void 0:l.condition},data:{...(null===(c=i.data)||void 0===c?void 0:c.condition)&&{condition:i.data.condition}}},g={...n,position:{x:n.position.x,y:t.position.y+a}};u([...d().map(e=>e.id===n.id?g:e),t]),h(e=>[...e.filter(e=>e.id!==r),o,f])},[e]);return{handleInsertNode:(0,r.useCallback)(r=>{var h,f;if(!e.current||!t)return console.error("React Flow instance or edge not available"),i(!1),void a(null);const{getNodes:g,getEdges:p}=e.current,m=p().find(e=>e.id===t);if(!m)return console.error("Edge not found:",t),i(!1),void a(null);const y=g().find(e=>e.id===m.source),v=g().find(e=>e.id===m.target);if(!y||!v)return console.error("Source or target node not found"),i(!1),void a(null);const x=(y.position.x+v.position.x)/2,b=y.position.y+180,w=(null===(h=s.find(e=>""===e.trigger_value))||void 0===h?void 0:h.conditional_dependencies)||[];let S;"condition"===r.type&&(S=w.find(e=>e.value===r.value));const C=`node_${(null===(f=g())||void 0===f?void 0:f.length)+1}`,_=l(C,r,{x,y:b},S),E=c(y,C,m);"condition"===r.type?d(_,v,E,t,S,300,180):u(_,v,E,t,m,180),n(_),o("edit"),i(!0),a(null)},[e,t,s,l,c,d,u,n,o,i,a])}})(m,w,u,C,S,_);(0,r.useEffect)(()=>{e&&M()},[e]);const A=Qc(),j=(null===(t=A.find(e=>e.trigger_value===h))||void 0===t?void 0:t.conditional_dependencies)||[],z=(0,r.useCallback)(()=>h?A.find(e=>e.trigger_value===h):null,[h,A]),O=(0,r.useCallback)(()=>{if(!d)return null;if("condition"===d.type){const e=d.data.conditionField||"";return j.find(t=>t.value===e)||null}if("action"===d.type){const e=d.data.actionType,t=z();return{type:"action",actionType:e,...(e=>{if(e)return lt[e]})(e),triggerData:t}}return null},[d,j,z]),D=(0,r.useCallback)(e=>{if(d&&m.current){const{setNodes:t}=m.current;t(t=>t.map(t=>t.id===d.id?{...t,data:{...t.data,...e,..."action"===t.type&&{actionType:t.data.actionType}}}:t)),S(!1),u(null)}},[d,S,u]),I=(0,r.useCallback)(e=>{if(p(e),m.current=e,null==l?void 0:l.flow_config){const{setNodes:t,setEdges:n}=e;Array.isArray(l.flow_config.nodes)&&t(l.flow_config.nodes),Array.isArray(l.flow_config.edges)&&n(l.flow_config.edges)}},[l]);return v()?(0,o.jsx)(Cd,{}):(0,o.jsxs)("div",{className:"builder-page",children:[(0,o.jsx)(ad,{flowName:n,onFlowNameChange:i,flowData:l,flowStatus:a,setFlowStatus:s,reactFlowInstanceRef:m}),(0,o.jsxs)("div",{className:"builder-page__body",children:[(0,o.jsx)("div",{className:"builder-page__canvas",children:(0,o.jsx)(ud,{onNodeClick:k,onPlusButtonClick:N,onInit:I})}),(0,o.jsx)(xd,{visible:x,onClose:E,nodeType:d?(R=d.type,R?["trigger","end","condition","action"].includes(R)?R:"end":"action"):void 0,nodeData:null==d?void 0:d.data,onSave:D,customizationSettings:O()||{},selectedTrigger:h,mode:b,onInsert:P,availableConditions:j})]})]});var R},{Option:Ed}=m.A,kd=({open:e,onClose:t,onCreate:n})=>{const[r]=d.A.useForm(),{createFlow:i,isFlowCreating:s}=ht();it();const l=Qc(),c=()=>{r.resetFields(),t()};return(0,o.jsx)(g.A,{open:e,title:"Create New Automation",onCancel:c,footer:null,className:"create-flow-modal",children:(0,o.jsxs)(d.A,{form:r,layout:"vertical",children:[(0,o.jsx)(d.A.Item,{label:"Flow Name",name:"name",rules:[{required:!0,message:"Please enter flow name"}],children:(0,o.jsx)(u.A,{placeholder:"e.g. Welcome Email for Signup"})}),(0,o.jsx)(d.A.Item,{label:"Trigger Event",name:"trigger",rules:[{required:!0,message:"Please select a trigger"}],children:(0,o.jsx)(m.A,{placeholder:"Select a trigger",children:null==l?void 0:l.map(e=>(0,o.jsx)(Ed,{value:e.trigger_value,children:e.trigger_label},e.trigger_value))})}),(0,o.jsx)(d.A.Item,{className:"form-actions",children:(0,o.jsxs)(v.A,{className:"form-actions__buttons",children:[(0,o.jsx)(a.Ay,{onClick:c,children:"Cancel"}),(0,o.jsx)(a.Ay,{type:"primary",loading:s(),onClick:async()=>{try{const e=await r.validateFields(),o=(e=>{const t=Qc(),n=null==t?void 0:t.find(t=>t.trigger_value===e),o=(null==n?void 0:n.trigger_label)||"Trigger";return{nodes:[{id:"node_1",type:"trigger",position:{x:200,y:50},data:{label:`trigger: ${e}`,subtitle:o,triggerValue:e}},{id:"node_2",type:"end",position:{x:200,y:200},data:{label:"end_flow",subtitle:"End execution path"}}],edges:[{id:"edge_node_1-node_2",source:"node_1",target:"node_2",type:"smoothstep",markerEnd:{type:ai.ArrowClosed},data:{}}]}})(e.trigger),a={...e,flow_config:{nodes:o.nodes,edges:o.edges}},s=await i(a);r.resetFields(),t(),s&&s.id&&n(s.id)}catch(e){console.error("Error creating flow:",e)}},children:"Create"})]})})]})})},{Search:Nd}=u.A,{confirm:Md}=g.A,Pd=({onEdit:e})=>{const{notificationFlows:t,cloneFlow:n,deleteFlow:i,bulkDeleteFlows:s,editFlow:l,isFlowListLoading:d,isFlowSaving:u,statusCount:h,isFlowCloning:f,isFlowDeleting:g,fetchFlows:p,filterByStatus:y,searchFlows:v}=ht(),[x,C]=(0,r.useState)(!1),[_,E]=(0,r.useState)([]),k=[{title:"Automations",dataIndex:"name",key:"name"},{title:"Trigger",dataIndex:"trigger",key:"trigger",render:e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},{title:"Status",dataIndex:"status",key:"status",render:e=>(0,o.jsx)(S.A,{color:"publish"===e?"green":"red",children:e.charAt(0).toUpperCase()+e.slice(1)},e)},{title:"Draft/Published",dataIndex:"status",key:"status-toggle",render:(e,t)=>(0,o.jsx)(b.A,{checked:"publish"===e,onChange:e=>{const n=e?"publish":"draft";l(t.id,{...t,status:n},!0)}})},{title:"Action",key:"actions",dataIndex:"id",render:t=>(0,o.jsxs)("div",{className:"actions-cell",children:[(0,o.jsxs)(a.Ay,{type:"default",onClick:()=>e(t),children:[(0,o.jsx)(Fe,{}),"Edit"]}),(0,o.jsx)(c.A,{trigger:["click"],menu:{items:[{key:"clone",label:"Clone",icon:(0,o.jsx)(Oe,{}),onClick:()=>n(t)},{key:"delete",label:"Delete",icon:(0,o.jsx)(Ie,{}),onClick:()=>(e=>{Md({title:"Do you want to delete this flow?",icon:(0,o.jsx)(Le,{}),okText:"Delete",okButtonProps:{danger:!0},async onOk(){await i(e)}})})(t)}]},children:(0,o.jsx)(a.Ay,{icon:(0,o.jsx)(Ue,{style:{transform:"rotate(90deg)"}})})})]})}],N={selectedRowKeys:_,onChange:e=>{E(e)}};return(0,r.useEffect)(()=>{p()},[]),(0,o.jsxs)("div",{className:"automation-list",children:[(0,o.jsxs)("div",{className:"automation-list__header",children:[(0,o.jsxs)("div",{className:"filter-search-group",children:[(0,o.jsx)(m.A,{defaultValue:"",placeholder:"All",className:"status-filter-select",onChange:e=>y(e),options:[{value:"",label:"All"},{value:"publish",label:`Publish (${null==h?void 0:h.publish})`},{value:"draft",label:`Draft (${null==h?void 0:h.draft})`}],disabled:d()}),(0,o.jsx)(Nd,{placeholder:"Search",className:"automation-search",onSearch:e=>v(e),allowClear:!0,disabled:d()})]}),(0,o.jsx)(a.Ay,{type:"primary",onClick:()=>C(!0),icon:(0,o.jsx)(Je,{}),children:"New Automation"})]}),_.length>0&&(0,o.jsxs)("div",{className:"bulk-actions-bar",children:[(0,o.jsx)(a.Ay,{danger:!0,type:"primary",className:"bulk-delete-btn",onClick:()=>{_.length>0&&Md({title:"Delete Selected Items",icon:(0,o.jsx)(Le,{}),content:`Are you sure you want to delete ${_.length} item${1!==_.length?"s":""}?`,okText:"Delete",okButtonProps:{danger:!0},cancelText:"Cancel",async onOk(){try{await s(_),E([])}catch(e){console.error("Bulk delete failed:",e)}}})},children:"Bulk Delete"}),(0,o.jsxs)("span",{className:"selected-count",children:[_.length," item",1!==_.length?"s":""," selected"]})]}),(0,o.jsx)(w.A,{className:"automation-list__table",dataSource:null!=t?t:[],rowSelection:N,columns:k,rowKey:"id",pagination:!1,loading:d()||u()||f()||g()}),(0,o.jsx)(kd,{open:x,onClose:()=>C(!1),onCreate:t=>{C(!1),e(t)}})]})}}}]);